var J1=Object.defineProperty;var SS=n=>{throw TypeError(n)};var Q1=(n,e,t)=>e in n?J1(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>Q1(n,typeof e!="symbol"?e+"":e,t),xv=(n,e,t)=>e.has(n)||SS("Cannot "+t);var a=(n,e,t)=>(xv(n,e,"read from private field"),t?t.call(n):e.get(n)),b=(n,e,t)=>e.has(n)?SS("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),g=(n,e,t,s)=>(xv(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),A=(n,e,t)=>(xv(n,e,"access private method"),t);var bt=(n,e,t,s)=>({set _(r){g(n,e,r,t)},get _(){return a(n,e,s)}});function Z1(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();function zE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var HE={exports:{}},Zy={},VE={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ug=Symbol.for("react.element"),eP=Symbol.for("react.portal"),tP=Symbol.for("react.fragment"),nP=Symbol.for("react.strict_mode"),sP=Symbol.for("react.profiler"),rP=Symbol.for("react.provider"),iP=Symbol.for("react.context"),oP=Symbol.for("react.forward_ref"),aP=Symbol.for("react.suspense"),lP=Symbol.for("react.memo"),cP=Symbol.for("react.lazy"),AS=Symbol.iterator;function uP(n){return n===null||typeof n!="object"?null:(n=AS&&n[AS]||n["@@iterator"],typeof n=="function"?n:null)}var WE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GE=Object.assign,qE={};function Uh(n,e,t){this.props=n,this.context=e,this.refs=qE,this.updater=t||WE}Uh.prototype.isReactComponent={};Uh.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Uh.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function KE(){}KE.prototype=Uh.prototype;function nb(n,e,t){this.props=n,this.context=e,this.refs=qE,this.updater=t||WE}var sb=nb.prototype=new KE;sb.constructor=nb;GE(sb,Uh.prototype);sb.isPureReactComponent=!0;var ES=Array.isArray,XE=Object.prototype.hasOwnProperty,rb={current:null},YE={key:!0,ref:!0,__self:!0,__source:!0};function JE(n,e,t){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)XE.call(e,s)&&!YE.hasOwnProperty(s)&&(r[s]=e[s]);var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(n&&n.defaultProps)for(s in l=n.defaultProps,l)r[s]===void 0&&(r[s]=l[s]);return{$$typeof:ug,type:n,key:i,ref:o,props:r,_owner:rb.current}}function hP(n,e){return{$$typeof:ug,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function ib(n){return typeof n=="object"&&n!==null&&n.$$typeof===ug}function dP(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var kS=/\/+/g;function Tv(n,e){return typeof n=="object"&&n!==null&&n.key!=null?dP(""+n.key):e.toString(36)}function nm(n,e,t,s,r){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case ug:case eP:o=!0}}if(o)return o=n,r=r(o),n=s===""?"."+Tv(o,0):s,ES(r)?(t="",n!=null&&(t=n.replace(kS,"$&/")+"/"),nm(r,e,t,"",function(u){return u})):r!=null&&(ib(r)&&(r=hP(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(kS,"$&/")+"/")+n)),e.push(r)),1;if(o=0,s=s===""?".":s+":",ES(n))for(var l=0;l<n.length;l++){i=n[l];var c=s+Tv(i,l);o+=nm(i,e,t,c,r)}else if(c=uP(n),typeof c=="function")for(n=c.call(n),l=0;!(i=n.next()).done;)i=i.value,c=s+Tv(i,l++),o+=nm(i,e,t,c,r);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function kg(n,e,t){if(n==null)return n;var s=[],r=0;return nm(n,s,"","",function(i){return e.call(t,i,r++)}),s}function fP(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var kn={current:null},sm={transition:null},pP={ReactCurrentDispatcher:kn,ReactCurrentBatchConfig:sm,ReactCurrentOwner:rb};function QE(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:kg,forEach:function(n,e,t){kg(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return kg(n,function(){e++}),e},toArray:function(n){return kg(n,function(e){return e})||[]},only:function(n){if(!ib(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};me.Component=Uh;me.Fragment=tP;me.Profiler=sP;me.PureComponent=nb;me.StrictMode=nP;me.Suspense=aP;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pP;me.act=QE;me.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=GE({},n.props),r=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=rb.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in e)XE.call(e,c)&&!YE.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:ug,type:n.type,key:r,ref:i,props:s,_owner:o}};me.createContext=function(n){return n={$$typeof:iP,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:rP,_context:n},n.Consumer=n};me.createElement=JE;me.createFactory=function(n){var e=JE.bind(null,n);return e.type=n,e};me.createRef=function(){return{current:null}};me.forwardRef=function(n){return{$$typeof:oP,render:n}};me.isValidElement=ib;me.lazy=function(n){return{$$typeof:cP,_payload:{_status:-1,_result:n},_init:fP}};me.memo=function(n,e){return{$$typeof:lP,type:n,compare:e===void 0?null:e}};me.startTransition=function(n){var e=sm.transition;sm.transition={};try{n()}finally{sm.transition=e}};me.unstable_act=QE;me.useCallback=function(n,e){return kn.current.useCallback(n,e)};me.useContext=function(n){return kn.current.useContext(n)};me.useDebugValue=function(){};me.useDeferredValue=function(n){return kn.current.useDeferredValue(n)};me.useEffect=function(n,e){return kn.current.useEffect(n,e)};me.useId=function(){return kn.current.useId()};me.useImperativeHandle=function(n,e,t){return kn.current.useImperativeHandle(n,e,t)};me.useInsertionEffect=function(n,e){return kn.current.useInsertionEffect(n,e)};me.useLayoutEffect=function(n,e){return kn.current.useLayoutEffect(n,e)};me.useMemo=function(n,e){return kn.current.useMemo(n,e)};me.useReducer=function(n,e,t){return kn.current.useReducer(n,e,t)};me.useRef=function(n){return kn.current.useRef(n)};me.useState=function(n){return kn.current.useState(n)};me.useSyncExternalStore=function(n,e,t){return kn.current.useSyncExternalStore(n,e,t)};me.useTransition=function(){return kn.current.useTransition()};me.version="18.3.1";VE.exports=me;var z=VE.exports;const ZE=zE(z),gP=Z1({__proto__:null,default:ZE},[z]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mP=z,yP=Symbol.for("react.element"),vP=Symbol.for("react.fragment"),wP=Object.prototype.hasOwnProperty,_P=mP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bP={key:!0,ref:!0,__self:!0,__source:!0};function ek(n,e,t){var s,r={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)wP.call(e,s)&&!bP.hasOwnProperty(s)&&(r[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:yP,type:n,key:i,ref:o,props:r,_owner:_P.current}}Zy.Fragment=vP;Zy.jsx=ek;Zy.jsxs=ek;HE.exports=Zy;var D=HE.exports,_w={},tk={exports:{}},vs={},nk={exports:{}},sk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(O,R){var T=O.length;O.push(R);e:for(;0<T;){var L=T-1>>>1,F=O[L];if(0<r(F,R))O[L]=R,O[T]=F,T=L;else break e}}function t(O){return O.length===0?null:O[0]}function s(O){if(O.length===0)return null;var R=O[0],T=O.pop();if(T!==R){O[0]=T;e:for(var L=0,F=O.length,$=F>>>1;L<$;){var J=2*(L+1)-1,ie=O[J],pe=J+1,fe=O[pe];if(0>r(ie,T))pe<F&&0>r(fe,ie)?(O[L]=fe,O[pe]=T,L=pe):(O[L]=ie,O[J]=T,L=J);else if(pe<F&&0>r(fe,T))O[L]=fe,O[pe]=T,L=pe;else break e}}return R}function r(O,R){var T=O.sortIndex-R.sortIndex;return T!==0?T:O.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,y=!1,v=!1,S=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(O){for(var R=t(u);R!==null;){if(R.callback===null)s(u);else if(R.startTime<=O)s(u),R.sortIndex=R.expirationTime,e(c,R);else break;R=t(u)}}function E(O){if(v=!1,_(O),!y)if(t(c)!==null)y=!0,K(k);else{var R=t(u);R!==null&&M(E,R.startTime-O)}}function k(O,R){y=!1,v&&(v=!1,m(P),P=-1),p=!0;var T=f;try{for(_(R),d=t(c);d!==null&&(!(d.expirationTime>R)||O&&!j());){var L=d.callback;if(typeof L=="function"){d.callback=null,f=d.priorityLevel;var F=L(d.expirationTime<=R);R=n.unstable_now(),typeof F=="function"?d.callback=F:d===t(c)&&s(c),_(R)}else s(c);d=t(c)}if(d!==null)var $=!0;else{var J=t(u);J!==null&&M(E,J.startTime-R),$=!1}return $}finally{d=null,f=T,p=!1}}var C=!1,x=null,P=-1,I=5,N=-1;function j(){return!(n.unstable_now()-N<I)}function ee(){if(x!==null){var O=n.unstable_now();N=O;var R=!0;try{R=x(!0,O)}finally{R?se():(C=!1,x=null)}}else C=!1}var se;if(typeof w=="function")se=function(){w(ee)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,re=Q.port2;Q.port1.onmessage=ee,se=function(){re.postMessage(null)}}else se=function(){S(ee,0)};function K(O){x=O,C||(C=!0,se())}function M(O,R){P=S(function(){O(n.unstable_now())},R)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(O){O.callback=null},n.unstable_continueExecution=function(){y||p||(y=!0,K(k))},n.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<O?Math.floor(1e3/O):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(O){switch(f){case 1:case 2:case 3:var R=3;break;default:R=f}var T=f;f=R;try{return O()}finally{f=T}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(O,R){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var T=f;f=O;try{return R()}finally{f=T}},n.unstable_scheduleCallback=function(O,R,T){var L=n.unstable_now();switch(typeof T=="object"&&T!==null?(T=T.delay,T=typeof T=="number"&&0<T?L+T:L):T=L,O){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=T+F,O={id:h++,callback:R,priorityLevel:O,startTime:T,expirationTime:F,sortIndex:-1},T>L?(O.sortIndex=T,e(u,O),t(c)===null&&O===t(u)&&(v?(m(P),P=-1):v=!0,M(E,T-L))):(O.sortIndex=F,e(c,O),y||p||(y=!0,K(k))),O},n.unstable_shouldYield=j,n.unstable_wrapCallback=function(O){var R=f;return function(){var T=f;f=R;try{return O.apply(this,arguments)}finally{f=T}}}})(sk);nk.exports=sk;var SP=nk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AP=z,ys=SP;function U(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rk=new Set,Hd={};function uc(n,e){Lh(n,e),Lh(n+"Capture",e)}function Lh(n,e){for(Hd[n]=e,n=0;n<e.length;n++)rk.add(e[n])}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bw=Object.prototype.hasOwnProperty,EP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,CS={},xS={};function kP(n){return bw.call(xS,n)?!0:bw.call(CS,n)?!1:EP.test(n)?xS[n]=!0:(CS[n]=!0,!1)}function CP(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function xP(n,e,t,s){if(e===null||typeof e>"u"||CP(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Cn(n,e,t,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var en={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){en[n]=new Cn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];en[e]=new Cn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){en[n]=new Cn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){en[n]=new Cn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){en[n]=new Cn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){en[n]=new Cn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){en[n]=new Cn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){en[n]=new Cn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){en[n]=new Cn(n,5,!1,n.toLowerCase(),null,!1,!1)});var ob=/[\-:]([a-z])/g;function ab(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ob,ab);en[e]=new Cn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ob,ab);en[e]=new Cn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ob,ab);en[e]=new Cn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){en[n]=new Cn(n,1,!1,n.toLowerCase(),null,!1,!1)});en.xlinkHref=new Cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){en[n]=new Cn(n,1,!1,n.toLowerCase(),null,!0,!0)});function lb(n,e,t,s){var r=en.hasOwnProperty(e)?en[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(xP(e,t,r,s)&&(t=null),s||r===null?kP(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,s=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Qi=AP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cg=Symbol.for("react.element"),Dc=Symbol.for("react.portal"),Nc=Symbol.for("react.fragment"),cb=Symbol.for("react.strict_mode"),Sw=Symbol.for("react.profiler"),ik=Symbol.for("react.provider"),ok=Symbol.for("react.context"),ub=Symbol.for("react.forward_ref"),Aw=Symbol.for("react.suspense"),Ew=Symbol.for("react.suspense_list"),hb=Symbol.for("react.memo"),no=Symbol.for("react.lazy"),ak=Symbol.for("react.offscreen"),TS=Symbol.iterator;function Gh(n){return n===null||typeof n!="object"?null:(n=TS&&n[TS]||n["@@iterator"],typeof n=="function"?n:null)}var nt=Object.assign,Pv;function id(n){if(Pv===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Pv=e&&e[1]||""}return`
`+Pv+n}var Rv=!1;function Ov(n,e){if(!n||Rv)return"";Rv=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,l=i.length-1;1<=o&&0<=l&&r[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(r[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||r[o]!==i[l]){var c=`
`+r[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=l);break}}}finally{Rv=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?id(n):""}function TP(n){switch(n.tag){case 5:return id(n.type);case 16:return id("Lazy");case 13:return id("Suspense");case 19:return id("SuspenseList");case 0:case 2:case 15:return n=Ov(n.type,!1),n;case 11:return n=Ov(n.type.render,!1),n;case 1:return n=Ov(n.type,!0),n;default:return""}}function kw(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Nc:return"Fragment";case Dc:return"Portal";case Sw:return"Profiler";case cb:return"StrictMode";case Aw:return"Suspense";case Ew:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case ok:return(n.displayName||"Context")+".Consumer";case ik:return(n._context.displayName||"Context")+".Provider";case ub:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case hb:return e=n.displayName||null,e!==null?e:kw(n.type)||"Memo";case no:e=n._payload,n=n._init;try{return kw(n(e))}catch{}}return null}function PP(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kw(e);case 8:return e===cb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ha(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function lk(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function RP(n){var e=lk(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function xg(n){n._valueTracker||(n._valueTracker=RP(n))}function ck(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=lk(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function Km(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Cw(n,e){var t=e.checked;return nt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function PS(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=ha(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function uk(n,e){e=e.checked,e!=null&&lb(n,"checked",e,!1)}function xw(n,e){uk(n,e);var t=ha(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Tw(n,e.type,t):e.hasOwnProperty("defaultValue")&&Tw(n,e.type,ha(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function RS(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Tw(n,e,t){(e!=="number"||Km(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var od=Array.isArray;function Zc(n,e,t,s){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&s&&(n[t].defaultSelected=!0)}else{for(t=""+ha(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,s&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function Pw(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return nt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function OS(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(U(92));if(od(t)){if(1<t.length)throw Error(U(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:ha(t)}}function hk(n,e){var t=ha(e.value),s=ha(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function IS(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function dk(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rw(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?dk(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Tg,fk=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Tg=Tg||document.createElement("div"),Tg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Tg.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Vd(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Id={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},OP=["Webkit","ms","Moz","O"];Object.keys(Id).forEach(function(n){OP.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Id[e]=Id[n]})});function pk(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Id.hasOwnProperty(n)&&Id[n]?(""+e).trim():e+"px"}function gk(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,r=pk(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,r):n[t]=r}}var IP=nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ow(n,e){if(e){if(IP[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Iw(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lw=null;function db(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Dw=null,eu=null,tu=null;function LS(n){if(n=fg(n)){if(typeof Dw!="function")throw Error(U(280));var e=n.stateNode;e&&(e=rv(e),Dw(n.stateNode,n.type,e))}}function mk(n){eu?tu?tu.push(n):tu=[n]:eu=n}function yk(){if(eu){var n=eu,e=tu;if(tu=eu=null,LS(n),e)for(n=0;n<e.length;n++)LS(e[n])}}function vk(n,e){return n(e)}function wk(){}var Iv=!1;function _k(n,e,t){if(Iv)return n(e,t);Iv=!0;try{return vk(n,e,t)}finally{Iv=!1,(eu!==null||tu!==null)&&(wk(),yk())}}function Wd(n,e){var t=n.stateNode;if(t===null)return null;var s=rv(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(U(231,e,typeof t));return t}var Nw=!1;if(Gi)try{var qh={};Object.defineProperty(qh,"passive",{get:function(){Nw=!0}}),window.addEventListener("test",qh,qh),window.removeEventListener("test",qh,qh)}catch{Nw=!1}function LP(n,e,t,s,r,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var Ld=!1,Xm=null,Ym=!1,Mw=null,DP={onError:function(n){Ld=!0,Xm=n}};function NP(n,e,t,s,r,i,o,l,c){Ld=!1,Xm=null,LP.apply(DP,arguments)}function MP(n,e,t,s,r,i,o,l,c){if(NP.apply(this,arguments),Ld){if(Ld){var u=Xm;Ld=!1,Xm=null}else throw Error(U(198));Ym||(Ym=!0,Mw=u)}}function hc(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function bk(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function DS(n){if(hc(n)!==n)throw Error(U(188))}function FP(n){var e=n.alternate;if(!e){if(e=hc(n),e===null)throw Error(U(188));return e!==n?null:n}for(var t=n,s=e;;){var r=t.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){t=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===t)return DS(r),n;if(i===s)return DS(r),e;i=i.sibling}throw Error(U(188))}if(t.return!==s.return)t=r,s=i;else{for(var o=!1,l=r.child;l;){if(l===t){o=!0,t=r,s=i;break}if(l===s){o=!0,s=r,t=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===t){o=!0,t=i,s=r;break}if(l===s){o=!0,s=i,t=r;break}l=l.sibling}if(!o)throw Error(U(189))}}if(t.alternate!==s)throw Error(U(190))}if(t.tag!==3)throw Error(U(188));return t.stateNode.current===t?n:e}function Sk(n){return n=FP(n),n!==null?Ak(n):null}function Ak(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Ak(n);if(e!==null)return e;n=n.sibling}return null}var Ek=ys.unstable_scheduleCallback,NS=ys.unstable_cancelCallback,BP=ys.unstable_shouldYield,jP=ys.unstable_requestPaint,ft=ys.unstable_now,UP=ys.unstable_getCurrentPriorityLevel,fb=ys.unstable_ImmediatePriority,kk=ys.unstable_UserBlockingPriority,Jm=ys.unstable_NormalPriority,$P=ys.unstable_LowPriority,Ck=ys.unstable_IdlePriority,ev=null,qr=null;function zP(n){if(qr&&typeof qr.onCommitFiberRoot=="function")try{qr.onCommitFiberRoot(ev,n,void 0,(n.current.flags&128)===128)}catch{}}var dr=Math.clz32?Math.clz32:WP,HP=Math.log,VP=Math.LN2;function WP(n){return n>>>=0,n===0?32:31-(HP(n)/VP|0)|0}var Pg=64,Rg=4194304;function ad(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Qm(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,r=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~r;l!==0?s=ad(l):(i&=o,i!==0&&(s=ad(i)))}else o=t&~r,o!==0?s=ad(o):i!==0&&(s=ad(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-dr(e),r=1<<t,s|=n[t],e&=~r;return s}function GP(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qP(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,r=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-dr(i),l=1<<o,c=r[o];c===-1?(!(l&t)||l&s)&&(r[o]=GP(l,e)):c<=e&&(n.expiredLanes|=l),i&=~l}}function Fw(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function xk(){var n=Pg;return Pg<<=1,!(Pg&4194240)&&(Pg=64),n}function Lv(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function hg(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-dr(e),n[e]=t}function KP(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-dr(t),i=1<<r;e[r]=0,s[r]=-1,n[r]=-1,t&=~i}}function pb(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-dr(t),r=1<<s;r&e|n[s]&e&&(n[s]|=e),t&=~r}}var xe=0;function Tk(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Pk,gb,Rk,Ok,Ik,Bw=!1,Og=[],sa=null,ra=null,ia=null,Gd=new Map,qd=new Map,io=[],XP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function MS(n,e){switch(n){case"focusin":case"focusout":sa=null;break;case"dragenter":case"dragleave":ra=null;break;case"mouseover":case"mouseout":ia=null;break;case"pointerover":case"pointerout":Gd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qd.delete(e.pointerId)}}function Kh(n,e,t,s,r,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=fg(e),e!==null&&gb(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function YP(n,e,t,s,r){switch(e){case"focusin":return sa=Kh(sa,n,e,t,s,r),!0;case"dragenter":return ra=Kh(ra,n,e,t,s,r),!0;case"mouseover":return ia=Kh(ia,n,e,t,s,r),!0;case"pointerover":var i=r.pointerId;return Gd.set(i,Kh(Gd.get(i)||null,n,e,t,s,r)),!0;case"gotpointercapture":return i=r.pointerId,qd.set(i,Kh(qd.get(i)||null,n,e,t,s,r)),!0}return!1}function Lk(n){var e=Da(n.target);if(e!==null){var t=hc(e);if(t!==null){if(e=t.tag,e===13){if(e=bk(t),e!==null){n.blockedOn=e,Ik(n.priority,function(){Rk(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function rm(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=jw(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);Lw=s,t.target.dispatchEvent(s),Lw=null}else return e=fg(t),e!==null&&gb(e),n.blockedOn=t,!1;e.shift()}return!0}function FS(n,e,t){rm(n)&&t.delete(e)}function JP(){Bw=!1,sa!==null&&rm(sa)&&(sa=null),ra!==null&&rm(ra)&&(ra=null),ia!==null&&rm(ia)&&(ia=null),Gd.forEach(FS),qd.forEach(FS)}function Xh(n,e){n.blockedOn===e&&(n.blockedOn=null,Bw||(Bw=!0,ys.unstable_scheduleCallback(ys.unstable_NormalPriority,JP)))}function Kd(n){function e(r){return Xh(r,n)}if(0<Og.length){Xh(Og[0],n);for(var t=1;t<Og.length;t++){var s=Og[t];s.blockedOn===n&&(s.blockedOn=null)}}for(sa!==null&&Xh(sa,n),ra!==null&&Xh(ra,n),ia!==null&&Xh(ia,n),Gd.forEach(e),qd.forEach(e),t=0;t<io.length;t++)s=io[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<io.length&&(t=io[0],t.blockedOn===null);)Lk(t),t.blockedOn===null&&io.shift()}var nu=Qi.ReactCurrentBatchConfig,Zm=!0;function QP(n,e,t,s){var r=xe,i=nu.transition;nu.transition=null;try{xe=1,mb(n,e,t,s)}finally{xe=r,nu.transition=i}}function ZP(n,e,t,s){var r=xe,i=nu.transition;nu.transition=null;try{xe=4,mb(n,e,t,s)}finally{xe=r,nu.transition=i}}function mb(n,e,t,s){if(Zm){var r=jw(n,e,t,s);if(r===null)Hv(n,e,s,ey,t),MS(n,s);else if(YP(r,n,e,t,s))s.stopPropagation();else if(MS(n,s),e&4&&-1<XP.indexOf(n)){for(;r!==null;){var i=fg(r);if(i!==null&&Pk(i),i=jw(n,e,t,s),i===null&&Hv(n,e,s,ey,t),i===r)break;r=i}r!==null&&s.stopPropagation()}else Hv(n,e,s,null,t)}}var ey=null;function jw(n,e,t,s){if(ey=null,n=db(s),n=Da(n),n!==null)if(e=hc(n),e===null)n=null;else if(t=e.tag,t===13){if(n=bk(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return ey=n,null}function Dk(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(UP()){case fb:return 1;case kk:return 4;case Jm:case $P:return 16;case Ck:return 536870912;default:return 16}default:return 16}}var ea=null,yb=null,im=null;function Nk(){if(im)return im;var n,e=yb,t=e.length,s,r="value"in ea?ea.value:ea.textContent,i=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(s=1;s<=o&&e[t-s]===r[i-s];s++);return im=r.slice(n,1<s?1-s:void 0)}function om(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ig(){return!0}function BS(){return!1}function ws(n){function e(t,s,r,i,o){this._reactName=t,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ig:BS,this.isPropagationStopped=BS,this}return nt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ig)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ig)},persist:function(){},isPersistent:Ig}),e}var $h={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vb=ws($h),dg=nt({},$h,{view:0,detail:0}),eR=ws(dg),Dv,Nv,Yh,tv=nt({},dg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wb,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Yh&&(Yh&&n.type==="mousemove"?(Dv=n.screenX-Yh.screenX,Nv=n.screenY-Yh.screenY):Nv=Dv=0,Yh=n),Dv)},movementY:function(n){return"movementY"in n?n.movementY:Nv}}),jS=ws(tv),tR=nt({},tv,{dataTransfer:0}),nR=ws(tR),sR=nt({},dg,{relatedTarget:0}),Mv=ws(sR),rR=nt({},$h,{animationName:0,elapsedTime:0,pseudoElement:0}),iR=ws(rR),oR=nt({},$h,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),aR=ws(oR),lR=nt({},$h,{data:0}),US=ws(lR),cR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dR(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=hR[n])?!!e[n]:!1}function wb(){return dR}var fR=nt({},dg,{key:function(n){if(n.key){var e=cR[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=om(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?uR[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wb,charCode:function(n){return n.type==="keypress"?om(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?om(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),pR=ws(fR),gR=nt({},tv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$S=ws(gR),mR=nt({},dg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wb}),yR=ws(mR),vR=nt({},$h,{propertyName:0,elapsedTime:0,pseudoElement:0}),wR=ws(vR),_R=nt({},tv,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),bR=ws(_R),SR=[9,13,27,32],_b=Gi&&"CompositionEvent"in window,Dd=null;Gi&&"documentMode"in document&&(Dd=document.documentMode);var AR=Gi&&"TextEvent"in window&&!Dd,Mk=Gi&&(!_b||Dd&&8<Dd&&11>=Dd),zS=" ",HS=!1;function Fk(n,e){switch(n){case"keyup":return SR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bk(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Mc=!1;function ER(n,e){switch(n){case"compositionend":return Bk(e);case"keypress":return e.which!==32?null:(HS=!0,zS);case"textInput":return n=e.data,n===zS&&HS?null:n;default:return null}}function kR(n,e){if(Mc)return n==="compositionend"||!_b&&Fk(n,e)?(n=Nk(),im=yb=ea=null,Mc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Mk&&e.locale!=="ko"?null:e.data;default:return null}}var CR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!CR[n.type]:e==="textarea"}function jk(n,e,t,s){mk(s),e=ty(e,"onChange"),0<e.length&&(t=new vb("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var Nd=null,Xd=null;function xR(n){Yk(n,0)}function nv(n){var e=jc(n);if(ck(e))return n}function TR(n,e){if(n==="change")return e}var Uk=!1;if(Gi){var Fv;if(Gi){var Bv="oninput"in document;if(!Bv){var WS=document.createElement("div");WS.setAttribute("oninput","return;"),Bv=typeof WS.oninput=="function"}Fv=Bv}else Fv=!1;Uk=Fv&&(!document.documentMode||9<document.documentMode)}function GS(){Nd&&(Nd.detachEvent("onpropertychange",$k),Xd=Nd=null)}function $k(n){if(n.propertyName==="value"&&nv(Xd)){var e=[];jk(e,Xd,n,db(n)),_k(xR,e)}}function PR(n,e,t){n==="focusin"?(GS(),Nd=e,Xd=t,Nd.attachEvent("onpropertychange",$k)):n==="focusout"&&GS()}function RR(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return nv(Xd)}function OR(n,e){if(n==="click")return nv(e)}function IR(n,e){if(n==="input"||n==="change")return nv(e)}function LR(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var pr=typeof Object.is=="function"?Object.is:LR;function Yd(n,e){if(pr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var r=t[s];if(!bw.call(e,r)||!pr(n[r],e[r]))return!1}return!0}function qS(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function KS(n,e){var t=qS(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=qS(t)}}function zk(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?zk(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Hk(){for(var n=window,e=Km();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Km(n.document)}return e}function bb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function DR(n){var e=Hk(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&zk(t.ownerDocument.documentElement,t)){if(s!==null&&bb(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!n.extend&&i>s&&(r=s,s=i,i=r),r=KS(t,i);var o=KS(t,s);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),i>s?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var NR=Gi&&"documentMode"in document&&11>=document.documentMode,Fc=null,Uw=null,Md=null,$w=!1;function XS(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;$w||Fc==null||Fc!==Km(s)||(s=Fc,"selectionStart"in s&&bb(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Md&&Yd(Md,s)||(Md=s,s=ty(Uw,"onSelect"),0<s.length&&(e=new vb("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Fc)))}function Lg(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Bc={animationend:Lg("Animation","AnimationEnd"),animationiteration:Lg("Animation","AnimationIteration"),animationstart:Lg("Animation","AnimationStart"),transitionend:Lg("Transition","TransitionEnd")},jv={},Vk={};Gi&&(Vk=document.createElement("div").style,"AnimationEvent"in window||(delete Bc.animationend.animation,delete Bc.animationiteration.animation,delete Bc.animationstart.animation),"TransitionEvent"in window||delete Bc.transitionend.transition);function sv(n){if(jv[n])return jv[n];if(!Bc[n])return n;var e=Bc[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Vk)return jv[n]=e[t];return n}var Wk=sv("animationend"),Gk=sv("animationiteration"),qk=sv("animationstart"),Kk=sv("transitionend"),Xk=new Map,YS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ma(n,e){Xk.set(n,e),uc(e,[n])}for(var Uv=0;Uv<YS.length;Uv++){var $v=YS[Uv],MR=$v.toLowerCase(),FR=$v[0].toUpperCase()+$v.slice(1);ma(MR,"on"+FR)}ma(Wk,"onAnimationEnd");ma(Gk,"onAnimationIteration");ma(qk,"onAnimationStart");ma("dblclick","onDoubleClick");ma("focusin","onFocus");ma("focusout","onBlur");ma(Kk,"onTransitionEnd");Lh("onMouseEnter",["mouseout","mouseover"]);Lh("onMouseLeave",["mouseout","mouseover"]);Lh("onPointerEnter",["pointerout","pointerover"]);Lh("onPointerLeave",["pointerout","pointerover"]);uc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uc("onBeforeInput",["compositionend","keypress","textInput","paste"]);uc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),BR=new Set("cancel close invalid load scroll toggle".split(" ").concat(ld));function JS(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,MP(s,e,void 0,n),n.currentTarget=null}function Yk(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&r.isPropagationStopped())break e;JS(r,l,u),i=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&r.isPropagationStopped())break e;JS(r,l,u),i=c}}}if(Ym)throw n=Mw,Ym=!1,Mw=null,n}function He(n,e){var t=e[Gw];t===void 0&&(t=e[Gw]=new Set);var s=n+"__bubble";t.has(s)||(Jk(e,n,2,!1),t.add(s))}function zv(n,e,t){var s=0;e&&(s|=4),Jk(t,n,s,e)}var Dg="_reactListening"+Math.random().toString(36).slice(2);function Jd(n){if(!n[Dg]){n[Dg]=!0,rk.forEach(function(t){t!=="selectionchange"&&(BR.has(t)||zv(t,!1,n),zv(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Dg]||(e[Dg]=!0,zv("selectionchange",!1,e))}}function Jk(n,e,t,s){switch(Dk(e)){case 1:var r=QP;break;case 4:r=ZP;break;default:r=mb}t=r.bind(null,e,t,n),r=void 0,!Nw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function Hv(n,e,t,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;l!==null;){if(o=Da(l),o===null)return;if(c=o.tag,c===5||c===6){s=i=o;continue e}l=l.parentNode}}s=s.return}_k(function(){var u=i,h=db(t),d=[];e:{var f=Xk.get(n);if(f!==void 0){var p=vb,y=n;switch(n){case"keypress":if(om(t)===0)break e;case"keydown":case"keyup":p=pR;break;case"focusin":y="focus",p=Mv;break;case"focusout":y="blur",p=Mv;break;case"beforeblur":case"afterblur":p=Mv;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=jS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=nR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=yR;break;case Wk:case Gk:case qk:p=iR;break;case Kk:p=wR;break;case"scroll":p=eR;break;case"wheel":p=bR;break;case"copy":case"cut":case"paste":p=aR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=$S}var v=(e&4)!==0,S=!v&&n==="scroll",m=v?f!==null?f+"Capture":null:f;v=[];for(var w=u,_;w!==null;){_=w;var E=_.stateNode;if(_.tag===5&&E!==null&&(_=E,m!==null&&(E=Wd(w,m),E!=null&&v.push(Qd(w,E,_)))),S)break;w=w.return}0<v.length&&(f=new p(f,y,null,t,h),d.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==Lw&&(y=t.relatedTarget||t.fromElement)&&(Da(y)||y[qi]))break e;if((p||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,p?(y=t.relatedTarget||t.toElement,p=u,y=y?Da(y):null,y!==null&&(S=hc(y),y!==S||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(v=jS,E="onMouseLeave",m="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(v=$S,E="onPointerLeave",m="onPointerEnter",w="pointer"),S=p==null?f:jc(p),_=y==null?f:jc(y),f=new v(E,w+"leave",p,t,h),f.target=S,f.relatedTarget=_,E=null,Da(h)===u&&(v=new v(m,w+"enter",y,t,h),v.target=_,v.relatedTarget=S,E=v),S=E,p&&y)t:{for(v=p,m=y,w=0,_=v;_;_=gc(_))w++;for(_=0,E=m;E;E=gc(E))_++;for(;0<w-_;)v=gc(v),w--;for(;0<_-w;)m=gc(m),_--;for(;w--;){if(v===m||m!==null&&v===m.alternate)break t;v=gc(v),m=gc(m)}v=null}else v=null;p!==null&&QS(d,f,p,v,!1),y!==null&&S!==null&&QS(d,S,y,v,!0)}}e:{if(f=u?jc(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var k=TR;else if(VS(f))if(Uk)k=IR;else{k=RR;var C=PR}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=OR);if(k&&(k=k(n,u))){jk(d,k,t,h);break e}C&&C(n,f,u),n==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Tw(f,"number",f.value)}switch(C=u?jc(u):window,n){case"focusin":(VS(C)||C.contentEditable==="true")&&(Fc=C,Uw=u,Md=null);break;case"focusout":Md=Uw=Fc=null;break;case"mousedown":$w=!0;break;case"contextmenu":case"mouseup":case"dragend":$w=!1,XS(d,t,h);break;case"selectionchange":if(NR)break;case"keydown":case"keyup":XS(d,t,h)}var x;if(_b)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Mc?Fk(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(Mk&&t.locale!=="ko"&&(Mc||P!=="onCompositionStart"?P==="onCompositionEnd"&&Mc&&(x=Nk()):(ea=h,yb="value"in ea?ea.value:ea.textContent,Mc=!0)),C=ty(u,P),0<C.length&&(P=new US(P,n,null,t,h),d.push({event:P,listeners:C}),x?P.data=x:(x=Bk(t),x!==null&&(P.data=x)))),(x=AR?ER(n,t):kR(n,t))&&(u=ty(u,"onBeforeInput"),0<u.length&&(h=new US("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=x))}Yk(d,e)})}function Qd(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ty(n,e){for(var t=e+"Capture",s=[];n!==null;){var r=n,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Wd(n,t),i!=null&&s.unshift(Qd(n,i,r)),i=Wd(n,e),i!=null&&s.push(Qd(n,i,r))),n=n.return}return s}function gc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function QS(n,e,t,s,r){for(var i=e._reactName,o=[];t!==null&&t!==s;){var l=t,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,r?(c=Wd(t,i),c!=null&&o.unshift(Qd(t,c,l))):r||(c=Wd(t,i),c!=null&&o.push(Qd(t,c,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var jR=/\r\n?/g,UR=/\u0000|\uFFFD/g;function ZS(n){return(typeof n=="string"?n:""+n).replace(jR,`
`).replace(UR,"")}function Ng(n,e,t){if(e=ZS(e),ZS(n)!==e&&t)throw Error(U(425))}function ny(){}var zw=null,Hw=null;function Vw(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ww=typeof setTimeout=="function"?setTimeout:void 0,$R=typeof clearTimeout=="function"?clearTimeout:void 0,eA=typeof Promise=="function"?Promise:void 0,zR=typeof queueMicrotask=="function"?queueMicrotask:typeof eA<"u"?function(n){return eA.resolve(null).then(n).catch(HR)}:Ww;function HR(n){setTimeout(function(){throw n})}function Vv(n,e){var t=e,s=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(s===0){n.removeChild(r),Kd(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=r}while(t);Kd(e)}function oa(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function tA(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var zh=Math.random().toString(36).slice(2),Vr="__reactFiber$"+zh,Zd="__reactProps$"+zh,qi="__reactContainer$"+zh,Gw="__reactEvents$"+zh,VR="__reactListeners$"+zh,WR="__reactHandles$"+zh;function Da(n){var e=n[Vr];if(e)return e;for(var t=n.parentNode;t;){if(e=t[qi]||t[Vr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=tA(n);n!==null;){if(t=n[Vr])return t;n=tA(n)}return e}n=t,t=n.parentNode}return null}function fg(n){return n=n[Vr]||n[qi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function jc(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(U(33))}function rv(n){return n[Zd]||null}var qw=[],Uc=-1;function ya(n){return{current:n}}function We(n){0>Uc||(n.current=qw[Uc],qw[Uc]=null,Uc--)}function $e(n,e){Uc++,qw[Uc]=n.current,n.current=e}var da={},dn=ya(da),Bn=ya(!1),nc=da;function Dh(n,e){var t=n.type.contextTypes;if(!t)return da;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in t)r[i]=e[i];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function jn(n){return n=n.childContextTypes,n!=null}function sy(){We(Bn),We(dn)}function nA(n,e,t){if(dn.current!==da)throw Error(U(168));$e(dn,e),$e(Bn,t)}function Qk(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(U(108,PP(n)||"Unknown",r));return nt({},t,s)}function ry(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||da,nc=dn.current,$e(dn,n),$e(Bn,Bn.current),!0}function sA(n,e,t){var s=n.stateNode;if(!s)throw Error(U(169));t?(n=Qk(n,e,nc),s.__reactInternalMemoizedMergedChildContext=n,We(Bn),We(dn),$e(dn,n)):We(Bn),$e(Bn,t)}var ri=null,iv=!1,Wv=!1;function Zk(n){ri===null?ri=[n]:ri.push(n)}function GR(n){iv=!0,Zk(n)}function va(){if(!Wv&&ri!==null){Wv=!0;var n=0,e=xe;try{var t=ri;for(xe=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}ri=null,iv=!1}catch(r){throw ri!==null&&(ri=ri.slice(n+1)),Ek(fb,va),r}finally{xe=e,Wv=!1}}return null}var $c=[],zc=0,iy=null,oy=0,Ds=[],Ns=0,sc=null,Ui=1,$i="";function Aa(n,e){$c[zc++]=oy,$c[zc++]=iy,iy=n,oy=e}function eC(n,e,t){Ds[Ns++]=Ui,Ds[Ns++]=$i,Ds[Ns++]=sc,sc=n;var s=Ui;n=$i;var r=32-dr(s)-1;s&=~(1<<r),t+=1;var i=32-dr(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Ui=1<<32-dr(e)+r|t<<r|s,$i=i+n}else Ui=1<<i|t<<r|s,$i=n}function Sb(n){n.return!==null&&(Aa(n,1),eC(n,1,0))}function Ab(n){for(;n===iy;)iy=$c[--zc],$c[zc]=null,oy=$c[--zc],$c[zc]=null;for(;n===sc;)sc=Ds[--Ns],Ds[Ns]=null,$i=Ds[--Ns],Ds[Ns]=null,Ui=Ds[--Ns],Ds[Ns]=null}var gs=null,ps=null,Xe=!1,ur=null;function tC(n,e){var t=Fs(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function rA(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,gs=n,ps=oa(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,gs=n,ps=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=sc!==null?{id:Ui,overflow:$i}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Fs(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,gs=n,ps=null,!0):!1;default:return!1}}function Kw(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Xw(n){if(Xe){var e=ps;if(e){var t=e;if(!rA(n,e)){if(Kw(n))throw Error(U(418));e=oa(t.nextSibling);var s=gs;e&&rA(n,e)?tC(s,t):(n.flags=n.flags&-4097|2,Xe=!1,gs=n)}}else{if(Kw(n))throw Error(U(418));n.flags=n.flags&-4097|2,Xe=!1,gs=n}}}function iA(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;gs=n}function Mg(n){if(n!==gs)return!1;if(!Xe)return iA(n),Xe=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Vw(n.type,n.memoizedProps)),e&&(e=ps)){if(Kw(n))throw nC(),Error(U(418));for(;e;)tC(n,e),e=oa(e.nextSibling)}if(iA(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(U(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ps=oa(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ps=null}}else ps=gs?oa(n.stateNode.nextSibling):null;return!0}function nC(){for(var n=ps;n;)n=oa(n.nextSibling)}function Nh(){ps=gs=null,Xe=!1}function Eb(n){ur===null?ur=[n]:ur.push(n)}var qR=Qi.ReactCurrentBatchConfig;function Jh(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(U(309));var s=t.stateNode}if(!s)throw Error(U(147,n));var r=s,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=r.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(U(284));if(!t._owner)throw Error(U(290,n))}return n}function Fg(n,e){throw n=Object.prototype.toString.call(e),Error(U(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function oA(n){var e=n._init;return e(n._payload)}function sC(n){function e(m,w){if(n){var _=m.deletions;_===null?(m.deletions=[w],m.flags|=16):_.push(w)}}function t(m,w){if(!n)return null;for(;w!==null;)e(m,w),w=w.sibling;return null}function s(m,w){for(m=new Map;w!==null;)w.key!==null?m.set(w.key,w):m.set(w.index,w),w=w.sibling;return m}function r(m,w){return m=ua(m,w),m.index=0,m.sibling=null,m}function i(m,w,_){return m.index=_,n?(_=m.alternate,_!==null?(_=_.index,_<w?(m.flags|=2,w):_):(m.flags|=2,w)):(m.flags|=1048576,w)}function o(m){return n&&m.alternate===null&&(m.flags|=2),m}function l(m,w,_,E){return w===null||w.tag!==6?(w=Qv(_,m.mode,E),w.return=m,w):(w=r(w,_),w.return=m,w)}function c(m,w,_,E){var k=_.type;return k===Nc?h(m,w,_.props.children,E,_.key):w!==null&&(w.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===no&&oA(k)===w.type)?(E=r(w,_.props),E.ref=Jh(m,w,_),E.return=m,E):(E=fm(_.type,_.key,_.props,null,m.mode,E),E.ref=Jh(m,w,_),E.return=m,E)}function u(m,w,_,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==_.containerInfo||w.stateNode.implementation!==_.implementation?(w=Zv(_,m.mode,E),w.return=m,w):(w=r(w,_.children||[]),w.return=m,w)}function h(m,w,_,E,k){return w===null||w.tag!==7?(w=ec(_,m.mode,E,k),w.return=m,w):(w=r(w,_),w.return=m,w)}function d(m,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Qv(""+w,m.mode,_),w.return=m,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Cg:return _=fm(w.type,w.key,w.props,null,m.mode,_),_.ref=Jh(m,null,w),_.return=m,_;case Dc:return w=Zv(w,m.mode,_),w.return=m,w;case no:var E=w._init;return d(m,E(w._payload),_)}if(od(w)||Gh(w))return w=ec(w,m.mode,_,null),w.return=m,w;Fg(m,w)}return null}function f(m,w,_,E){var k=w!==null?w.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return k!==null?null:l(m,w,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Cg:return _.key===k?c(m,w,_,E):null;case Dc:return _.key===k?u(m,w,_,E):null;case no:return k=_._init,f(m,w,k(_._payload),E)}if(od(_)||Gh(_))return k!==null?null:h(m,w,_,E,null);Fg(m,_)}return null}function p(m,w,_,E,k){if(typeof E=="string"&&E!==""||typeof E=="number")return m=m.get(_)||null,l(w,m,""+E,k);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Cg:return m=m.get(E.key===null?_:E.key)||null,c(w,m,E,k);case Dc:return m=m.get(E.key===null?_:E.key)||null,u(w,m,E,k);case no:var C=E._init;return p(m,w,_,C(E._payload),k)}if(od(E)||Gh(E))return m=m.get(_)||null,h(w,m,E,k,null);Fg(w,E)}return null}function y(m,w,_,E){for(var k=null,C=null,x=w,P=w=0,I=null;x!==null&&P<_.length;P++){x.index>P?(I=x,x=null):I=x.sibling;var N=f(m,x,_[P],E);if(N===null){x===null&&(x=I);break}n&&x&&N.alternate===null&&e(m,x),w=i(N,w,P),C===null?k=N:C.sibling=N,C=N,x=I}if(P===_.length)return t(m,x),Xe&&Aa(m,P),k;if(x===null){for(;P<_.length;P++)x=d(m,_[P],E),x!==null&&(w=i(x,w,P),C===null?k=x:C.sibling=x,C=x);return Xe&&Aa(m,P),k}for(x=s(m,x);P<_.length;P++)I=p(x,m,P,_[P],E),I!==null&&(n&&I.alternate!==null&&x.delete(I.key===null?P:I.key),w=i(I,w,P),C===null?k=I:C.sibling=I,C=I);return n&&x.forEach(function(j){return e(m,j)}),Xe&&Aa(m,P),k}function v(m,w,_,E){var k=Gh(_);if(typeof k!="function")throw Error(U(150));if(_=k.call(_),_==null)throw Error(U(151));for(var C=k=null,x=w,P=w=0,I=null,N=_.next();x!==null&&!N.done;P++,N=_.next()){x.index>P?(I=x,x=null):I=x.sibling;var j=f(m,x,N.value,E);if(j===null){x===null&&(x=I);break}n&&x&&j.alternate===null&&e(m,x),w=i(j,w,P),C===null?k=j:C.sibling=j,C=j,x=I}if(N.done)return t(m,x),Xe&&Aa(m,P),k;if(x===null){for(;!N.done;P++,N=_.next())N=d(m,N.value,E),N!==null&&(w=i(N,w,P),C===null?k=N:C.sibling=N,C=N);return Xe&&Aa(m,P),k}for(x=s(m,x);!N.done;P++,N=_.next())N=p(x,m,P,N.value,E),N!==null&&(n&&N.alternate!==null&&x.delete(N.key===null?P:N.key),w=i(N,w,P),C===null?k=N:C.sibling=N,C=N);return n&&x.forEach(function(ee){return e(m,ee)}),Xe&&Aa(m,P),k}function S(m,w,_,E){if(typeof _=="object"&&_!==null&&_.type===Nc&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Cg:e:{for(var k=_.key,C=w;C!==null;){if(C.key===k){if(k=_.type,k===Nc){if(C.tag===7){t(m,C.sibling),w=r(C,_.props.children),w.return=m,m=w;break e}}else if(C.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===no&&oA(k)===C.type){t(m,C.sibling),w=r(C,_.props),w.ref=Jh(m,C,_),w.return=m,m=w;break e}t(m,C);break}else e(m,C);C=C.sibling}_.type===Nc?(w=ec(_.props.children,m.mode,E,_.key),w.return=m,m=w):(E=fm(_.type,_.key,_.props,null,m.mode,E),E.ref=Jh(m,w,_),E.return=m,m=E)}return o(m);case Dc:e:{for(C=_.key;w!==null;){if(w.key===C)if(w.tag===4&&w.stateNode.containerInfo===_.containerInfo&&w.stateNode.implementation===_.implementation){t(m,w.sibling),w=r(w,_.children||[]),w.return=m,m=w;break e}else{t(m,w);break}else e(m,w);w=w.sibling}w=Zv(_,m.mode,E),w.return=m,m=w}return o(m);case no:return C=_._init,S(m,w,C(_._payload),E)}if(od(_))return y(m,w,_,E);if(Gh(_))return v(m,w,_,E);Fg(m,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,w!==null&&w.tag===6?(t(m,w.sibling),w=r(w,_),w.return=m,m=w):(t(m,w),w=Qv(_,m.mode,E),w.return=m,m=w),o(m)):t(m,w)}return S}var Mh=sC(!0),rC=sC(!1),ay=ya(null),ly=null,Hc=null,kb=null;function Cb(){kb=Hc=ly=null}function xb(n){var e=ay.current;We(ay),n._currentValue=e}function Yw(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function su(n,e){ly=n,kb=Hc=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Fn=!0),n.firstContext=null)}function Us(n){var e=n._currentValue;if(kb!==n)if(n={context:n,memoizedValue:e,next:null},Hc===null){if(ly===null)throw Error(U(308));Hc=n,ly.dependencies={lanes:0,firstContext:n}}else Hc=Hc.next=n;return e}var Na=null;function Tb(n){Na===null?Na=[n]:Na.push(n)}function iC(n,e,t,s){var r=e.interleaved;return r===null?(t.next=t,Tb(e)):(t.next=r.next,r.next=t),e.interleaved=t,Ki(n,s)}function Ki(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var so=!1;function Pb(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oC(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function zi(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function aa(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,_e&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,Ki(n,t)}return r=s.interleaved,r===null?(e.next=e,Tb(s)):(e.next=r.next,r.next=e),s.interleaved=e,Ki(n,t)}function am(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,pb(n,t)}}function aA(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var r=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?r=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?r=i=e:i=i.next=e}else r=i=e;t={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function cy(n,e,t,s){var r=n.updateQueue;so=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var h=n.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(i!==null){var d=r.baseState;o=0,h=u=c=null,l=i;do{var f=l.lane,p=l.eventTime;if((s&f)===f){h!==null&&(h=h.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=n,v=l;switch(f=e,p=t,v.tag){case 1:if(y=v.payload,typeof y=="function"){d=y.call(p,d,f);break e}d=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,f=typeof y=="function"?y.call(p,d,f):y,f==null)break e;d=nt({},d,f);break e;case 2:so=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,f=r.effects,f===null?r.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=p,c=d):h=h.next=p,o|=f;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;f=l,l=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(h===null&&(c=d),r.baseState=c,r.firstBaseUpdate=u,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);ic|=o,n.lanes=o,n.memoizedState=d}}function lA(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],r=s.callback;if(r!==null){if(s.callback=null,s=t,typeof r!="function")throw Error(U(191,r));r.call(s)}}}var pg={},Kr=ya(pg),ef=ya(pg),tf=ya(pg);function Ma(n){if(n===pg)throw Error(U(174));return n}function Rb(n,e){switch($e(tf,e),$e(ef,n),$e(Kr,pg),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Rw(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Rw(e,n)}We(Kr),$e(Kr,e)}function Fh(){We(Kr),We(ef),We(tf)}function aC(n){Ma(tf.current);var e=Ma(Kr.current),t=Rw(e,n.type);e!==t&&($e(ef,n),$e(Kr,t))}function Ob(n){ef.current===n&&(We(Kr),We(ef))}var Ze=ya(0);function uy(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Gv=[];function Ib(){for(var n=0;n<Gv.length;n++)Gv[n]._workInProgressVersionPrimary=null;Gv.length=0}var lm=Qi.ReactCurrentDispatcher,qv=Qi.ReactCurrentBatchConfig,rc=0,et=null,xt=null,jt=null,hy=!1,Fd=!1,nf=0,KR=0;function tn(){throw Error(U(321))}function Lb(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!pr(n[t],e[t]))return!1;return!0}function Db(n,e,t,s,r,i){if(rc=i,et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,lm.current=n===null||n.memoizedState===null?QR:ZR,n=t(s,r),Fd){i=0;do{if(Fd=!1,nf=0,25<=i)throw Error(U(301));i+=1,jt=xt=null,e.updateQueue=null,lm.current=eO,n=t(s,r)}while(Fd)}if(lm.current=dy,e=xt!==null&&xt.next!==null,rc=0,jt=xt=et=null,hy=!1,e)throw Error(U(300));return n}function Nb(){var n=nf!==0;return nf=0,n}function br(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?et.memoizedState=jt=n:jt=jt.next=n,jt}function $s(){if(xt===null){var n=et.alternate;n=n!==null?n.memoizedState:null}else n=xt.next;var e=jt===null?et.memoizedState:jt.next;if(e!==null)jt=e,xt=n;else{if(n===null)throw Error(U(310));xt=n,n={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},jt===null?et.memoizedState=jt=n:jt=jt.next=n}return jt}function sf(n,e){return typeof e=="function"?e(n):e}function Kv(n){var e=$s(),t=e.queue;if(t===null)throw Error(U(311));t.lastRenderedReducer=n;var s=xt,r=s.baseQueue,i=t.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,t.pending=null}if(r!==null){i=r.next,s=s.baseState;var l=o=null,c=null,u=i;do{var h=u.lane;if((rc&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=d,o=s):c=c.next=d,et.lanes|=h,ic|=h}u=u.next}while(u!==null&&u!==i);c===null?o=s:c.next=l,pr(s,e.memoizedState)||(Fn=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){r=n;do i=r.lane,et.lanes|=i,ic|=i,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Xv(n){var e=$s(),t=e.queue;if(t===null)throw Error(U(311));t.lastRenderedReducer=n;var s=t.dispatch,r=t.pending,i=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do i=n(i,o.action),o=o.next;while(o!==r);pr(i,e.memoizedState)||(Fn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,s]}function lC(){}function cC(n,e){var t=et,s=$s(),r=e(),i=!pr(s.memoizedState,r);if(i&&(s.memoizedState=r,Fn=!0),s=s.queue,Mb(dC.bind(null,t,s,n),[n]),s.getSnapshot!==e||i||jt!==null&&jt.memoizedState.tag&1){if(t.flags|=2048,rf(9,hC.bind(null,t,s,r,e),void 0,null),Ut===null)throw Error(U(349));rc&30||uC(t,e,r)}return r}function uC(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function hC(n,e,t,s){e.value=t,e.getSnapshot=s,fC(e)&&pC(n)}function dC(n,e,t){return t(function(){fC(e)&&pC(n)})}function fC(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!pr(n,t)}catch{return!0}}function pC(n){var e=Ki(n,1);e!==null&&fr(e,n,1,-1)}function cA(n){var e=br();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sf,lastRenderedState:n},e.queue=n,n=n.dispatch=JR.bind(null,et,n),[e.memoizedState,n]}function rf(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=et.updateQueue,e===null?(e={lastEffect:null,stores:null},et.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function gC(){return $s().memoizedState}function cm(n,e,t,s){var r=br();et.flags|=n,r.memoizedState=rf(1|e,t,void 0,s===void 0?null:s)}function ov(n,e,t,s){var r=$s();s=s===void 0?null:s;var i=void 0;if(xt!==null){var o=xt.memoizedState;if(i=o.destroy,s!==null&&Lb(s,o.deps)){r.memoizedState=rf(e,t,i,s);return}}et.flags|=n,r.memoizedState=rf(1|e,t,i,s)}function uA(n,e){return cm(8390656,8,n,e)}function Mb(n,e){return ov(2048,8,n,e)}function mC(n,e){return ov(4,2,n,e)}function yC(n,e){return ov(4,4,n,e)}function vC(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function wC(n,e,t){return t=t!=null?t.concat([n]):null,ov(4,4,vC.bind(null,e,n),t)}function Fb(){}function _C(n,e){var t=$s();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Lb(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function bC(n,e){var t=$s();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Lb(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function SC(n,e,t){return rc&21?(pr(t,e)||(t=xk(),et.lanes|=t,ic|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Fn=!0),n.memoizedState=t)}function XR(n,e){var t=xe;xe=t!==0&&4>t?t:4,n(!0);var s=qv.transition;qv.transition={};try{n(!1),e()}finally{xe=t,qv.transition=s}}function AC(){return $s().memoizedState}function YR(n,e,t){var s=ca(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},EC(n))kC(e,t);else if(t=iC(n,e,t,s),t!==null){var r=An();fr(t,n,s,r),CC(t,e,s)}}function JR(n,e,t){var s=ca(n),r={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(EC(n))kC(e,r);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,t);if(r.hasEagerState=!0,r.eagerState=l,pr(l,o)){var c=e.interleaved;c===null?(r.next=r,Tb(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}t=iC(n,e,r,s),t!==null&&(r=An(),fr(t,n,s,r),CC(t,e,s))}}function EC(n){var e=n.alternate;return n===et||e!==null&&e===et}function kC(n,e){Fd=hy=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function CC(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,pb(n,t)}}var dy={readContext:Us,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},QR={readContext:Us,useCallback:function(n,e){return br().memoizedState=[n,e===void 0?null:e],n},useContext:Us,useEffect:uA,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,cm(4194308,4,vC.bind(null,e,n),t)},useLayoutEffect:function(n,e){return cm(4194308,4,n,e)},useInsertionEffect:function(n,e){return cm(4,2,n,e)},useMemo:function(n,e){var t=br();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=br();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=YR.bind(null,et,n),[s.memoizedState,n]},useRef:function(n){var e=br();return n={current:n},e.memoizedState=n},useState:cA,useDebugValue:Fb,useDeferredValue:function(n){return br().memoizedState=n},useTransition:function(){var n=cA(!1),e=n[0];return n=XR.bind(null,n[1]),br().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=et,r=br();if(Xe){if(t===void 0)throw Error(U(407));t=t()}else{if(t=e(),Ut===null)throw Error(U(349));rc&30||uC(s,e,t)}r.memoizedState=t;var i={value:t,getSnapshot:e};return r.queue=i,uA(dC.bind(null,s,i,n),[n]),s.flags|=2048,rf(9,hC.bind(null,s,i,t,e),void 0,null),t},useId:function(){var n=br(),e=Ut.identifierPrefix;if(Xe){var t=$i,s=Ui;t=(s&~(1<<32-dr(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=nf++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=KR++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},ZR={readContext:Us,useCallback:_C,useContext:Us,useEffect:Mb,useImperativeHandle:wC,useInsertionEffect:mC,useLayoutEffect:yC,useMemo:bC,useReducer:Kv,useRef:gC,useState:function(){return Kv(sf)},useDebugValue:Fb,useDeferredValue:function(n){var e=$s();return SC(e,xt.memoizedState,n)},useTransition:function(){var n=Kv(sf)[0],e=$s().memoizedState;return[n,e]},useMutableSource:lC,useSyncExternalStore:cC,useId:AC,unstable_isNewReconciler:!1},eO={readContext:Us,useCallback:_C,useContext:Us,useEffect:Mb,useImperativeHandle:wC,useInsertionEffect:mC,useLayoutEffect:yC,useMemo:bC,useReducer:Xv,useRef:gC,useState:function(){return Xv(sf)},useDebugValue:Fb,useDeferredValue:function(n){var e=$s();return xt===null?e.memoizedState=n:SC(e,xt.memoizedState,n)},useTransition:function(){var n=Xv(sf)[0],e=$s().memoizedState;return[n,e]},useMutableSource:lC,useSyncExternalStore:cC,useId:AC,unstable_isNewReconciler:!1};function Ks(n,e){if(n&&n.defaultProps){e=nt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Jw(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:nt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var av={isMounted:function(n){return(n=n._reactInternals)?hc(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=An(),r=ca(n),i=zi(s,r);i.payload=e,t!=null&&(i.callback=t),e=aa(n,i,r),e!==null&&(fr(e,n,r,s),am(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=An(),r=ca(n),i=zi(s,r);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=aa(n,i,r),e!==null&&(fr(e,n,r,s),am(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=An(),s=ca(n),r=zi(t,s);r.tag=2,e!=null&&(r.callback=e),e=aa(n,r,s),e!==null&&(fr(e,n,s,t),am(e,n,s))}};function hA(n,e,t,s,r,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Yd(t,s)||!Yd(r,i):!0}function xC(n,e,t){var s=!1,r=da,i=e.contextType;return typeof i=="object"&&i!==null?i=Us(i):(r=jn(e)?nc:dn.current,s=e.contextTypes,i=(s=s!=null)?Dh(n,r):da),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=av,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=i),e}function dA(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&av.enqueueReplaceState(e,e.state,null)}function Qw(n,e,t,s){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},Pb(n);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Us(i):(i=jn(e)?nc:dn.current,r.context=Dh(n,i)),r.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Jw(n,e,i,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&av.enqueueReplaceState(r,r.state,null),cy(n,t,r,s),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Bh(n,e){try{var t="",s=e;do t+=TP(s),s=s.return;while(s);var r=t}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:r,digest:null}}function Yv(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Zw(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var tO=typeof WeakMap=="function"?WeakMap:Map;function TC(n,e,t){t=zi(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){py||(py=!0,c0=s),Zw(n,e)},t}function PC(n,e,t){t=zi(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;t.payload=function(){return s(r)},t.callback=function(){Zw(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Zw(n,e),typeof s!="function"&&(la===null?la=new Set([this]):la.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function fA(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new tO;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(t)||(r.add(t),n=gO.bind(null,n,e,t),e.then(n,n))}function pA(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function gA(n,e,t,s,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=zi(-1,1),e.tag=2,aa(t,e,1))),t.lanes|=1),n)}var nO=Qi.ReactCurrentOwner,Fn=!1;function bn(n,e,t,s){e.child=n===null?rC(e,null,t,s):Mh(e,n.child,t,s)}function mA(n,e,t,s,r){t=t.render;var i=e.ref;return su(e,r),s=Db(n,e,t,s,i,r),t=Nb(),n!==null&&!Fn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Xi(n,e,r)):(Xe&&t&&Sb(e),e.flags|=1,bn(n,e,s,r),e.child)}function yA(n,e,t,s,r){if(n===null){var i=t.type;return typeof i=="function"&&!Wb(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,RC(n,e,i,s,r)):(n=fm(t.type,null,s,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&r)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Yd,t(o,s)&&n.ref===e.ref)return Xi(n,e,r)}return e.flags|=1,n=ua(i,s),n.ref=e.ref,n.return=e,e.child=n}function RC(n,e,t,s,r){if(n!==null){var i=n.memoizedProps;if(Yd(i,s)&&n.ref===e.ref)if(Fn=!1,e.pendingProps=s=i,(n.lanes&r)!==0)n.flags&131072&&(Fn=!0);else return e.lanes=n.lanes,Xi(n,e,r)}return e0(n,e,t,s,r)}function OC(n,e,t){var s=e.pendingProps,r=s.children,i=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(Wc,cs),cs|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,$e(Wc,cs),cs|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:t,$e(Wc,cs),cs|=s}else i!==null?(s=i.baseLanes|t,e.memoizedState=null):s=t,$e(Wc,cs),cs|=s;return bn(n,e,r,t),e.child}function IC(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function e0(n,e,t,s,r){var i=jn(t)?nc:dn.current;return i=Dh(e,i),su(e,r),t=Db(n,e,t,s,i,r),s=Nb(),n!==null&&!Fn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Xi(n,e,r)):(Xe&&s&&Sb(e),e.flags|=1,bn(n,e,t,r),e.child)}function vA(n,e,t,s,r){if(jn(t)){var i=!0;ry(e)}else i=!1;if(su(e,r),e.stateNode===null)um(n,e),xC(e,t,s),Qw(e,t,s,r),s=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Us(u):(u=jn(t)?nc:dn.current,u=Dh(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==u)&&dA(e,o,s,u),so=!1;var f=e.memoizedState;o.state=f,cy(e,s,o,r),c=e.memoizedState,l!==s||f!==c||Bn.current||so?(typeof h=="function"&&(Jw(e,t,h,s),c=e.memoizedState),(l=so||hA(e,t,l,s,f,c,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=u,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,oC(n,e),l=e.memoizedProps,u=e.type===e.elementType?l:Ks(e.type,l),o.props=u,d=e.pendingProps,f=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=Us(c):(c=jn(t)?nc:dn.current,c=Dh(e,c));var p=t.getDerivedStateFromProps;(h=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==c)&&dA(e,o,s,c),so=!1,f=e.memoizedState,o.state=f,cy(e,s,o,r);var y=e.memoizedState;l!==d||f!==y||Bn.current||so?(typeof p=="function"&&(Jw(e,t,p,s),y=e.memoizedState),(u=so||hA(e,t,u,s,f,y,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=y),o.props=s,o.state=y,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),s=!1)}return t0(n,e,t,s,i,r)}function t0(n,e,t,s,r,i){IC(n,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&sA(e,t,!1),Xi(n,e,i);s=e.stateNode,nO.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&o?(e.child=Mh(e,n.child,null,i),e.child=Mh(e,null,l,i)):bn(n,e,l,i),e.memoizedState=s.state,r&&sA(e,t,!0),e.child}function LC(n){var e=n.stateNode;e.pendingContext?nA(n,e.pendingContext,e.pendingContext!==e.context):e.context&&nA(n,e.context,!1),Rb(n,e.containerInfo)}function wA(n,e,t,s,r){return Nh(),Eb(r),e.flags|=256,bn(n,e,t,s),e.child}var n0={dehydrated:null,treeContext:null,retryLane:0};function s0(n){return{baseLanes:n,cachePool:null,transitions:null}}function DC(n,e,t){var s=e.pendingProps,r=Ze.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(r&2)!==0),l?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),$e(Ze,r&1),n===null)return Xw(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,n=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=uv(o,s,0,null),n=ec(n,s,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=s0(t),e.memoizedState=n0,n):Bb(e,o));if(r=n.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return sO(n,e,o,s,l,r,t);if(i){i=s.fallback,o=e.mode,r=n.child,l=r.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=ua(r,c),s.subtreeFlags=r.subtreeFlags&14680064),l!==null?i=ua(l,i):(i=ec(i,o,t,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=n.child.memoizedState,o=o===null?s0(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=n0,s}return i=n.child,n=i.sibling,s=ua(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function Bb(n,e){return e=uv({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Bg(n,e,t,s){return s!==null&&Eb(s),Mh(e,n.child,null,t),n=Bb(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function sO(n,e,t,s,r,i,o){if(t)return e.flags&256?(e.flags&=-257,s=Yv(Error(U(422))),Bg(n,e,o,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=uv({mode:"visible",children:s.children},r,0,null),i=ec(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Mh(e,n.child,null,o),e.child.memoizedState=s0(o),e.memoizedState=n0,i);if(!(e.mode&1))return Bg(n,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(U(419)),s=Yv(i,s,void 0),Bg(n,e,o,s)}if(l=(o&n.childLanes)!==0,Fn||l){if(s=Ut,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,Ki(n,r),fr(s,n,r,-1))}return Vb(),s=Yv(Error(U(421))),Bg(n,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=mO.bind(null,n),r._reactRetry=e,null):(n=i.treeContext,ps=oa(r.nextSibling),gs=e,Xe=!0,ur=null,n!==null&&(Ds[Ns++]=Ui,Ds[Ns++]=$i,Ds[Ns++]=sc,Ui=n.id,$i=n.overflow,sc=e),e=Bb(e,s.children),e.flags|=4096,e)}function _A(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),Yw(n.return,e,t)}function Jv(n,e,t,s,r){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=t,i.tailMode=r)}function NC(n,e,t){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(bn(n,e,s.children,t),s=Ze.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&_A(n,t,e);else if(n.tag===19)_A(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if($e(Ze,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&uy(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),Jv(e,!1,r,t,i);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&uy(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}Jv(e,!0,t,null,i);break;case"together":Jv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function um(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Xi(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ic|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(U(153));if(e.child!==null){for(n=e.child,t=ua(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=ua(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function rO(n,e,t){switch(e.tag){case 3:LC(e),Nh();break;case 5:aC(e);break;case 1:jn(e.type)&&ry(e);break;case 4:Rb(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;$e(ay,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?($e(Ze,Ze.current&1),e.flags|=128,null):t&e.child.childLanes?DC(n,e,t):($e(Ze,Ze.current&1),n=Xi(n,e,t),n!==null?n.sibling:null);$e(Ze,Ze.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return NC(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),$e(Ze,Ze.current),s)break;return null;case 22:case 23:return e.lanes=0,OC(n,e,t)}return Xi(n,e,t)}var MC,r0,FC,BC;MC=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};r0=function(){};FC=function(n,e,t,s){var r=n.memoizedProps;if(r!==s){n=e.stateNode,Ma(Kr.current);var i=null;switch(t){case"input":r=Cw(n,r),s=Cw(n,s),i=[];break;case"select":r=nt({},r,{value:void 0}),s=nt({},s,{value:void 0}),i=[];break;case"textarea":r=Pw(n,r),s=Pw(n,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=ny)}Ow(t,s);var o;t=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var l=r[u];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Hd.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var c=s[u];if(l=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(i||(i=[]),i.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Hd.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&He("scroll",n),i||l===c||(i=[])):(i=i||[]).push(u,c))}t&&(i=i||[]).push("style",t);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};BC=function(n,e,t,s){t!==s&&(e.flags|=4)};function Qh(n,e){if(!Xe)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function nn(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function iO(n,e,t){var s=e.pendingProps;switch(Ab(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(e),null;case 1:return jn(e.type)&&sy(),nn(e),null;case 3:return s=e.stateNode,Fh(),We(Bn),We(dn),Ib(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Mg(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ur!==null&&(d0(ur),ur=null))),r0(n,e),nn(e),null;case 5:Ob(e);var r=Ma(tf.current);if(t=e.type,n!==null&&e.stateNode!=null)FC(n,e,t,s,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(U(166));return nn(e),null}if(n=Ma(Kr.current),Mg(e)){s=e.stateNode,t=e.type;var i=e.memoizedProps;switch(s[Vr]=e,s[Zd]=i,n=(e.mode&1)!==0,t){case"dialog":He("cancel",s),He("close",s);break;case"iframe":case"object":case"embed":He("load",s);break;case"video":case"audio":for(r=0;r<ld.length;r++)He(ld[r],s);break;case"source":He("error",s);break;case"img":case"image":case"link":He("error",s),He("load",s);break;case"details":He("toggle",s);break;case"input":PS(s,i),He("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},He("invalid",s);break;case"textarea":OS(s,i),He("invalid",s)}Ow(t,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ng(s.textContent,l,n),r=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ng(s.textContent,l,n),r=["children",""+l]):Hd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&He("scroll",s)}switch(t){case"input":xg(s),RS(s,i,!0);break;case"textarea":xg(s),IS(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=ny)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=dk(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=o.createElement(t,{is:s.is}):(n=o.createElement(t),t==="select"&&(o=n,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):n=o.createElementNS(n,t),n[Vr]=e,n[Zd]=s,MC(n,e,!1,!1),e.stateNode=n;e:{switch(o=Iw(t,s),t){case"dialog":He("cancel",n),He("close",n),r=s;break;case"iframe":case"object":case"embed":He("load",n),r=s;break;case"video":case"audio":for(r=0;r<ld.length;r++)He(ld[r],n);r=s;break;case"source":He("error",n),r=s;break;case"img":case"image":case"link":He("error",n),He("load",n),r=s;break;case"details":He("toggle",n),r=s;break;case"input":PS(n,s),r=Cw(n,s),He("invalid",n);break;case"option":r=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},r=nt({},s,{value:void 0}),He("invalid",n);break;case"textarea":OS(n,s),r=Pw(n,s),He("invalid",n);break;default:r=s}Ow(t,r),l=r;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?gk(n,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&fk(n,c)):i==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Vd(n,c):typeof c=="number"&&Vd(n,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Hd.hasOwnProperty(i)?c!=null&&i==="onScroll"&&He("scroll",n):c!=null&&lb(n,i,c,o))}switch(t){case"input":xg(n),RS(n,s,!1);break;case"textarea":xg(n),IS(n);break;case"option":s.value!=null&&n.setAttribute("value",""+ha(s.value));break;case"select":n.multiple=!!s.multiple,i=s.value,i!=null?Zc(n,!!s.multiple,i,!1):s.defaultValue!=null&&Zc(n,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=ny)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return nn(e),null;case 6:if(n&&e.stateNode!=null)BC(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(U(166));if(t=Ma(tf.current),Ma(Kr.current),Mg(e)){if(s=e.stateNode,t=e.memoizedProps,s[Vr]=e,(i=s.nodeValue!==t)&&(n=gs,n!==null))switch(n.tag){case 3:Ng(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Ng(s.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Vr]=e,e.stateNode=s}return nn(e),null;case 13:if(We(Ze),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Xe&&ps!==null&&e.mode&1&&!(e.flags&128))nC(),Nh(),e.flags|=98560,i=!1;else if(i=Mg(e),s!==null&&s.dehydrated!==null){if(n===null){if(!i)throw Error(U(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[Vr]=e}else Nh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;nn(e),i=!1}else ur!==null&&(d0(ur),ur=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||Ze.current&1?Tt===0&&(Tt=3):Vb())),e.updateQueue!==null&&(e.flags|=4),nn(e),null);case 4:return Fh(),r0(n,e),n===null&&Jd(e.stateNode.containerInfo),nn(e),null;case 10:return xb(e.type._context),nn(e),null;case 17:return jn(e.type)&&sy(),nn(e),null;case 19:if(We(Ze),i=e.memoizedState,i===null)return nn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)Qh(i,!1);else{if(Tt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=uy(n),o!==null){for(e.flags|=128,Qh(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)i=t,n=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return $e(Ze,Ze.current&1|2),e.child}n=n.sibling}i.tail!==null&&ft()>jh&&(e.flags|=128,s=!0,Qh(i,!1),e.lanes=4194304)}else{if(!s)if(n=uy(o),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Qh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Xe)return nn(e),null}else 2*ft()-i.renderingStartTime>jh&&t!==1073741824&&(e.flags|=128,s=!0,Qh(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ft(),e.sibling=null,t=Ze.current,$e(Ze,s?t&1|2:t&1),e):(nn(e),null);case 22:case 23:return Hb(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?cs&1073741824&&(nn(e),e.subtreeFlags&6&&(e.flags|=8192)):nn(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function oO(n,e){switch(Ab(e),e.tag){case 1:return jn(e.type)&&sy(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Fh(),We(Bn),We(dn),Ib(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Ob(e),null;case 13:if(We(Ze),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Nh()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return We(Ze),null;case 4:return Fh(),null;case 10:return xb(e.type._context),null;case 22:case 23:return Hb(),null;case 24:return null;default:return null}}var jg=!1,hn=!1,aO=typeof WeakSet=="function"?WeakSet:Set,q=null;function Vc(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){ct(n,e,s)}else t.current=null}function i0(n,e,t){try{t()}catch(s){ct(n,e,s)}}var bA=!1;function lO(n,e){if(zw=Zm,n=Hk(),bb(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=n,f=null;t:for(;;){for(var p;d!==t||r!==0&&d.nodeType!==3||(l=o+r),d!==i||s!==0&&d.nodeType!==3||(c=o+s),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===n)break t;if(f===t&&++u===r&&(l=o),f===i&&++h===s&&(c=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Hw={focusedElem:n,selectionRange:t},Zm=!1,q=e;q!==null;)if(e=q,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,q=n;else for(;q!==null;){e=q;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,S=y.memoizedState,m=e.stateNode,w=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:Ks(e.type,v),S);m.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(E){ct(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,q=n;break}q=e.return}return y=bA,bA=!1,y}function Bd(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&n)===n){var i=r.destroy;r.destroy=void 0,i!==void 0&&i0(e,t,i)}r=r.next}while(r!==s)}}function lv(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function o0(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function jC(n){var e=n.alternate;e!==null&&(n.alternate=null,jC(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Vr],delete e[Zd],delete e[Gw],delete e[VR],delete e[WR])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function UC(n){return n.tag===5||n.tag===3||n.tag===4}function SA(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||UC(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function a0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=ny));else if(s!==4&&(n=n.child,n!==null))for(a0(n,e,t),n=n.sibling;n!==null;)a0(n,e,t),n=n.sibling}function l0(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(l0(n,e,t),n=n.sibling;n!==null;)l0(n,e,t),n=n.sibling}var Xt=null,lr=!1;function eo(n,e,t){for(t=t.child;t!==null;)$C(n,e,t),t=t.sibling}function $C(n,e,t){if(qr&&typeof qr.onCommitFiberUnmount=="function")try{qr.onCommitFiberUnmount(ev,t)}catch{}switch(t.tag){case 5:hn||Vc(t,e);case 6:var s=Xt,r=lr;Xt=null,eo(n,e,t),Xt=s,lr=r,Xt!==null&&(lr?(n=Xt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Xt.removeChild(t.stateNode));break;case 18:Xt!==null&&(lr?(n=Xt,t=t.stateNode,n.nodeType===8?Vv(n.parentNode,t):n.nodeType===1&&Vv(n,t),Kd(n)):Vv(Xt,t.stateNode));break;case 4:s=Xt,r=lr,Xt=t.stateNode.containerInfo,lr=!0,eo(n,e,t),Xt=s,lr=r;break;case 0:case 11:case 14:case 15:if(!hn&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&i0(t,e,o),r=r.next}while(r!==s)}eo(n,e,t);break;case 1:if(!hn&&(Vc(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(l){ct(t,e,l)}eo(n,e,t);break;case 21:eo(n,e,t);break;case 22:t.mode&1?(hn=(s=hn)||t.memoizedState!==null,eo(n,e,t),hn=s):eo(n,e,t);break;default:eo(n,e,t)}}function AA(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new aO),e.forEach(function(s){var r=yO.bind(null,n,s);t.has(s)||(t.add(s),s.then(r,r))})}}function Vs(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var r=t[s];try{var i=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Xt=l.stateNode,lr=!1;break e;case 3:Xt=l.stateNode.containerInfo,lr=!0;break e;case 4:Xt=l.stateNode.containerInfo,lr=!0;break e}l=l.return}if(Xt===null)throw Error(U(160));$C(i,o,r),Xt=null,lr=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(u){ct(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)zC(e,n),e=e.sibling}function zC(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Vs(e,n),mr(n),s&4){try{Bd(3,n,n.return),lv(3,n)}catch(v){ct(n,n.return,v)}try{Bd(5,n,n.return)}catch(v){ct(n,n.return,v)}}break;case 1:Vs(e,n),mr(n),s&512&&t!==null&&Vc(t,t.return);break;case 5:if(Vs(e,n),mr(n),s&512&&t!==null&&Vc(t,t.return),n.flags&32){var r=n.stateNode;try{Vd(r,"")}catch(v){ct(n,n.return,v)}}if(s&4&&(r=n.stateNode,r!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&uk(r,i),Iw(l,o);var u=Iw(l,i);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];h==="style"?gk(r,d):h==="dangerouslySetInnerHTML"?fk(r,d):h==="children"?Vd(r,d):lb(r,h,d,u)}switch(l){case"input":xw(r,i);break;case"textarea":hk(r,i);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Zc(r,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?Zc(r,!!i.multiple,i.defaultValue,!0):Zc(r,!!i.multiple,i.multiple?[]:"",!1))}r[Zd]=i}catch(v){ct(n,n.return,v)}}break;case 6:if(Vs(e,n),mr(n),s&4){if(n.stateNode===null)throw Error(U(162));r=n.stateNode,i=n.memoizedProps;try{r.nodeValue=i}catch(v){ct(n,n.return,v)}}break;case 3:if(Vs(e,n),mr(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Kd(e.containerInfo)}catch(v){ct(n,n.return,v)}break;case 4:Vs(e,n),mr(n);break;case 13:Vs(e,n),mr(n),r=n.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||($b=ft())),s&4&&AA(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(hn=(u=hn)||h,Vs(e,n),hn=u):Vs(e,n),mr(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(q=n,h=n.child;h!==null;){for(d=q=h;q!==null;){switch(f=q,p=f.child,f.tag){case 0:case 11:case 14:case 15:Bd(4,f,f.return);break;case 1:Vc(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){s=f,t=f.return;try{e=s,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){ct(s,t,v)}}break;case 5:Vc(f,f.return);break;case 22:if(f.memoizedState!==null){kA(d);continue}}p!==null?(p.return=f,q=p):kA(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{r=d.stateNode,u?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=pk("display",o))}catch(v){ct(n,n.return,v)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){ct(n,n.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Vs(e,n),mr(n),s&4&&AA(n);break;case 21:break;default:Vs(e,n),mr(n)}}function mr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(UC(t)){var s=t;break e}t=t.return}throw Error(U(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Vd(r,""),s.flags&=-33);var i=SA(n);l0(n,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,l=SA(n);a0(n,l,o);break;default:throw Error(U(161))}}catch(c){ct(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function cO(n,e,t){q=n,HC(n)}function HC(n,e,t){for(var s=(n.mode&1)!==0;q!==null;){var r=q,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||jg;if(!o){var l=r.alternate,c=l!==null&&l.memoizedState!==null||hn;l=jg;var u=hn;if(jg=o,(hn=c)&&!u)for(q=r;q!==null;)o=q,c=o.child,o.tag===22&&o.memoizedState!==null?CA(r):c!==null?(c.return=o,q=c):CA(r);for(;i!==null;)q=i,HC(i),i=i.sibling;q=r,jg=l,hn=u}EA(n)}else r.subtreeFlags&8772&&i!==null?(i.return=r,q=i):EA(n)}}function EA(n){for(;q!==null;){var e=q;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:hn||lv(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!hn)if(t===null)s.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Ks(e.type,t.memoizedProps);s.componentDidUpdate(r,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&lA(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}lA(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Kd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}hn||e.flags&512&&o0(e)}catch(f){ct(e,e.return,f)}}if(e===n){q=null;break}if(t=e.sibling,t!==null){t.return=e.return,q=t;break}q=e.return}}function kA(n){for(;q!==null;){var e=q;if(e===n){q=null;break}var t=e.sibling;if(t!==null){t.return=e.return,q=t;break}q=e.return}}function CA(n){for(;q!==null;){var e=q;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{lv(4,e)}catch(c){ct(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(c){ct(e,r,c)}}var i=e.return;try{o0(e)}catch(c){ct(e,i,c)}break;case 5:var o=e.return;try{o0(e)}catch(c){ct(e,o,c)}}}catch(c){ct(e,e.return,c)}if(e===n){q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,q=l;break}q=e.return}}var uO=Math.ceil,fy=Qi.ReactCurrentDispatcher,jb=Qi.ReactCurrentOwner,Bs=Qi.ReactCurrentBatchConfig,_e=0,Ut=null,vt=null,Zt=0,cs=0,Wc=ya(0),Tt=0,of=null,ic=0,cv=0,Ub=0,jd=null,Mn=null,$b=0,jh=1/0,ei=null,py=!1,c0=null,la=null,Ug=!1,ta=null,gy=0,Ud=0,u0=null,hm=-1,dm=0;function An(){return _e&6?ft():hm!==-1?hm:hm=ft()}function ca(n){return n.mode&1?_e&2&&Zt!==0?Zt&-Zt:qR.transition!==null?(dm===0&&(dm=xk()),dm):(n=xe,n!==0||(n=window.event,n=n===void 0?16:Dk(n.type)),n):1}function fr(n,e,t,s){if(50<Ud)throw Ud=0,u0=null,Error(U(185));hg(n,t,s),(!(_e&2)||n!==Ut)&&(n===Ut&&(!(_e&2)&&(cv|=t),Tt===4&&oo(n,Zt)),Un(n,s),t===1&&_e===0&&!(e.mode&1)&&(jh=ft()+500,iv&&va()))}function Un(n,e){var t=n.callbackNode;qP(n,e);var s=Qm(n,n===Ut?Zt:0);if(s===0)t!==null&&NS(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&NS(t),e===1)n.tag===0?GR(xA.bind(null,n)):Zk(xA.bind(null,n)),zR(function(){!(_e&6)&&va()}),t=null;else{switch(Tk(s)){case 1:t=fb;break;case 4:t=kk;break;case 16:t=Jm;break;case 536870912:t=Ck;break;default:t=Jm}t=JC(t,VC.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function VC(n,e){if(hm=-1,dm=0,_e&6)throw Error(U(327));var t=n.callbackNode;if(ru()&&n.callbackNode!==t)return null;var s=Qm(n,n===Ut?Zt:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=my(n,s);else{e=s;var r=_e;_e|=2;var i=GC();(Ut!==n||Zt!==e)&&(ei=null,jh=ft()+500,Zl(n,e));do try{fO();break}catch(l){WC(n,l)}while(!0);Cb(),fy.current=i,_e=r,vt!==null?e=0:(Ut=null,Zt=0,e=Tt)}if(e!==0){if(e===2&&(r=Fw(n),r!==0&&(s=r,e=h0(n,r))),e===1)throw t=of,Zl(n,0),oo(n,s),Un(n,ft()),t;if(e===6)oo(n,s);else{if(r=n.current.alternate,!(s&30)&&!hO(r)&&(e=my(n,s),e===2&&(i=Fw(n),i!==0&&(s=i,e=h0(n,i))),e===1))throw t=of,Zl(n,0),oo(n,s),Un(n,ft()),t;switch(n.finishedWork=r,n.finishedLanes=s,e){case 0:case 1:throw Error(U(345));case 2:Ea(n,Mn,ei);break;case 3:if(oo(n,s),(s&130023424)===s&&(e=$b+500-ft(),10<e)){if(Qm(n,0)!==0)break;if(r=n.suspendedLanes,(r&s)!==s){An(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=Ww(Ea.bind(null,n,Mn,ei),e);break}Ea(n,Mn,ei);break;case 4:if(oo(n,s),(s&4194240)===s)break;for(e=n.eventTimes,r=-1;0<s;){var o=31-dr(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=ft()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*uO(s/1960))-s,10<s){n.timeoutHandle=Ww(Ea.bind(null,n,Mn,ei),s);break}Ea(n,Mn,ei);break;case 5:Ea(n,Mn,ei);break;default:throw Error(U(329))}}}return Un(n,ft()),n.callbackNode===t?VC.bind(null,n):null}function h0(n,e){var t=jd;return n.current.memoizedState.isDehydrated&&(Zl(n,e).flags|=256),n=my(n,e),n!==2&&(e=Mn,Mn=t,e!==null&&d0(e)),n}function d0(n){Mn===null?Mn=n:Mn.push.apply(Mn,n)}function hO(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var r=t[s],i=r.getSnapshot;r=r.value;try{if(!pr(i(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function oo(n,e){for(e&=~Ub,e&=~cv,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-dr(e),s=1<<t;n[t]=-1,e&=~s}}function xA(n){if(_e&6)throw Error(U(327));ru();var e=Qm(n,0);if(!(e&1))return Un(n,ft()),null;var t=my(n,e);if(n.tag!==0&&t===2){var s=Fw(n);s!==0&&(e=s,t=h0(n,s))}if(t===1)throw t=of,Zl(n,0),oo(n,e),Un(n,ft()),t;if(t===6)throw Error(U(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ea(n,Mn,ei),Un(n,ft()),null}function zb(n,e){var t=_e;_e|=1;try{return n(e)}finally{_e=t,_e===0&&(jh=ft()+500,iv&&va())}}function oc(n){ta!==null&&ta.tag===0&&!(_e&6)&&ru();var e=_e;_e|=1;var t=Bs.transition,s=xe;try{if(Bs.transition=null,xe=1,n)return n()}finally{xe=s,Bs.transition=t,_e=e,!(_e&6)&&va()}}function Hb(){cs=Wc.current,We(Wc)}function Zl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,$R(t)),vt!==null)for(t=vt.return;t!==null;){var s=t;switch(Ab(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&sy();break;case 3:Fh(),We(Bn),We(dn),Ib();break;case 5:Ob(s);break;case 4:Fh();break;case 13:We(Ze);break;case 19:We(Ze);break;case 10:xb(s.type._context);break;case 22:case 23:Hb()}t=t.return}if(Ut=n,vt=n=ua(n.current,null),Zt=cs=e,Tt=0,of=null,Ub=cv=ic=0,Mn=jd=null,Na!==null){for(e=0;e<Na.length;e++)if(t=Na[e],s=t.interleaved,s!==null){t.interleaved=null;var r=s.next,i=t.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}t.pending=s}Na=null}return n}function WC(n,e){do{var t=vt;try{if(Cb(),lm.current=dy,hy){for(var s=et.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}hy=!1}if(rc=0,jt=xt=et=null,Fd=!1,nf=0,jb.current=null,t===null||t.return===null){Tt=1,of=e,vt=null;break}e:{var i=n,o=t.return,l=t,c=e;if(e=Zt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=pA(o);if(p!==null){p.flags&=-257,gA(p,o,l,i,e),p.mode&1&&fA(i,u,e),e=p,c=u;var y=e.updateQueue;if(y===null){var v=new Set;v.add(c),e.updateQueue=v}else y.add(c);break e}else{if(!(e&1)){fA(i,u,e),Vb();break e}c=Error(U(426))}}else if(Xe&&l.mode&1){var S=pA(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),gA(S,o,l,i,e),Eb(Bh(c,l));break e}}i=c=Bh(c,l),Tt!==4&&(Tt=2),jd===null?jd=[i]:jd.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var m=TC(i,c,e);aA(i,m);break e;case 1:l=c;var w=i.type,_=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(la===null||!la.has(_)))){i.flags|=65536,e&=-e,i.lanes|=e;var E=PC(i,l,e);aA(i,E);break e}}i=i.return}while(i!==null)}KC(t)}catch(k){e=k,vt===t&&t!==null&&(vt=t=t.return);continue}break}while(!0)}function GC(){var n=fy.current;return fy.current=dy,n===null?dy:n}function Vb(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Ut===null||!(ic&268435455)&&!(cv&268435455)||oo(Ut,Zt)}function my(n,e){var t=_e;_e|=2;var s=GC();(Ut!==n||Zt!==e)&&(ei=null,Zl(n,e));do try{dO();break}catch(r){WC(n,r)}while(!0);if(Cb(),_e=t,fy.current=s,vt!==null)throw Error(U(261));return Ut=null,Zt=0,Tt}function dO(){for(;vt!==null;)qC(vt)}function fO(){for(;vt!==null&&!BP();)qC(vt)}function qC(n){var e=YC(n.alternate,n,cs);n.memoizedProps=n.pendingProps,e===null?KC(n):vt=e,jb.current=null}function KC(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=oO(t,e),t!==null){t.flags&=32767,vt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Tt=6,vt=null;return}}else if(t=iO(t,e,cs),t!==null){vt=t;return}if(e=e.sibling,e!==null){vt=e;return}vt=e=n}while(e!==null);Tt===0&&(Tt=5)}function Ea(n,e,t){var s=xe,r=Bs.transition;try{Bs.transition=null,xe=1,pO(n,e,t,s)}finally{Bs.transition=r,xe=s}return null}function pO(n,e,t,s){do ru();while(ta!==null);if(_e&6)throw Error(U(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(U(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(KP(n,i),n===Ut&&(vt=Ut=null,Zt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Ug||(Ug=!0,JC(Jm,function(){return ru(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Bs.transition,Bs.transition=null;var o=xe;xe=1;var l=_e;_e|=4,jb.current=null,lO(n,t),zC(t,n),DR(Hw),Zm=!!zw,Hw=zw=null,n.current=t,cO(t),jP(),_e=l,xe=o,Bs.transition=i}else n.current=t;if(Ug&&(Ug=!1,ta=n,gy=r),i=n.pendingLanes,i===0&&(la=null),zP(t.stateNode),Un(n,ft()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],s(r.value,{componentStack:r.stack,digest:r.digest});if(py)throw py=!1,n=c0,c0=null,n;return gy&1&&n.tag!==0&&ru(),i=n.pendingLanes,i&1?n===u0?Ud++:(Ud=0,u0=n):Ud=0,va(),null}function ru(){if(ta!==null){var n=Tk(gy),e=Bs.transition,t=xe;try{if(Bs.transition=null,xe=16>n?16:n,ta===null)var s=!1;else{if(n=ta,ta=null,gy=0,_e&6)throw Error(U(331));var r=_e;for(_e|=4,q=n.current;q!==null;){var i=q,o=i.child;if(q.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(q=u;q!==null;){var h=q;switch(h.tag){case 0:case 11:case 15:Bd(8,h,i)}var d=h.child;if(d!==null)d.return=h,q=d;else for(;q!==null;){h=q;var f=h.sibling,p=h.return;if(jC(h),h===u){q=null;break}if(f!==null){f.return=p,q=f;break}q=p}}}var y=i.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var S=v.sibling;v.sibling=null,v=S}while(v!==null)}}q=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,q=o;else e:for(;q!==null;){if(i=q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Bd(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,q=m;break e}q=i.return}}var w=n.current;for(q=w;q!==null;){o=q;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,q=_;else e:for(o=w;q!==null;){if(l=q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:lv(9,l)}}catch(k){ct(l,l.return,k)}if(l===o){q=null;break e}var E=l.sibling;if(E!==null){E.return=l.return,q=E;break e}q=l.return}}if(_e=r,va(),qr&&typeof qr.onPostCommitFiberRoot=="function")try{qr.onPostCommitFiberRoot(ev,n)}catch{}s=!0}return s}finally{xe=t,Bs.transition=e}}return!1}function TA(n,e,t){e=Bh(t,e),e=TC(n,e,1),n=aa(n,e,1),e=An(),n!==null&&(hg(n,1,e),Un(n,e))}function ct(n,e,t){if(n.tag===3)TA(n,n,t);else for(;e!==null;){if(e.tag===3){TA(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(la===null||!la.has(s))){n=Bh(t,n),n=PC(e,n,1),e=aa(e,n,1),n=An(),e!==null&&(hg(e,1,n),Un(e,n));break}}e=e.return}}function gO(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=An(),n.pingedLanes|=n.suspendedLanes&t,Ut===n&&(Zt&t)===t&&(Tt===4||Tt===3&&(Zt&130023424)===Zt&&500>ft()-$b?Zl(n,0):Ub|=t),Un(n,e)}function XC(n,e){e===0&&(n.mode&1?(e=Rg,Rg<<=1,!(Rg&130023424)&&(Rg=4194304)):e=1);var t=An();n=Ki(n,e),n!==null&&(hg(n,e,t),Un(n,t))}function mO(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),XC(n,t)}function yO(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(U(314))}s!==null&&s.delete(e),XC(n,t)}var YC;YC=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Bn.current)Fn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Fn=!1,rO(n,e,t);Fn=!!(n.flags&131072)}else Fn=!1,Xe&&e.flags&1048576&&eC(e,oy,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;um(n,e),n=e.pendingProps;var r=Dh(e,dn.current);su(e,t),r=Db(null,e,s,n,r,t);var i=Nb();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jn(s)?(i=!0,ry(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Pb(e),r.updater=av,e.stateNode=r,r._reactInternals=e,Qw(e,s,n,t),e=t0(null,e,s,!0,i,t)):(e.tag=0,Xe&&i&&Sb(e),bn(null,e,r,t),e=e.child),e;case 16:s=e.elementType;e:{switch(um(n,e),n=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=wO(s),n=Ks(s,n),r){case 0:e=e0(null,e,s,n,t);break e;case 1:e=vA(null,e,s,n,t);break e;case 11:e=mA(null,e,s,n,t);break e;case 14:e=yA(null,e,s,Ks(s.type,n),t);break e}throw Error(U(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Ks(s,r),e0(n,e,s,r,t);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Ks(s,r),vA(n,e,s,r,t);case 3:e:{if(LC(e),n===null)throw Error(U(387));s=e.pendingProps,i=e.memoizedState,r=i.element,oC(n,e),cy(e,s,null,t);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=Bh(Error(U(423)),e),e=wA(n,e,s,t,r);break e}else if(s!==r){r=Bh(Error(U(424)),e),e=wA(n,e,s,t,r);break e}else for(ps=oa(e.stateNode.containerInfo.firstChild),gs=e,Xe=!0,ur=null,t=rC(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Nh(),s===r){e=Xi(n,e,t);break e}bn(n,e,s,t)}e=e.child}return e;case 5:return aC(e),n===null&&Xw(e),s=e.type,r=e.pendingProps,i=n!==null?n.memoizedProps:null,o=r.children,Vw(s,r)?o=null:i!==null&&Vw(s,i)&&(e.flags|=32),IC(n,e),bn(n,e,o,t),e.child;case 6:return n===null&&Xw(e),null;case 13:return DC(n,e,t);case 4:return Rb(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=Mh(e,null,s,t):bn(n,e,s,t),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Ks(s,r),mA(n,e,s,r,t);case 7:return bn(n,e,e.pendingProps,t),e.child;case 8:return bn(n,e,e.pendingProps.children,t),e.child;case 12:return bn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,$e(ay,s._currentValue),s._currentValue=o,i!==null)if(pr(i.value,o)){if(i.children===r.children&&!Bn.current){e=Xi(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=zi(-1,t&-t),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}i.lanes|=t,c=i.alternate,c!==null&&(c.lanes|=t),Yw(i.return,t,e),l.lanes|=t;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),Yw(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}bn(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,su(e,t),r=Us(r),s=s(r),e.flags|=1,bn(n,e,s,t),e.child;case 14:return s=e.type,r=Ks(s,e.pendingProps),r=Ks(s.type,r),yA(n,e,s,r,t);case 15:return RC(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Ks(s,r),um(n,e),e.tag=1,jn(s)?(n=!0,ry(e)):n=!1,su(e,t),xC(e,s,r),Qw(e,s,r,t),t0(null,e,s,!0,n,t);case 19:return NC(n,e,t);case 22:return OC(n,e,t)}throw Error(U(156,e.tag))};function JC(n,e){return Ek(n,e)}function vO(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fs(n,e,t,s){return new vO(n,e,t,s)}function Wb(n){return n=n.prototype,!(!n||!n.isReactComponent)}function wO(n){if(typeof n=="function")return Wb(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ub)return 11;if(n===hb)return 14}return 2}function ua(n,e){var t=n.alternate;return t===null?(t=Fs(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function fm(n,e,t,s,r,i){var o=2;if(s=n,typeof n=="function")Wb(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Nc:return ec(t.children,r,i,e);case cb:o=8,r|=8;break;case Sw:return n=Fs(12,t,e,r|2),n.elementType=Sw,n.lanes=i,n;case Aw:return n=Fs(13,t,e,r),n.elementType=Aw,n.lanes=i,n;case Ew:return n=Fs(19,t,e,r),n.elementType=Ew,n.lanes=i,n;case ak:return uv(t,r,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ik:o=10;break e;case ok:o=9;break e;case ub:o=11;break e;case hb:o=14;break e;case no:o=16,s=null;break e}throw Error(U(130,n==null?n:typeof n,""))}return e=Fs(o,t,e,r),e.elementType=n,e.type=s,e.lanes=i,e}function ec(n,e,t,s){return n=Fs(7,n,s,e),n.lanes=t,n}function uv(n,e,t,s){return n=Fs(22,n,s,e),n.elementType=ak,n.lanes=t,n.stateNode={isHidden:!1},n}function Qv(n,e,t){return n=Fs(6,n,null,e),n.lanes=t,n}function Zv(n,e,t){return e=Fs(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function _O(n,e,t,s,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lv(0),this.expirationTimes=Lv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lv(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Gb(n,e,t,s,r,i,o,l,c){return n=new _O(n,e,t,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Fs(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pb(i),n}function bO(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dc,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function QC(n){if(!n)return da;n=n._reactInternals;e:{if(hc(n)!==n||n.tag!==1)throw Error(U(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(n.tag===1){var t=n.type;if(jn(t))return Qk(n,t,e)}return e}function ZC(n,e,t,s,r,i,o,l,c){return n=Gb(t,s,!0,n,r,i,o,l,c),n.context=QC(null),t=n.current,s=An(),r=ca(t),i=zi(s,r),i.callback=e??null,aa(t,i,r),n.current.lanes=r,hg(n,r,s),Un(n,s),n}function hv(n,e,t,s){var r=e.current,i=An(),o=ca(r);return t=QC(t),e.context===null?e.context=t:e.pendingContext=t,e=zi(i,o),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=aa(r,e,o),n!==null&&(fr(n,r,o,i),am(n,r,o)),o}function yy(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function PA(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function qb(n,e){PA(n,e),(n=n.alternate)&&PA(n,e)}function SO(){return null}var ex=typeof reportError=="function"?reportError:function(n){console.error(n)};function Kb(n){this._internalRoot=n}dv.prototype.render=Kb.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(U(409));hv(n,e,null,null)};dv.prototype.unmount=Kb.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;oc(function(){hv(null,n,null,null)}),e[qi]=null}};function dv(n){this._internalRoot=n}dv.prototype.unstable_scheduleHydration=function(n){if(n){var e=Ok();n={blockedOn:null,target:n,priority:e};for(var t=0;t<io.length&&e!==0&&e<io[t].priority;t++);io.splice(t,0,n),t===0&&Lk(n)}};function Xb(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function fv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function RA(){}function AO(n,e,t,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var u=yy(o);i.call(u)}}var o=ZC(e,s,n,0,null,!1,!1,"",RA);return n._reactRootContainer=o,n[qi]=o.current,Jd(n.nodeType===8?n.parentNode:n),oc(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof s=="function"){var l=s;s=function(){var u=yy(c);l.call(u)}}var c=Gb(n,0,!1,null,null,!1,!1,"",RA);return n._reactRootContainer=c,n[qi]=c.current,Jd(n.nodeType===8?n.parentNode:n),oc(function(){hv(e,c,t,s)}),c}function pv(n,e,t,s,r){var i=t._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var l=r;r=function(){var c=yy(o);l.call(c)}}hv(e,o,n,r)}else o=AO(t,e,n,r,s);return yy(o)}Pk=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=ad(e.pendingLanes);t!==0&&(pb(e,t|1),Un(e,ft()),!(_e&6)&&(jh=ft()+500,va()))}break;case 13:oc(function(){var s=Ki(n,1);if(s!==null){var r=An();fr(s,n,1,r)}}),qb(n,1)}};gb=function(n){if(n.tag===13){var e=Ki(n,134217728);if(e!==null){var t=An();fr(e,n,134217728,t)}qb(n,134217728)}};Rk=function(n){if(n.tag===13){var e=ca(n),t=Ki(n,e);if(t!==null){var s=An();fr(t,n,e,s)}qb(n,e)}};Ok=function(){return xe};Ik=function(n,e){var t=xe;try{return xe=n,e()}finally{xe=t}};Dw=function(n,e,t){switch(e){case"input":if(xw(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var r=rv(s);if(!r)throw Error(U(90));ck(s),xw(s,r)}}}break;case"textarea":hk(n,t);break;case"select":e=t.value,e!=null&&Zc(n,!!t.multiple,e,!1)}};vk=zb;wk=oc;var EO={usingClientEntryPoint:!1,Events:[fg,jc,rv,mk,yk,zb]},Zh={findFiberByHostInstance:Da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kO={bundleType:Zh.bundleType,version:Zh.version,rendererPackageName:Zh.rendererPackageName,rendererConfig:Zh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qi.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Sk(n),n===null?null:n.stateNode},findFiberByHostInstance:Zh.findFiberByHostInstance||SO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$g.isDisabled&&$g.supportsFiber)try{ev=$g.inject(kO),qr=$g}catch{}}vs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EO;vs.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xb(e))throw Error(U(200));return bO(n,e,null,t)};vs.createRoot=function(n,e){if(!Xb(n))throw Error(U(299));var t=!1,s="",r=ex;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Gb(n,1,!1,null,null,t,!1,s,r),n[qi]=e.current,Jd(n.nodeType===8?n.parentNode:n),new Kb(e)};vs.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(U(188)):(n=Object.keys(n).join(","),Error(U(268,n)));return n=Sk(e),n=n===null?null:n.stateNode,n};vs.flushSync=function(n){return oc(n)};vs.hydrate=function(n,e,t){if(!fv(e))throw Error(U(200));return pv(null,n,e,!0,t)};vs.hydrateRoot=function(n,e,t){if(!Xb(n))throw Error(U(405));var s=t!=null&&t.hydratedSources||null,r=!1,i="",o=ex;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=ZC(e,null,n,1,t??null,r,!1,i,o),n[qi]=e.current,Jd(n),s)for(n=0;n<s.length;n++)t=s[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new dv(e)};vs.render=function(n,e,t){if(!fv(e))throw Error(U(200));return pv(null,n,e,!1,t)};vs.unmountComponentAtNode=function(n){if(!fv(n))throw Error(U(40));return n._reactRootContainer?(oc(function(){pv(null,null,n,!1,function(){n._reactRootContainer=null,n[qi]=null})}),!0):!1};vs.unstable_batchedUpdates=zb;vs.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!fv(t))throw Error(U(200));if(n==null||n._reactInternals===void 0)throw Error(U(38));return pv(n,e,t,!1,s)};vs.version="18.3.1-next-f1338f8080-20240426";function tx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tx)}catch(n){console.error(n)}}tx(),tk.exports=vs;var CO=tk.exports,OA=CO;_w.createRoot=OA.createRoot,_w.hydrateRoot=OA.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function af(){return af=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},af.apply(this,arguments)}var na;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(na||(na={}));const IA="popstate";function xO(n){n===void 0&&(n={});function e(s,r){let{pathname:i,search:o,hash:l}=s.location;return f0("",{pathname:i,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){return typeof r=="string"?r:nx(r)}return PO(e,t,null,n)}function wt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Yb(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function TO(){return Math.random().toString(36).substr(2,8)}function LA(n,e){return{usr:n.state,key:n.key,idx:e}}function f0(n,e,t,s){return t===void 0&&(t=null),af({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Hh(e):e,{state:t,key:e&&e.key||s||TO()})}function nx(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Hh(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function PO(n,e,t,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,l=na.Pop,c=null,u=h();u==null&&(u=0,o.replaceState(af({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function d(){l=na.Pop;let S=h(),m=S==null?null:S-u;u=S,c&&c({action:l,location:v.location,delta:m})}function f(S,m){l=na.Push;let w=f0(v.location,S,m);u=h()+1;let _=LA(w,u),E=v.createHref(w);try{o.pushState(_,"",E)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;r.location.assign(E)}i&&c&&c({action:l,location:v.location,delta:1})}function p(S,m){l=na.Replace;let w=f0(v.location,S,m);u=h();let _=LA(w,u),E=v.createHref(w);o.replaceState(_,"",E),i&&c&&c({action:l,location:v.location,delta:0})}function y(S){let m=r.location.origin!=="null"?r.location.origin:r.location.href,w=typeof S=="string"?S:nx(S);return w=w.replace(/ $/,"%20"),wt(m,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,m)}let v={get action(){return l},get location(){return n(r,o)},listen(S){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(IA,d),c=S,()=>{r.removeEventListener(IA,d),c=null}},createHref(S){return e(r,S)},createURL:y,encodeLocation(S){let m=y(S);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:p,go(S){return o.go(S)}};return v}var DA;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(DA||(DA={}));function RO(n,e,t){return t===void 0&&(t="/"),OO(n,e,t)}function OO(n,e,t,s){let r=typeof e=="string"?Hh(e):e,i=ix(r.pathname||"/",t);if(i==null)return null;let o=sx(n);IO(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=VO(i);l=$O(o[c],u)}return l}function sx(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let r=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(wt(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=tc([s,c.relativePath]),h=t.concat(c);i.children&&i.children.length>0&&(wt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),sx(i.children,e,h,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:jO(u,i.index),routesMeta:h})};return n.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))r(i,o);else for(let c of rx(i.path))r(i,o,c)}),e}function rx(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,r=t.endsWith("?"),i=t.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=rx(s.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),r&&l.push(...o),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function IO(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:UO(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const LO=/^:[\w-]+$/,DO=3,NO=2,MO=1,FO=10,BO=-2,NA=n=>n==="*";function jO(n,e){let t=n.split("/"),s=t.length;return t.some(NA)&&(s+=BO),e&&(s+=NO),t.filter(r=>!NA(r)).reduce((r,i)=>r+(LO.test(i)?DO:i===""?MO:FO),s)}function UO(n,e){return n.length===e.length&&n.slice(0,-1).every((s,r)=>s===e[r])?n[n.length-1]-e[e.length-1]:0}function $O(n,e,t){let{routesMeta:s}=n,r={},i="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,h=i==="/"?e:e.slice(i.length)||"/",d=zO({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!d)return null;Object.assign(r,d.params),o.push({params:r,pathname:tc([i,d.pathname]),pathnameBase:XO(tc([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=tc([i,d.pathnameBase]))}return o}function zO(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=HO(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((u,h,d)=>{let{paramName:f,isOptional:p}=h;if(f==="*"){let v=l[d]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const y=l[d];return p&&!y?u[f]=void 0:u[f]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:n}}function HO(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Yb(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function VO(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yb(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function ix(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const WO=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,GO=n=>WO.test(n);function qO(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:r=""}=typeof n=="string"?Hh(n):n,i;if(t)if(GO(t))i=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Yb(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?i=MA(t.substring(1),"/"):i=MA(t,e)}else i=e;return{pathname:i,search:YO(s),hash:JO(r)}}function MA(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function ew(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function KO(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ox(n,e){let t=KO(n);return e?t.map((s,r)=>r===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function ax(n,e,t,s){s===void 0&&(s=!1);let r;typeof n=="string"?r=Hh(n):(r=af({},n),wt(!r.pathname||!r.pathname.includes("?"),ew("?","pathname","search",r)),wt(!r.pathname||!r.pathname.includes("#"),ew("#","pathname","hash",r)),wt(!r.search||!r.search.includes("#"),ew("#","search","hash",r)));let i=n===""||r.pathname==="",o=i?"/":r.pathname,l;if(o==null)l=t;else{let d=e.length-1;if(!s&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;r.pathname=f.join("/")}l=d>=0?e[d]:"/"}let c=qO(r,l),u=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const tc=n=>n.join("/").replace(/\/\/+/g,"/"),XO=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),YO=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,JO=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function QO(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const lx=["post","put","patch","delete"];new Set(lx);const ZO=["get",...lx];new Set(ZO);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function lf(){return lf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},lf.apply(this,arguments)}const Jb=z.createContext(null),eI=z.createContext(null),gg=z.createContext(null),gv=z.createContext(null),dc=z.createContext({outlet:null,matches:[],isDataRoute:!1}),cx=z.createContext(null);function mg(){return z.useContext(gv)!=null}function Qb(){return mg()||wt(!1),z.useContext(gv).location}function ux(n){z.useContext(gg).static||z.useLayoutEffect(n)}function mv(){let{isDataRoute:n}=z.useContext(dc);return n?fI():tI()}function tI(){mg()||wt(!1);let n=z.useContext(Jb),{basename:e,future:t,navigator:s}=z.useContext(gg),{matches:r}=z.useContext(dc),{pathname:i}=Qb(),o=JSON.stringify(ox(r,t.v7_relativeSplatPath)),l=z.useRef(!1);return ux(()=>{l.current=!0}),z.useCallback(function(u,h){if(h===void 0&&(h={}),!l.current)return;if(typeof u=="number"){s.go(u);return}let d=ax(u,JSON.parse(o),i,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:tc([e,d.pathname])),(h.replace?s.replace:s.push)(d,h.state,h)},[e,s,o,i,n])}function nI(n,e){return sI(n,e)}function sI(n,e,t,s){mg()||wt(!1);let{navigator:r}=z.useContext(gg),{matches:i}=z.useContext(dc),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Qb(),h;if(e){var d;let S=typeof e=="string"?Hh(e):e;c==="/"||(d=S.pathname)!=null&&d.startsWith(c)||wt(!1),h=S}else h=u;let f=h.pathname||"/",p=f;if(c!=="/"){let S=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(S.length).join("/")}let y=RO(n,{pathname:p}),v=lI(y&&y.map(S=>Object.assign({},S,{params:Object.assign({},l,S.params),pathname:tc([c,r.encodeLocation?r.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?c:tc([c,r.encodeLocation?r.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),i,t,s);return e&&v?z.createElement(gv.Provider,{value:{location:lf({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:na.Pop}},v):v}function rI(){let n=dI(),e=QO(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},e),t?z.createElement("pre",{style:r},t):null,null)}const iI=z.createElement(rI,null);class oI extends z.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?z.createElement(dc.Provider,{value:this.props.routeContext},z.createElement(cx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function aI(n){let{routeContext:e,match:t,children:s}=n,r=z.useContext(Jb);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),z.createElement(dc.Provider,{value:e},s)}function lI(n,e,t,s){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=(r=t)==null?void 0:r.errors;if(l!=null){let h=o.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);h>=0||wt(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,u=-1;if(t&&s&&s.v7_partialHydration)for(let h=0;h<o.length;h++){let d=o[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:p}=t,y=d.route.loader&&f[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||y){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,d,f)=>{let p,y=!1,v=null,S=null;t&&(p=l&&d.route.id?l[d.route.id]:void 0,v=d.route.errorElement||iI,c&&(u<0&&f===0?(pI("route-fallback"),y=!0,S=null):u===f&&(y=!0,S=d.route.hydrateFallbackElement||null)));let m=e.concat(o.slice(0,f+1)),w=()=>{let _;return p?_=v:y?_=S:d.route.Component?_=z.createElement(d.route.Component,null):d.route.element?_=d.route.element:_=h,z.createElement(aI,{match:d,routeContext:{outlet:h,matches:m,isDataRoute:t!=null},children:_})};return t&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?z.createElement(oI,{location:t.location,revalidation:t.revalidation,component:v,error:p,children:w(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):w()},null)}var hx=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(hx||{}),dx=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(dx||{});function cI(n){let e=z.useContext(Jb);return e||wt(!1),e}function uI(n){let e=z.useContext(eI);return e||wt(!1),e}function hI(n){let e=z.useContext(dc);return e||wt(!1),e}function fx(n){let e=hI(),t=e.matches[e.matches.length-1];return t.route.id||wt(!1),t.route.id}function dI(){var n;let e=z.useContext(cx),t=uI(),s=fx();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function fI(){let{router:n}=cI(hx.UseNavigateStable),e=fx(dx.UseNavigateStable),t=z.useRef(!1);return ux(()=>{t.current=!0}),z.useCallback(function(r,i){i===void 0&&(i={}),t.current&&(typeof r=="number"?n.navigate(r):n.navigate(r,lf({fromRouteId:e},i)))},[n,e])}const FA={};function pI(n,e,t){FA[n]||(FA[n]=!0)}function gI(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function px(n){let{to:e,replace:t,state:s,relative:r}=n;mg()||wt(!1);let{future:i,static:o}=z.useContext(gg),{matches:l}=z.useContext(dc),{pathname:c}=Qb(),u=mv(),h=ax(e,ox(l,i.v7_relativeSplatPath),c,r==="path"),d=JSON.stringify(h);return z.useEffect(()=>u(JSON.parse(d),{replace:t,state:s,relative:r}),[u,d,r,t,s]),null}function cd(n){wt(!1)}function mI(n){let{basename:e="/",children:t=null,location:s,navigationType:r=na.Pop,navigator:i,static:o=!1,future:l}=n;mg()&&wt(!1);let c=e.replace(/^\/*/,"/"),u=z.useMemo(()=>({basename:c,navigator:i,static:o,future:lf({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof s=="string"&&(s=Hh(s));let{pathname:h="/",search:d="",hash:f="",state:p=null,key:y="default"}=s,v=z.useMemo(()=>{let S=ix(h,c);return S==null?null:{location:{pathname:S,search:d,hash:f,state:p,key:y},navigationType:r}},[c,h,d,f,p,y,r]);return v==null?null:z.createElement(gg.Provider,{value:u},z.createElement(gv.Provider,{children:t,value:v}))}function yI(n){let{children:e,location:t}=n;return nI(p0(e),t)}new Promise(()=>{});function p0(n,e){e===void 0&&(e=[]);let t=[];return z.Children.forEach(n,(s,r)=>{if(!z.isValidElement(s))return;let i=[...e,r];if(s.type===z.Fragment){t.push.apply(t,p0(s.props.children,i));return}s.type!==cd&&wt(!1),!s.props.index||!s.props.children||wt(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=p0(s.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const vI="6";try{window.__reactRouterVersion=vI}catch{}const wI="startTransition",BA=gP[wI];function _I(n){let{basename:e,children:t,future:s,window:r}=n,i=z.useRef();i.current==null&&(i.current=xO({window:r,v5Compat:!0}));let o=i.current,[l,c]=z.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},h=z.useCallback(d=>{u&&BA?BA(()=>c(d)):c(d)},[c,u]);return z.useLayoutEffect(()=>o.listen(h),[o,h]),z.useEffect(()=>gI(s),[s]),z.createElement(mI,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:s})}var jA;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(jA||(jA={}));var UA;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(UA||(UA={}));function yv(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t}function bI(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(h){try{u(s.next(h))}catch(d){o(d)}}function c(h){try{u(s.throw(h))}catch(d){o(d)}}function u(h){h.done?i(h.value):r(h.value).then(l,c)}u((s=s.apply(n,e||[])).next())})}const SI=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class Zb extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class AI extends Zb{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class $A extends Zb{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class zA extends Zb{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var g0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(g0||(g0={}));class EI{constructor(e,{headers:t={},customFetch:s,region:r=g0.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=SI(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return bI(this,arguments,void 0,function*(t,s={}){var r;let i,o;try{const{headers:l,method:c,body:u,signal:h,timeout:d}=s;let f={},{region:p}=s;p||(p=this.region);const y=new URL(`${this.url}/${t}`);p&&p!=="any"&&(f["x-region"]=p,y.searchParams.set("forceFunctionRegion",p));let v;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",v=u):typeof u=="string"?(f["Content-Type"]="text/plain",v=u):typeof FormData<"u"&&u instanceof FormData?v=u:(f["Content-Type"]="application/json",v=JSON.stringify(u)):u&&typeof u!="string"&&!(typeof Blob<"u"&&u instanceof Blob)&&!(u instanceof ArrayBuffer)&&!(typeof FormData<"u"&&u instanceof FormData)?v=JSON.stringify(u):v=u;let S=h;d&&(o=new AbortController,i=setTimeout(()=>o.abort(),d),h?(S=o.signal,h.addEventListener("abort",()=>o.abort())):S=o.signal);const m=yield this.fetch(y.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:v,signal:S}).catch(k=>{throw new AI(k)}),w=m.headers.get("x-relay-error");if(w&&w==="true")throw new $A(m);if(!m.ok)throw new zA(m);let _=((r=m.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),E;return _==="application/json"?E=yield m.json():_==="application/octet-stream"||_==="application/pdf"?E=yield m.blob():_==="text/event-stream"?E=m:_==="multipart/form-data"?E=yield m.formData():E=yield m.text(),{data:E,error:null,response:m}}catch(l){return{data:null,error:l,response:l instanceof zA||l instanceof $A?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var kI=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},CI=class{constructor(n){var e,t;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let r=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,l=null,c=null,u=i.status,h=i.statusText;if(i.ok){var d,f;if(t.method!=="HEAD"){var p;const m=await i.text();m===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((p=t.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?l=m:l=JSON.parse(m))}const v=(d=t.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),S=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");v&&S&&S.length>1&&(c=parseInt(S[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,u=406,h="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var y;const v=await i.text();try{o=JSON.parse(v),Array.isArray(o)&&i.status===404&&(l=[],o=null,u=200,h="OK")}catch{i.status===404&&v===""?(u=204,h="No Content"):o={message:v}}if(o&&t.isMaybeSingle&&(!(o==null||(y=o.details)===null||y===void 0)&&y.includes("0 rows"))&&(o=null,u=200,h="OK"),o&&t.shouldThrowOnError)throw new kI(o)}return{error:o,data:l,count:c,status:u,statusText:h}});return this.shouldThrowOnError||(r=r.catch(i=>{var o;let l="";const c=i==null?void 0:i.cause;if(c){var u,h,d,f;const y=(u=c==null?void 0:c.message)!==null&&u!==void 0?u:"",v=(h=c==null?void 0:c.code)!==null&&h!==void 0?h:"";l=`${(d=i==null?void 0:i.name)!==null&&d!==void 0?d:"FetchError"}: ${i==null?void 0:i.message}`,l+=`

Caused by: ${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"Error"}: ${y}`,v&&(l+=` (${v})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var p;l=(p=i==null?void 0:i.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),r.then(n,e)}returns(){return this}overrideTypes(){return this}},xI=class extends CI{select(n){let e=!1;const t=(n??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:s,referencedTable:r=s}={}){const i=r?`${r}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const s=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(s,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:s=t}={}){const r=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${n}`),this.url.searchParams.set(i,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:s=!1,wal:r=!1,format:i="text"}={}){var o;const l=[n?"analyze":null,e?"verbose":null,t?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const HA=new RegExp("[,()]");var Ac=class extends xI{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(s=>typeof s=="string"&&HA.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(s=>typeof s=="string"&&HA.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const i=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${r}fts${i}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const s=t?`${t}.or`:"or";return this.url.searchParams.append(s,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},TI=class{constructor(n,{headers:e={},schema:t,fetch:s}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:s}=e??{},r=t?"HEAD":"GET";let i=!1;const o=(n??"*").split("").map(u=>/\s/.test(u)&&!i?"":(u==='"'&&(i=!i),u)).join(""),{url:l,headers:c}=this.cloneRequestState();return l.searchParams.set("select",o),s&&c.append("Prefer",`count=${s}`),new Ac({method:r,url:l,headers:c,schema:this.schema,fetch:this.fetch})}insert(n,{count:e,defaultToNull:t=!0}={}){var s;const r="POST",{url:i,headers:o}=this.cloneRequestState();if(e&&o.append("Prefer",`count=${e}`),t||o.append("Prefer","missing=default"),Array.isArray(n)){const l=n.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);i.searchParams.set("columns",c.join(","))}}return new Ac({method:r,url:i,headers:o,schema:this.schema,body:n,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:s,defaultToNull:r=!0}={}){var i;const o="POST",{url:l,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&l.searchParams.set("on_conflict",e),s&&c.append("Prefer",`count=${s}`),r||c.append("Prefer","missing=default"),Array.isArray(n)){const u=n.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);l.searchParams.set("columns",h.join(","))}}return new Ac({method:o,url:l,headers:c,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(n,{count:e}={}){var t;const s="PATCH",{url:r,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Ac({method:s,url:r,headers:i,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:n}={}){var e;const t="DELETE",{url:s,headers:r}=this.cloneRequestState();return n&&r.append("Prefer",`count=${n}`),new Ac({method:t,url:s,headers:r,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},PI=class gx{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=r}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new TI(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new gx(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let u;const h=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(h)),d=s&&Object.values(t).some(h);d?(l="POST",u=t):s||r?(l=s?"HEAD":"GET",Object.entries(t).filter(([p,y])=>y!==void 0).map(([p,y])=>[p,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([p,y])=>{c.searchParams.append(p,y)})):(l="POST",u=t);const f=new Headers(this.headers);return d?f.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&f.set("Prefer",`count=${i}`),new Ac({method:l,url:c,headers:f,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class RI{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const s=t.versions;if(s&&s.node){const r=s.node,i=parseInt(r.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const OI="2.90.1",II=`realtime-js/${OI}`,mx="1.0.0",LI="2.0.0",VA=mx,m0=1e4,DI=1e3,NI=100;var ro;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(ro||(ro={}));var At;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(At||(At={}));var cr;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(cr||(cr={}));var y0;(function(n){n.websocket="websocket"})(y0||(y0={}));var Pa;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Pa||(Pa={}));class MI{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,s;const r=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,r)}_encodeJsonUserBroadcastPush(e){var t,s;const r=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(r)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,s){var r,i;const o=e.topic,l=(r=e.ref)!==null&&r!==void 0?r:"",c=(i=e.join_ref)!==null&&i!==void 0?i:"",u=e.payload.event,h=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},d=Object.keys(h).length===0?"":JSON.stringify(h);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+u.length+d.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let y=new DataView(p),v=0;y.setUint8(v++,this.KINDS.userBroadcastPush),y.setUint8(v++,c.length),y.setUint8(v++,l.length),y.setUint8(v++,o.length),y.setUint8(v++,u.length),y.setUint8(v++,d.length),y.setUint8(v++,t),Array.from(c,m=>y.setUint8(v++,m.charCodeAt(0))),Array.from(l,m=>y.setUint8(v++,m.charCodeAt(0))),Array.from(o,m=>y.setUint8(v++,m.charCodeAt(0))),Array.from(u,m=>y.setUint8(v++,m.charCodeAt(0))),Array.from(d,m=>y.setUint8(v++,m.charCodeAt(0)));var S=new Uint8Array(p.byteLength+s.byteLength);return S.set(new Uint8Array(p),0),S.set(new Uint8Array(s),p.byteLength),S.buffer}decode(e,t){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return t(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,i,o,l,c]=s;return t({join_ref:r,ref:i,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),s=t.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,r)}}_decodeUserBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const u=s.decode(e.slice(c,c+r));c=c+r;const h=s.decode(e.slice(c,c+i));c=c+i;const d=s.decode(e.slice(c,c+o));c=c+o;const f=e.slice(c,e.byteLength),p=l===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,y={type:this.BROADCAST_EVENT,event:h,payload:p};return o>0&&(y.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>t.includes(s)))}}class yx{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Be;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Be||(Be={}));const WA=(n,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=FI(o,n,e,r),i),{}):{}},FI=(n,e,t,s)=>{const r=e.find(l=>l.name===n),i=r==null?void 0:r.type,o=t[n];return i&&!s.includes(i)?vx(i,o):v0(o)},vx=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return $I(e,t)}switch(n){case Be.bool:return BI(e);case Be.float4:case Be.float8:case Be.int2:case Be.int4:case Be.int8:case Be.numeric:case Be.oid:return jI(e);case Be.json:case Be.jsonb:return UI(e);case Be.timestamp:return zI(e);case Be.abstime:case Be.date:case Be.daterange:case Be.int4range:case Be.int8range:case Be.money:case Be.reltime:case Be.text:case Be.time:case Be.timestamptz:case Be.timetz:case Be.tsrange:case Be.tstzrange:return v0(e);default:return v0(e)}},v0=n=>n,BI=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},jI=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},UI=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},$I=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>vx(e,l))}return n},zI=n=>typeof n=="string"?n.replace(" ","T"):n,wx=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class tw{constructor(e,t,s={},r=m0){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var GA;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(GA||(GA={}));class $d{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=$d.syncState(this.state,r,i,o),this.pendingDiffs.forEach(c=>{this.state=$d.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=$d.syncDiff(this.state,r,i,o),l())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const i=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(i,(u,h)=>{o[u]||(c[u]=h)}),this.map(o,(u,h)=>{const d=i[u];if(d){const f=h.map(S=>S.presence_ref),p=d.map(S=>S.presence_ref),y=h.filter(S=>p.indexOf(S.presence_ref)<0),v=d.filter(S=>f.indexOf(S.presence_ref)<0);y.length>0&&(l[u]=y),v.length>0&&(c[u]=v)}else l[u]=h}),this.syncDiff(i,{joins:l,leaves:c},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(l,c)=>{var u;const h=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),h.length>0){const d=e[l].map(p=>p.presence_ref),f=h.filter(p=>d.indexOf(p.presence_ref)<0);e[l].unshift(...f)}s(l,h,c)}),this.map(o,(l,c)=>{let u=e[l];if(!u)return;const h=c.map(d=>d.presence_ref);u=u.filter(d=>h.indexOf(d.presence_ref)<0),e[l]=u,r(l,u,c),u.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var qA;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(qA||(qA={}));var zd;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(zd||(zd={}));var ti;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(ti||(ti={}));class Gc{constructor(e,t={config:{}},s){var r,i;if(this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=At.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new tw(this,cr.join,this.params,this.timeout),this.rejoinTimer=new yx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=At.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=At.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=At.errored,this.rejoinTimer.scheduleTimeout())}),this._on(cr.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new $d(this),this.broadcastEndpointURL=wx(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==At.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&r!==void 0?r:[],h=!!this.bindings[zd.PRESENCE]&&this.bindings[zd.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(ti.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(ti.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e==null||e(ti.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,S=(y=v==null?void 0:v.length)!==null&&y!==void 0?y:0,m=[];for(let w=0;w<S;w++){const _=v[w],{filter:{event:E,schema:k,table:C,filter:x}}=_,P=p&&p[w];if(P&&P.event===E&&Gc.isFilterValueEqual(P.schema,k)&&Gc.isFilterValueEqual(P.table,C)&&Gc.isFilterValueEqual(P.filter,x))m.push(Object.assign(Object.assign({},_),{id:P.id}));else{this.unsubscribe(),this.state=At.errored,e==null||e(ti.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(ti.SUBSCRIBED);return}}).receive("error",p=>{this.state=At.errored,e==null||e(ti.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ti.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===At.joined&&e===zd.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,s)}async httpSend(e,t,s={}){var r;if(t==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=u.body)===null||r===void 0?void 0:r.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=At.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(cr.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new tw(this,cr.leave,{},e),s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=At.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new tw(this,e,t,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>NI){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:h}=cr;if(s&&[l,c,u,h].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,t,s);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(p=>{var y,v,S;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((S=(v=p.filter)===null||v===void 0?void 0:v.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(p=>p.callback(f,s)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var y,v,S,m,w,_,E,k;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const C=p.id,x=(y=p.filter)===null||y===void 0?void 0:y.event;return C&&((v=t.ids)===null||v===void 0?void 0:v.includes(C))&&(x==="*"||(x==null?void 0:x.toLocaleLowerCase())===((S=t.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))&&(!(!((m=p.filter)===null||m===void 0)&&m.table)||p.filter.table===((w=t.data)===null||w===void 0?void 0:w.table))}else{const C=(E=(_=p==null?void 0:p.filter)===null||_===void 0?void 0:_.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return C==="*"||C===((k=t==null?void 0:t.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof f=="object"&&"ids"in f){const y=f.data,{schema:v,table:S,commit_timestamp:m,type:w,errors:_}=y;f=Object.assign(Object.assign({},{schema:v,table:S,commit_timestamp:m,eventType:w,new:{},old:{},errors:_}),this._getPayloadRecords(y))}p.callback(f,s)})}_isClosed(){return this.state===At.closed}_isJoined(){return this.state===At.joined}_isJoining(){return this.state===At.joining}_isLeaving(){return this.state===At.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Gc.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(cr.close,{},e)}_onError(e){this._on(cr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=At.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=WA(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=WA(e.columns,e.old_record)),t}}const nw=()=>{},zg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},HI=[1e3,2e3,5e3,1e4],VI=1e4,WI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class GI{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=m0,this.transport=null,this.heartbeatIntervalMs=zg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=nw,this.ref=0,this.reconnectTimer=null,this.vsn=VA,this.logger=nw,this.conn=null,this.sendBuffer=[],this.serializer=new MI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=r=>r?(...i)=>r(...i):(...i)=>fetch(...i),!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${y0.websocket}`,this.httpEndpoint=wx(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=RI.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ro.connecting:return Pa.Connecting;case ro.open:return Pa.Open;case ro.closing:return Pa.Closing;default:return Pa.Closed}}isConnected(){return this.connectionState()===Pa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new Gc(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:s,payload:r,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(DI,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},zg.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const u=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",u)}catch(h){this.log("error","error in heartbeat callback",h)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:r,payload:i,ref:o}=t,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${s} ${r} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(s)).forEach(u=>u._trigger(r,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===ro.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ro.open||this.conn.readyState===ro.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(cr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([WI],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,s=!1;if(e)t=e,s=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(r){this.log("error","Error fetching access token from callback",r),t=this.accessTokenValue}else t=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const i={access_token:t,version:II};t&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(cr.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new yx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},zg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,r,i,o,l,c,u,h,d,f,p;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:m0,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:zg.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:nw,this.vsn=(c=e==null?void 0:e.vsn)!==null&&c!==void 0?c:VA,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:y=>HI[y-1]||VI,this.vsn){case mx:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:(y,v)=>v(JSON.stringify(y)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:(y,v)=>v(JSON.parse(y));break;case LI:this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var cf=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function qI(n,e,t){const s=new URL(e,n);if(t)for(const[r,i]of Object.entries(t))i!==void 0&&s.searchParams.set(r,i);return s.toString()}async function KI(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function XI(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:s,query:r,body:i,headers:o}){const l=qI(n.baseUrl,s,r),c=await KI(n.auth),u=await e(l,{method:t,headers:{...i?{"Content-Type":"application/json"}:{},...c,...o},body:i?JSON.stringify(i):void 0}),h=await u.text(),d=(u.headers.get("content-type")||"").includes("application/json"),f=d&&h?JSON.parse(h):h;if(!u.ok){const p=d?f:void 0,y=p==null?void 0:p.error;throw new cf((y==null?void 0:y.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:y==null?void 0:y.type,icebergCode:y==null?void 0:y.code,details:p})}return{status:u.status,headers:u.headers,data:f}}}}function Hg(n){return n.join("")}var YI=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:Hg(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Hg(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Hg(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Hg(n.namespace)}`}),!0}catch(e){if(e instanceof cf&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof cf&&t.status===409)return;throw t}}};function mc(n){return n.join("")}var JI=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mc(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${mc(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${mc(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${mc(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${mc(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${mc(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof cf&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof cf&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},QI=class{constructor(n){var s;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=XI({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(s=n.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new YI(this.client,e),this.tableOps=new JI(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},vv=class extends Error{constructor(n){super(n),this.__isStorageError=!0,this.name="StorageError"}};function Qe(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var ZI=class extends vv{constructor(n,e,t){super(n),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},w0=class extends vv{constructor(n,e){super(n),this.name="StorageUnknownError",this.originalError=e}};const eS=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),eL=()=>Response,_0=n=>{if(Array.isArray(n))return n.map(t=>_0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const r=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=_0(s)}),e},tL=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},nL=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function uf(n){"@babel/helpers - typeof";return uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uf(n)}function sL(n,e){if(uf(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(uf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function rL(n){var e=sL(n,"string");return uf(e)=="symbol"?e:e+""}function iL(n,e,t){return(e=rL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function KA(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,s)}return t}function ne(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?KA(Object(t),!0).forEach(function(s){iL(n,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):KA(Object(t)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(t,s))})}return n}const sw=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},oL=async(n,e,t)=>{n instanceof await eL()&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{const r=n.status||500,i=(s==null?void 0:s.statusCode)||r+"";e(new ZI(sw(s),r,i))}).catch(s=>{e(new w0(sw(s),s))}):e(new w0(sw(n),n))},aL=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!s?r:(tL(s)?(r.headers=ne({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),ne(ne({},r),t))};async function yg(n,e,t,s,r,i){return new Promise((o,l)=>{n(t,aL(e,s,r,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>oL(c,l,s))})}async function hf(n,e,t,s){return yg(n,"GET",e,t,s)}async function Xs(n,e,t,s,r){return yg(n,"POST",e,s,r,t)}async function b0(n,e,t,s,r){return yg(n,"PUT",e,s,r,t)}async function lL(n,e,t,s){return yg(n,"HEAD",e,ne(ne({},t),{},{noResolveJson:!0}),s)}async function tS(n,e,t,s,r){return yg(n,"DELETE",e,s,r,t)}var cL=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Qe(e))return{data:null,error:e};throw e}}};let _x;_x=Symbol.toStringTag;var uL=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[_x]="BlobDownloadBuilder",this.promise=null}asStream(){return new cL(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Qe(e))return{data:null,error:e};throw e}}};const hL={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},XA={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var dL=class{constructor(n,e={},t,s){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.bucketId=t,this.fetch=eS(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(n,e,t,s){var r=this;try{let i;const o=ne(ne({},XA),s);let l=ne(ne({},r.headers),n==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&t instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",r.encodeMetadata(c)),i.append("",t)):typeof FormData<"u"&&t instanceof FormData?(i=t,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",r.encodeMetadata(c))):(i=t,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=r.toBase64(r.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(l=ne(ne({},l),s.headers));const u=r._removeEmptyFolders(e),h=r._getFinalPath(u),d=await(n=="PUT"?b0:Xs)(r.fetch,`${r.url}/object/${h}`,i,ne({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(r.shouldThrowOnError)throw i;if(Qe(i))return{data:null,error:i};throw i}}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,s){var r=this;const i=r._removeEmptyFolders(n),o=r._getFinalPath(i),l=new URL(r.url+`/object/upload/sign/${o}`);l.searchParams.set("token",e);try{let c;const u=ne({upsert:XA.upsert},s),h=ne(ne({},r.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&t instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",t)):typeof FormData<"u"&&t instanceof FormData?(c=t,c.append("cacheControl",u.cacheControl)):(c=t,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType),{data:{path:i,fullPath:(await b0(r.fetch,l.toString(),c,{headers:h})).Key},error:null}}catch(c){if(r.shouldThrowOnError)throw c;if(Qe(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(n,e){var t=this;try{let s=t._getFinalPath(n);const r=ne({},t.headers);e!=null&&e.upsert&&(r["x-upsert"]="true");const i=await Xs(t.fetch,`${t.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(t.url+i.url),l=o.searchParams.get("token");if(!l)throw new vv("No token returned by API");return{data:{signedUrl:o.toString(),path:n,token:l},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Qe(s))return{data:null,error:s};throw s}}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var s=this;try{return{data:await Xs(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:s.headers}),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}}async copy(n,e,t){var s=this;try{return{data:{path:(await Xs(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:s.headers})).Key},error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}}async createSignedUrl(n,e,t){var s=this;try{let r=s._getFinalPath(n),i=await Xs(s.fetch,`${s.url}/object/sign/${r}`,ne({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:s.headers});const o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}}async createSignedUrls(n,e,t){var s=this;try{const r=await Xs(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:n},{headers:s.headers}),i=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:r.map(o=>ne(ne({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}}download(n,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),r=s?`?${s}`:"",i=this._getFinalPath(n),o=()=>hf(this.fetch,`${this.url}/${t}/${i}${r}`,{headers:this.headers,noResolveJson:!0});return new uL(o,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);try{return{data:_0(await hf(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Qe(s))return{data:null,error:s};throw s}}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await lL(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(Qe(s)&&s instanceof w0){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}}getPublicUrl(n,e){const t=this._getFinalPath(n),s=[],r=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";r!==""&&s.push(r);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&s.push(o);let l=s.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${t}${l}`)}}}async remove(n){var e=this;try{return{data:await tS(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qe(t))return{data:null,error:t};throw t}}async list(n,e,t){var s=this;try{const r=ne(ne(ne({},hL),e),{},{prefix:n||""});return{data:await Xs(s.fetch,`${s.url}/object/list/${s.bucketId}`,r,{headers:s.headers},t),error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Qe(r))return{data:null,error:r};throw r}}async listV2(n,e){var t=this;try{const s=ne({},n);return{data:await Xs(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,s,{headers:t.headers},e),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Qe(s))return{data:null,error:s};throw s}}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const bx="2.90.1",Sx={"X-Client-Info":`storage-js/${bx}`};var fL=class{constructor(n,e={},t,s){this.shouldThrowOnError=!1;const r=new URL(n);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href.replace(/\/$/,""),this.headers=ne(ne({},Sx),e),this.fetch=eS(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(n){var e=this;try{const t=e.listBucketOptionsToQueryString(n);return{data:await hf(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qe(t))return{data:null,error:t};throw t}}async getBucket(n){var e=this;try{return{data:await hf(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qe(t))return{data:null,error:t};throw t}}async createBucket(n,e={public:!1}){var t=this;try{return{data:await Xs(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Qe(s))return{data:null,error:s};throw s}}async updateBucket(n,e){var t=this;try{return{data:await b0(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Qe(s))return{data:null,error:s};throw s}}async emptyBucket(n){var e=this;try{return{data:await Xs(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qe(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await tS(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qe(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},pL=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ne(ne({},Sx),e),this.fetch=eS(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var e=this;try{return{data:await Xs(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qe(t))return{data:null,error:t};throw t}}async listBuckets(n){var e=this;try{const t=new URLSearchParams;(n==null?void 0:n.limit)!==void 0&&t.set("limit",n.limit.toString()),(n==null?void 0:n.offset)!==void 0&&t.set("offset",n.offset.toString()),n!=null&&n.sortColumn&&t.set("sortColumn",n.sortColumn),n!=null&&n.sortOrder&&t.set("sortOrder",n.sortOrder),n!=null&&n.search&&t.set("search",n.search);const s=t.toString(),r=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await hf(e.fetch,r,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qe(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await tS(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Qe(t))return{data:null,error:t};throw t}}from(n){var e=this;if(!nL(n))throw new vv("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new QI({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(t,{get(r,i){const o=r[i];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(r,l),error:null}}catch(c){if(s)throw c;return{data:null,error:c}}}}})}};const nS={"X-Client-Info":`storage-js/${bx}`,"Content-Type":"application/json"};var Ax=class extends Error{constructor(n){super(n),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function ds(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}var rw=class extends Ax{constructor(n,e,t){super(n),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},gL=class extends Ax{constructor(n,e){super(n),this.name="StorageVectorsUnknownError",this.originalError=e}};const sS=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),mL=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},YA=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),yL=async(n,e,t)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const s=n.status||500,r=n;if(typeof r.json=="function")r.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new rw(YA(i),s,o))}).catch(()=>{const i=s+"";e(new rw(r.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new rw(r.statusText||`HTTP ${s} error`,s,i))}}else e(new gL(YA(n),n))},vL=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return s?(mL(s)?(r.headers=ne({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,ne(ne({},r),t)):r};async function wL(n,e,t,s,r,i){return new Promise((o,l)=>{n(t,vL(e,s,r,i)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>yL(c,l,s))})}async function fs(n,e,t,s,r){return wL(n,"POST",e,s,r,t)}var _L=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ne(ne({},nS),e),this.fetch=sS(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(n){var e=this;try{return{data:await fs(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async getIndex(n,e){var t=this;try{return{data:await fs(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(ds(s))return{data:null,error:s};throw s}}async listIndexes(n){var e=this;try{return{data:await fs(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async deleteIndex(n,e){var t=this;try{return{data:await fs(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(ds(s))return{data:null,error:s};throw s}}},bL=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ne(ne({},nS),e),this.fetch=sS(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(n){var e=this;try{if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await fs(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async getVectors(n){var e=this;try{return{data:await fs(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async listVectors(n){var e=this;try{if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return{data:await fs(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async queryVectors(n){var e=this;try{return{data:await fs(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async deleteVectors(n){var e=this;try{if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await fs(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}},SL=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ne(ne({},nS),e),this.fetch=sS(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var e=this;try{return{data:await fs(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async getBucket(n){var e=this;try{return{data:await fs(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async listBuckets(n={}){var e=this;try{return{data:await fs(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await fs(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(ds(t))return{data:null,error:t};throw t}}},AL=class extends SL{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new EL(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},EL=class extends _L{constructor(n,e,t,s){super(n,e,s),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,ne(ne({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,ne(ne({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new kL(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},kL=class extends bL{constructor(n,e,t,s,r){super(n,e,r),this.vectorBucketName=t,this.indexName=s}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,ne(ne({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,ne(ne({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,ne(ne({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,ne(ne({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,ne(ne({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},CL=class extends fL{constructor(n,e={},t,s){super(n,e,t,s)}from(n){return new dL(this.url,this.headers,n,this.fetch)}get vectors(){return new AL(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new pL(this.url+"/iceberg",this.headers,this.fetch)}};const Ex="2.90.1",Ec=30*1e3,S0=3,iw=S0*Ec,xL="http://localhost:9999",TL="supabase.auth.token",PL={"X-Client-Info":`gotrue-js/${Ex}`},A0="X-Supabase-Api-Version",kx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},RL=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,OL=10*60*1e3;class df extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Y(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class IL extends df{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function LL(n){return Y(n)&&n.name==="AuthApiError"}class Ra extends df{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Zi extends df{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class $n extends Zi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function DL(n){return Y(n)&&n.name==="AuthSessionMissingError"}class yc extends Zi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Vg extends Zi{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Wg extends Zi{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function NL(n){return Y(n)&&n.name==="AuthImplicitGrantRedirectError"}class JA extends Zi{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ML extends Zi{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class E0 extends Zi{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ow(n){return Y(n)&&n.name==="AuthRetryableFetchError"}class QA extends Zi{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class k0 extends Zi{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const vy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ZA=` 	
\r=`.split(""),FL=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<ZA.length;e+=1)n[ZA[e].charCodeAt(0)]=-2;for(let e=0;e<vy.length;e+=1)n[vy[e].charCodeAt(0)]=e;return n})();function eE(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(vy[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(vy[s]),e.queuedBits-=6}}function Cx(n,e,t){const s=FL[n];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function tE(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=o=>{UL(o,s,t)};for(let o=0;o<n.length;o+=1)Cx(n.charCodeAt(o),r,i);return e.join("")}function BL(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function jL(n,e){for(let t=0;t<n.length;t+=1){let s=n.charCodeAt(t);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}BL(s,e)}}function UL(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let s=1;s<6;s+=1)if(!(n>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function iu(n){const e=[],t={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)Cx(n.charCodeAt(r),t,s);return new Uint8Array(e)}function $L(n){const e=[];return jL(n,t=>e.push(t)),new Uint8Array(e)}function Fa(n){const e=[],t={queue:0,queuedBits:0},s=r=>{e.push(r)};return n.forEach(r=>eE(r,t,s)),eE(null,t,s),e.join("")}function zL(n){return Math.round(Date.now()/1e3)+n}function HL(){return Symbol("auth-callback")}const zt=()=>typeof window<"u"&&typeof document<"u",_a={tested:!1,writable:!1},xx=()=>{if(!zt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_a.tested)return _a.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),_a.tested=!0,_a.writable=!0}catch{_a.tested=!0,_a.writable=!1}return _a.writable};function VL(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return t.searchParams.forEach((s,r)=>{e[r]=s}),e}const Tx=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),WL=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",kc=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},ba=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},$t=async(n,e)=>{await n.removeItem(e)};class wv{constructor(){this.promise=new wv.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}wv.promiseConstructor=Promise;function aw(n){const e=n.split(".");if(e.length!==3)throw new k0("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!RL.test(e[s]))throw new k0("JWT not in base64url format");return{header:JSON.parse(tE(e[0])),payload:JSON.parse(tE(e[1])),signature:iu(e[2]),raw:{header:e[0],payload:e[1]}}}async function GL(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function qL(n,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function KL(n){return("0"+n.toString(16)).substr(-2)}function XL(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let i=0;i<56;i++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,KL).join("")}async function YL(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function JL(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await YL(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function vc(n,e,t=!1){const s=XL();let r=s;t&&(r+="/PASSWORD_RECOVERY"),await kc(n,`${e}-code-verifier`,r);const i=await JL(s);return[i,s===i?"plain":"s256"]}const QL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ZL(n){const e=n.headers.get(A0);if(!e||!e.match(QL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function eD(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function tD(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const nD=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function wc(n){if(!nD.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function lw(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function sD(n,e){return new Proxy(n,{get:(t,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,s,r)}})}function nE(n){return JSON.parse(JSON.stringify(n))}const ka=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),rD=[502,503,504];async function sE(n){var e;if(!WL(n))throw new E0(ka(n),0);if(rD.includes(n.status))throw new E0(ka(n),n.status);let t;try{t=await n.json()}catch(i){throw new Ra(ka(i),i)}let s;const r=ZL(n);if(r&&r.getTime()>=kx["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new QA(ka(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new $n}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new QA(ka(t),n.status,t.weak_password.reasons);throw new IL(ka(t),n.status||500,s)}const iD=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function te(n,e,t,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[A0]||(i[A0]=kx["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await oD(n,e,t+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function oD(n,e,t,s,r,i){const o=iD(e,s,r,i);let l;try{l=await n(t,Object.assign({},o))}catch(c){throw console.error(c),new E0(ka(c),0)}if(l.ok||await sE(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await sE(c)}}function Ws(n){var e;let t=null;cD(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=zL(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function rE(n){const e=Ws(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ao(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function aD(n){return{data:n,error:null}}function lD(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i}=n,o=yv(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function iE(n){return n}function cD(n){return n.access_token&&n.refresh_token&&n.expires_in}const cw=["global","local","others"];class uD{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Tx(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=cw[0]){if(cw.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${cw.join(", ")}`);try{return await te(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await te(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ao})}catch(s){if(Y(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=yv(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await te(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:lD,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Y(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await te(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ao})}catch(t){if(Y(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},h=await te(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:iE});if(h.error)throw h.error;const d=await h.json(),f=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(y.split(";")[1].split("=")[1]);u[`${S}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Y(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){wc(e);try{return await te(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ao})}catch(t){if(Y(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){wc(e);try{return await te(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ao})}catch(s){if(Y(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){wc(e);try{return await te(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ao})}catch(s){if(Y(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){wc(e.userId);try{const{data:t,error:s}=await te(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(Y(t))return{data:null,error:t};throw t}}async _deleteFactor(e){wc(e.userId),wc(e.id);try{return{data:await te(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,s,r,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},h=await te(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:iE});if(h.error)throw h.error;const d=await h.json(),f=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(y.split(";")[1].split("=")[1]);u[`${S}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Y(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(e){try{return await te(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Y(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await te(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Y(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await te(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Y(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await te(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await te(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Y(t))return{data:null,error:t};throw t}}}function oE(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const _c={debug:!!(globalThis&&xx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Px extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class hD extends Px{}async function dD(n,e,t){_c.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),_c.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){_c.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{_c.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw _c.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new hD(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(_c.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function fD(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Rx(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function pD(n){return parseInt(n,16)}function gD(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function mD(n){var e;const{chainId:t,domain:s,expirationTime:r,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:u,scheme:h,uri:d,version:f}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const p=Rx(n.address),y=h?`${h}://${s}`:s,v=n.statement?`${n.statement}
`:"",S=`${y} wants you to sign in with your Ethereum account:
${p}

${v}`;let m=`URI: ${d}
Version: ${f}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(r&&(m+=`
Expiration Time: ${r.toISOString()}`),l&&(m+=`
Not Before: ${l.toISOString()}`),c&&(m+=`
Request ID: ${c}`),u){let w=`
Resources:`;for(const _ of u){if(!_||typeof _!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${_}`);w+=`
- ${_}`}m+=w}return`${S}
${m}`}class yt extends Error{constructor({message:e,code:t,cause:s,name:r}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=r??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class wy extends yt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function yD({error:n,options:e}){var t,s,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new yt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new yt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new yt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new yt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new yt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new yt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new yt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new yt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(Ox(o)){if(i.rp.id!==o)return new yt({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new yt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new yt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new yt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new yt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function vD({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new yt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new yt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const s=window.location.hostname;if(Ox(s)){if(t.rpId!==s)return new yt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new yt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new yt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new yt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class wD{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const _D=new wD;function bD(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:s}=n,r=yv(n,["challenge","user","excludeCredentials"]),i=iu(e).buffer,o=Object.assign(Object.assign({},t),{id:iu(t.id).buffer}),l=Object.assign(Object.assign({},r),{challenge:i,user:o});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const u=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:iu(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function SD(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,s=yv(n,["challenge","allowCredentials"]),r=iu(e).buffer,i=Object.assign(Object.assign({},s),{challenge:r});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:iu(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function AD(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Fa(new Uint8Array(n.response.attestationObject)),clientDataJSON:Fa(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ED(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,s=n.getClientExtensionResults(),r=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Fa(new Uint8Array(r.authenticatorData)),clientDataJSON:Fa(new Uint8Array(r.clientDataJSON)),signature:Fa(new Uint8Array(r.signature)),userHandle:r.userHandle?Fa(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Ox(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function aE(){var n,e;return!!(zt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function kD(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new wy("Browser returned unexpected credential type",e)}:{data:null,error:new wy("Empty credential response",e)}}catch(e){return{data:null,error:yD({error:e,options:n})}}}async function CD(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new wy("Browser returned unexpected credential type",e)}:{data:null,error:new wy("Empty credential response",e)}}catch(e){return{data:null,error:vD({error:e,options:n})}}}const xD={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},TD={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function _y(...n){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),t=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of n)if(r)for(const i in r){const o=r[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(t(o))s[i]=o;else if(e(o)){const l=s[i];e(l)?s[i]=_y(l,o):s[i]=_y(o)}else s[i]=o}return s}function PD(n,e){return _y(xD,n,e||{})}function RD(n,e){return _y(TD,n,e||{})}class OD{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:s,signal:r},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=r??_D.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${s}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=PD(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:h,error:d}=await kD({publicKey:u,signal:c});return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}case"request":{const u=RD(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:h,error:d}=await CD(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}}}catch(o){return Y(o)?{data:null,error:o}:{data:null,error:new Ra("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:s}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!t)return{data:null,error:new df("rpId is required for WebAuthn authentication")};try{if(!aE())return{data:null,error:new Ra("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:s},signal:r},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:s,credential_response:c.credential_response}})}catch(o){return Y(o)?{data:null,error:o}:{data:null,error:new Ra("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!t)return{data:null,error:new df("rpId is required for WebAuthn registration")};try{if(!aE())return{data:null,error:new Ra("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(h=>{var d;return(d=h.data)===null||d===void 0?void 0:d.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:s},signal:r},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(o){return Y(o)?{data:null,error:o}:{data:null,error:new Ra("Unexpected error in register",o)}}}}fD();const ID={url:xL,storageKey:TL,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:PL,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function lE(n,e,t){return await t()}const bc={};class ff{get jwks(){var e,t;return(t=(e=bc[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){bc[this.storageKey]=Object.assign(Object.assign({},bc[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=bc[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){bc[this.storageKey]=Object.assign(Object.assign({},bc[this.storageKey]),{cachedAt:e})}constructor(e){var t,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},ID),e);if(this.storageKey=i.storageKey,this.instanceID=(t=ff.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,ff.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&zt()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new uD({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Tx(i.fetch),this.lock=i.lock||lE,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&zt()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=dD:this.lock=lE,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new OD(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:xx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=oE(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=oE(this.memoryStorage)),zt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Ex}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},s="none";if(zt()&&(t=VL(window.location.href),this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce")),zt()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),NL(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:l}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Y(t)?this._returnResult({error:t}):this._returnResult({error:new Ra("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const i=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ws}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(Y(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,s,r;try{let i;if("email"in e){const{email:h,password:d,options:f}=e;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await vc(this.storage,this.storageKey)),i=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:d,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:y},xform:Ws})}else if("phone"in e){const{phone:h,password:d,options:f}=e;i=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(r=f==null?void 0:f.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ws})}else throw new Vg("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await $t(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Y(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:rE})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:rE})}else throw new Vg("You must provide either an email or phone number and a password");const{data:s,error:r}=t;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const i=new yc;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(t){if(Y(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,s,r,i,o,l,c,u,h,d,f;let p,y;if("message"in e)p=e.message,y=e.signature;else{const{chain:v,wallet:S,statement:m,options:w}=e;let _;if(zt())if(typeof S=="object")_=S;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")_=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=S}const E=new URL((t=w==null?void 0:w.url)!==null&&t!==void 0?t:window.location.href),k=await _.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!k||k.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=Rx(k[0]);let x=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!x){const I=await _.request({method:"eth_chainId"});x=pD(I)}const P={domain:E.host,address:C,statement:m,uri:E.href,version:"1",chainId:x,nonce:(r=w==null?void 0:w.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(i=w==null?void 0:w.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(h=w==null?void 0:w.signInWithEthereum)===null||h===void 0?void 0:h.resources};p=mD(P),y=await _.request({method:"personal_sign",params:[gD(p),C]})}try{const{data:v,error:S}=await te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:y},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Ws});if(S)throw S;if(!v||!v.session||!v.user){const m=new yc;return this._returnResult({data:{user:null,session:null},error:m})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:S})}catch(v){if(Y(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(e){var t,s,r,i,o,l,c,u,h,d,f,p;let y,v;if("message"in e)y=e.message,v=e.signature;else{const{chain:S,wallet:m,statement:w,options:_}=e;let E;if(zt())if(typeof m=="object")E=m;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))E=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=m}const k=new URL((t=_==null?void 0:_.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in E&&E.signIn){const C=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),w?{statement:w}:null));let x;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")x=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)x=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in x&&"signature"in x&&(typeof x.signedMessage=="string"||x.signedMessage instanceof Uint8Array)&&x.signature instanceof Uint8Array)y=typeof x.signedMessage=="string"?x.signedMessage:new TextDecoder().decode(x.signedMessage),v=x.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${k.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(r=(s=_==null?void 0:_.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((l=_==null?void 0:_.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((u=_==null?void 0:_.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((d=(h=_==null?void 0:_.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||d===void 0)&&d.length?["Resources",..._.signInWithSolana.resources.map(x=>`- ${x}`)]:[]].join(`
`);const C=await E.signMessage(new TextEncoder().encode(y),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=C}}try{const{data:S,error:m}=await te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Fa(v)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ws});if(m)throw m;if(!S||!S.session||!S.user){const w=new yc;return this._returnResult({data:{user:null,session:null},error:w})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:m})}catch(S){if(Y(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(e){const t=await ba(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(t??"").split("/");try{if(!s&&this.flowType==="pkce")throw new ML;const{data:i,error:o}=await te(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ws});if(await $t(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new yc;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:o})}catch(i){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Y(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:i,nonce:o}=e,l=await te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Ws}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const h=new yc;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(t){if(Y(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,s,r,i,o;try{if("email"in e){const{email:l,options:c}=e;let u=null,h=null;this.flowType==="pkce"&&([u,h]=await vc(this.storage,this.storageKey));const{error:d}=await te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:h}=await te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:h})}throw new Vg("You must provide either an email or phone number.")}catch(l){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Y(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,s;try{let r,i;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await te(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:Ws});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(r){if(Y(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var t,s,r,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await vc(this.storage,this.storageKey));const u=await te(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:aD});return!((i=u.data)===null||i===void 0)&&i.url&&zt()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Y(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new $n;const{error:r}=await te(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(Y(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:o}=await te(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:o,error:l}=await te(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Vg("You must provide either an email or phone number and a type")}catch(t){if(Y(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ba(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<iw:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await ba(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=lw()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=sD(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ao}):await this._useSession(async t=>{var s,r,i;const{data:o,error:l}=t;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new $n}:await te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:ao})})}catch(t){if(Y(t))return DL(t)&&(await this._removeSession(),await $t(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new $n;const o=r.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await vc(this.storage,this.storageKey));const{data:u,error:h}=await te(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:ao});if(h)throw h;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Y(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new $n;const t=Date.now()/1e3;let s=t,r=!0,i=null;const{payload:o}=aw(e.access_token);if(o.exp&&(s=o.exp,r=s<=t),r){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(Y(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new $n;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Y(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!zt())throw new Wg("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Wg(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new JA("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wg("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new JA("No code detected.");const{data:w,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=e;if(!i||!l||!o||!u)throw new Wg("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(l);let f=h+d;c&&(f=parseInt(c));const p=f-h;p*1e3<=Ec&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const y=f-d;h-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,f,h):h-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,f,h);const{data:v,error:S}=await this._getUser(i);if(S)throw S;const m={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:d,expires_at:f,refresh_token:o,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:e.type},error:null})}catch(s){if(Y(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ba(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return this._returnResult({error:i});const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(LL(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await $t(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=HL(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:i},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await vc(this.storage,this.storageKey,!0));try{return await te(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Y(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:r}=await this._useSession(async i=>{var o,l,c,u,h;const{data:d,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await te(this.fetch,"GET",p,{headers:this.headers,jwt:(h=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&h!==void 0?h:void 0})});if(r)throw r;return zt()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Y(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var s;try{const{error:r,data:{session:i}}=t;if(r)throw r;const{options:o,provider:l,token:c,access_token:u,nonce:h}=e,d=await te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:u,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ws}),{data:f,error:p}=d;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new yc}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(r){if(await $t(this.storage,`${this.storageKey}-code-verifier`),Y(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:o}=t;if(o)throw o;return await te(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await qL(async r=>(r>0&&await GL(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await te(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ws})),(r,i)=>{const o=200*Math.pow(2,r);return i&&ow(i)&&Date.now()+o-s<Ec})}catch(s){if(this._debug(t,"error",s),Y(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),zt()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await ba(this.storage,this.storageKey);if(r&&this.userStorage){let o=await ba(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await kc(this.userStorage,this.storageKey+"-user",o)),r.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:lw()}else if(r&&!r.user&&!r.user){const o=await ba(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(r.user=o.user,await $t(this.storage,this.storageKey+"-user"),await kc(this.storage,this.storageKey,r)):r.user=lw()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const i=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<iw;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${iw}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),ow(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(r.access_token);!l&&(o!=null&&o.user)?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new $n;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new wv;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new $n;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(r,"error",i),Y(i)){const o={data:null,error:i};return ow(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await $t(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await kc(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const i=nE(r);await kc(this.storage,this.storageKey,i)}else{const r=nE(t);await kc(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await $t(this.storage,this.storageKey),await $t(this.storage,this.storageKey+"-code-verifier"),await $t(this.storage,this.storageKey+"-user"),this.userStorage&&await $t(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&zt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ec);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/Ec);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${Ec}ms, refresh threshold is ${S0} ticks`),r<=S0&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Px)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await vc(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?this._returnResult({data:null,error:i}):await te(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:u}=await te(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return u?this._returnResult({data:null,error:u}):(e.factorType==="totp"&&c.type==="totp"&&(!((r=c==null?void 0:c.totp)===null||r===void 0)&&r.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?AD(e.webauthn.credential_response):ED(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await te(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=await te(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:bD(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:SD(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:s},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=aw(s.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((t=(e=s.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const u=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:s},error:r}=t;return r?this._returnResult({data:null,error:r}):s?await te(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new $n})})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new $n});const o=await te(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&zt()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Y(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new $n});const o=await te(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&zt()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Y(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;return s?this._returnResult({data:null,error:s}):t?await te(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new $n})})}catch(e){if(Y(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:s},error:r}=t;return r?this._returnResult({data:null,error:r}):s?(await te(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new $n})})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(l=>l.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+OL>r)return s;const{data:i,error:o}=await te(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:p,error:y}=await this.getSession();if(y||!p.session)return this._returnResult({data:null,error:y});s=p.session.access_token}const{header:r,payload:i,signature:o,raw:{header:l,payload:c}}=aw(s);t!=null&&t.allowExpired||eD(i.exp);const u=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!u){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:r,signature:o},error:null}}const h=tD(r.alg),d=await crypto.subtle.importKey("jwk",u,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,o,$L(`${l}.${c}`)))throw new k0("Invalid JWT signature");return{data:{claims:i,header:r,signature:o},error:null}}catch(s){if(Y(s))return this._returnResult({data:null,error:s});throw s}}}ff.nextInstanceID={};const LD=ff,DD="2.90.1";let ud="";typeof Deno<"u"?ud="deno":typeof document<"u"?ud="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ud="react-native":ud="node";const ND={"X-Client-Info":`supabase-js-${ud}/${DD}`},MD={headers:ND},FD={schema:"public"},BD={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jD={};function pf(n){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pf(n)}function UD(n,e){if(pf(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(pf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $D(n){var e=UD(n,"string");return pf(e)=="symbol"?e:e+""}function zD(n,e,t){return(e=$D(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cE(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,s)}return t}function at(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?cE(Object(t),!0).forEach(function(s){zD(n,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):cE(Object(t)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(t,s))})}return n}const HD=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),VD=()=>Headers,WD=(n,e,t)=>{const s=HD(t),r=VD();return async(i,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:n;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",n),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),s(i,at(at({},o),{},{headers:u}))}};function GD(n){return n.endsWith("/")?n:n+"/"}function qD(n,e){var t,s;const{db:r,auth:i,realtime:o,global:l}=n,{db:c,auth:u,realtime:h,global:d}=e,f={db:at(at({},c),r),auth:at(at({},u),i),realtime:at(at({},h),o),storage:{},global:at(at(at({},d),l),{},{headers:at(at({},(t=d==null?void 0:d.headers)!==null&&t!==void 0?t:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return n.accessToken?f.accessToken=n.accessToken:delete f.accessToken,f}function KD(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(GD(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var XD=class extends LD{constructor(n){super(n)}},YD=class{constructor(n,e,t){var s,r;this.supabaseUrl=n,this.supabaseKey=e;const i=KD(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:FD,realtime:jD,auth:at(at({},BD),{},{storageKey:o}),global:MD},c=qD(t??{},l);if(this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=c.global.headers)!==null&&r!==void 0?r:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=WD(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(at({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new PI(new URL("rest/v1",i).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new CL(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new EI(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:s}=await n.auth.getSession();return(e=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:s,userStorage:r,storageKey:i,flowType:o,lock:l,debug:c,throwOnError:u},h,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new XD({url:this.authUrl.href,headers:at(at({},f),h),storageKey:i,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:s,userStorage:r,flowType:o,lock:l,debug:c,throwOnError:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new GI(this.realtimeUrl.href,at(at({},n),{},{params:at(at({},{apikey:this.supabaseKey}),n==null?void 0:n.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const JD=(n,e,t)=>new YD(n,e,t);function QD(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}QD()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ZD=void 0,eN=void 0;throw new Error("Missing Supabase environment variables");const Wr=JD(ZD,eN),Ix=z.createContext(void 0),tN=({children:n})=>{const[e,t]=z.useState(null),[s,r]=z.useState(null),[i,o]=z.useState(!0);z.useEffect(()=>{Wr.auth.getSession().then(({data:{session:d}})=>{r(d),t((d==null?void 0:d.user)||null),o(!1)});const{data:{subscription:h}}=Wr.auth.onAuthStateChange((d,f)=>{r(f),t((f==null?void 0:f.user)||null),o(!1)});return()=>h.unsubscribe()},[]);const l=async(h,d)=>{o(!0);const{data:f,error:p}=await Wr.auth.signInWithPassword({email:h,password:d});if(o(!1),p)throw p;return f},c=async(h,d)=>{o(!0);const{data:f,error:p}=await Wr.auth.signUp({email:h,password:d});if(o(!1),p)throw p;return f},u=async()=>{o(!0);const{error:h}=await Wr.auth.signOut();if(o(!1),h)throw h};return D.jsx(Ix.Provider,{value:{user:e,session:s,signIn:l,signUp:c,signOut:u,loading:i},children:n})},Vh=()=>{const n=z.useContext(Ix);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n};function nN(){const[n,e]=z.useState(""),[t,s]=z.useState(""),[r,i]=z.useState(null),{signIn:o,loading:l}=Vh(),c=mv(),u=async h=>{h.preventDefault(),i(null);try{await o(n,t),c("/dashboard")}catch(d){i(d.message)}};return D.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:D.jsxs("div",{className:"max-w-md w-full space-y-8",children:[D.jsx("div",{children:D.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"})}),D.jsxs("form",{className:"mt-8 space-y-6",onSubmit:u,children:[D.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[D.jsx("div",{children:D.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:n,onChange:h=>e(h.target.value)})}),D.jsx("div",{children:D.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:t,onChange:h=>s(h.target.value)})})]}),r&&D.jsx("p",{className:"mt-2 text-center text-sm text-red-600",children:r}),D.jsx("div",{children:D.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:l?"Signing In...":"Sign In"})})]}),D.jsx("div",{className:"text-sm text-center",children:D.jsx("a",{href:"/signup",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Don't have an account? Sign Up"})})]})})}function sN(){const[n,e]=z.useState(""),[t,s]=z.useState(""),[r,i]=z.useState(null),{signUp:o,loading:l}=Vh(),c=mv(),u=async h=>{h.preventDefault(),i(null);try{await o(n,t),c("/dashboard")}catch(d){i(d.message)}};return D.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:D.jsxs("div",{className:"max-w-md w-full space-y-8",children:[D.jsx("div",{children:D.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create a new account"})}),D.jsxs("form",{className:"mt-8 space-y-6",onSubmit:u,children:[D.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[D.jsx("div",{children:D.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:n,onChange:h=>e(h.target.value)})}),D.jsx("div",{children:D.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:t,onChange:h=>s(h.target.value)})})]}),r&&D.jsx("p",{className:"mt-2 text-center text-sm text-red-600",children:r}),D.jsx("div",{children:D.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:l?"Signing Up...":"Sign Up"})})]}),D.jsx("div",{className:"text-sm text-center",children:D.jsx("a",{href:"/login",className:"font-medium text-indigo-600 hover:text-indigo-500",children:"Already have an account? Sign In"})})]})})}const Lx=()=>{const{user:n}=Vh(),[e,t]=z.useState([]),[s,r]=z.useState(!0),[i,o]=z.useState(null);z.useEffect(()=>{n&&l()},[n]);const l=async()=>{if(n){r(!0),o(null);try{const{data:d,error:f}=await Wr.from("user_progress").select("*").eq("user_id",n.id);if(f)throw f;t(d||[])}catch(d){o(d.message)}finally{r(!1)}}};return{progress:e,loading:s,error:i,fetchProgress:l,updateModule:async(d,f)=>{if(!n){o("User not authenticated.");return}o(null);try{const p=f?"completed":"in_progress",y=f?100:50,{data:v,error:S}=await Wr.from("user_progress").upsert({user_id:n.id,module_name:d,status:p,progress_percentage:y,last_updated:new Date().toISOString()},{onConflict:"user_id,module_name"}).select().single();if(S)throw S;t(m=>{const w=m.findIndex(_=>_.module_name===d);if(w>-1){const _=[...m];return _[w]=v,_}return[...m,v]})}catch(p){o(p.message)}},getModuleProgress:d=>e.find(f=>f.module_name===d),getOverallProgressPercentage:()=>{if(e.length===0)return 0;const d=6,f=e.filter(p=>p.status==="completed").length;return Math.round(f/d*100)}}};var rN={exports:{}};(function(n){var e=function(t){var s=Object.prototype,r=s.hasOwnProperty,i=Object.defineProperty||function(R,T,L){R[T]=L.value},o,l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",u=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function d(R,T,L){return Object.defineProperty(R,T,{value:L,enumerable:!0,configurable:!0,writable:!0}),R[T]}try{d({},"")}catch{d=function(T,L,F){return T[L]=F}}function f(R,T,L,F){var $=T&&T.prototype instanceof _?T:_,J=Object.create($.prototype),ie=new K(F||[]);return i(J,"_invoke",{value:ee(R,L,ie)}),J}t.wrap=f;function p(R,T,L){try{return{type:"normal",arg:R.call(T,L)}}catch(F){return{type:"throw",arg:F}}}var y="suspendedStart",v="suspendedYield",S="executing",m="completed",w={};function _(){}function E(){}function k(){}var C={};d(C,c,function(){return this});var x=Object.getPrototypeOf,P=x&&x(x(M([])));P&&P!==s&&r.call(P,c)&&(C=P);var I=k.prototype=_.prototype=Object.create(C);E.prototype=k,i(I,"constructor",{value:k,configurable:!0}),i(k,"constructor",{value:E,configurable:!0}),E.displayName=d(k,h,"GeneratorFunction");function N(R){["next","throw","return"].forEach(function(T){d(R,T,function(L){return this._invoke(T,L)})})}t.isGeneratorFunction=function(R){var T=typeof R=="function"&&R.constructor;return T?T===E||(T.displayName||T.name)==="GeneratorFunction":!1},t.mark=function(R){return Object.setPrototypeOf?Object.setPrototypeOf(R,k):(R.__proto__=k,d(R,h,"GeneratorFunction")),R.prototype=Object.create(I),R},t.awrap=function(R){return{__await:R}};function j(R,T){function L(J,ie,pe,fe){var Ot=p(R[J],R,ie);if(Ot.type==="throw")fe(Ot.arg);else{var wa=Ot.arg,Hs=wa.value;return Hs&&typeof Hs=="object"&&r.call(Hs,"__await")?T.resolve(Hs.__await).then(function(fn){L("next",fn,pe,fe)},function(fn){L("throw",fn,pe,fe)}):T.resolve(Hs).then(function(fn){wa.value=fn,pe(wa)},function(fn){return L("throw",fn,pe,fe)})}}var F;function $(J,ie){function pe(){return new T(function(fe,Ot){L(J,ie,fe,Ot)})}return F=F?F.then(pe,pe):pe()}i(this,"_invoke",{value:$})}N(j.prototype),d(j.prototype,u,function(){return this}),t.AsyncIterator=j,t.async=function(R,T,L,F,$){$===void 0&&($=Promise);var J=new j(f(R,T,L,F),$);return t.isGeneratorFunction(T)?J:J.next().then(function(ie){return ie.done?ie.value:J.next()})};function ee(R,T,L){var F=y;return function(J,ie){if(F===S)throw new Error("Generator is already running");if(F===m){if(J==="throw")throw ie;return O()}for(L.method=J,L.arg=ie;;){var pe=L.delegate;if(pe){var fe=se(pe,L);if(fe){if(fe===w)continue;return fe}}if(L.method==="next")L.sent=L._sent=L.arg;else if(L.method==="throw"){if(F===y)throw F=m,L.arg;L.dispatchException(L.arg)}else L.method==="return"&&L.abrupt("return",L.arg);F=S;var Ot=p(R,T,L);if(Ot.type==="normal"){if(F=L.done?m:v,Ot.arg===w)continue;return{value:Ot.arg,done:L.done}}else Ot.type==="throw"&&(F=m,L.method="throw",L.arg=Ot.arg)}}}function se(R,T){var L=T.method,F=R.iterator[L];if(F===o)return T.delegate=null,L==="throw"&&R.iterator.return&&(T.method="return",T.arg=o,se(R,T),T.method==="throw")||L!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+L+"' method")),w;var $=p(F,R.iterator,T.arg);if($.type==="throw")return T.method="throw",T.arg=$.arg,T.delegate=null,w;var J=$.arg;if(!J)return T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,w;if(J.done)T[R.resultName]=J.value,T.next=R.nextLoc,T.method!=="return"&&(T.method="next",T.arg=o);else return J;return T.delegate=null,w}N(I),d(I,h,"Generator"),d(I,c,function(){return this}),d(I,"toString",function(){return"[object Generator]"});function Q(R){var T={tryLoc:R[0]};1 in R&&(T.catchLoc=R[1]),2 in R&&(T.finallyLoc=R[2],T.afterLoc=R[3]),this.tryEntries.push(T)}function re(R){var T=R.completion||{};T.type="normal",delete T.arg,R.completion=T}function K(R){this.tryEntries=[{tryLoc:"root"}],R.forEach(Q,this),this.reset(!0)}t.keys=function(R){var T=Object(R),L=[];for(var F in T)L.push(F);return L.reverse(),function $(){for(;L.length;){var J=L.pop();if(J in T)return $.value=J,$.done=!1,$}return $.done=!0,$}};function M(R){if(R){var T=R[c];if(T)return T.call(R);if(typeof R.next=="function")return R;if(!isNaN(R.length)){var L=-1,F=function $(){for(;++L<R.length;)if(r.call(R,L))return $.value=R[L],$.done=!1,$;return $.value=o,$.done=!0,$};return F.next=F}}return{next:O}}t.values=M;function O(){return{value:o,done:!0}}return K.prototype={constructor:K,reset:function(R){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(re),!R)for(var T in this)T.charAt(0)==="t"&&r.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=o)},stop:function(){this.done=!0;var R=this.tryEntries[0],T=R.completion;if(T.type==="throw")throw T.arg;return this.rval},dispatchException:function(R){if(this.done)throw R;var T=this;function L(fe,Ot){return J.type="throw",J.arg=R,T.next=fe,Ot&&(T.method="next",T.arg=o),!!Ot}for(var F=this.tryEntries.length-1;F>=0;--F){var $=this.tryEntries[F],J=$.completion;if($.tryLoc==="root")return L("end");if($.tryLoc<=this.prev){var ie=r.call($,"catchLoc"),pe=r.call($,"finallyLoc");if(ie&&pe){if(this.prev<$.catchLoc)return L($.catchLoc,!0);if(this.prev<$.finallyLoc)return L($.finallyLoc)}else if(ie){if(this.prev<$.catchLoc)return L($.catchLoc,!0)}else if(pe){if(this.prev<$.finallyLoc)return L($.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(R,T){for(var L=this.tryEntries.length-1;L>=0;--L){var F=this.tryEntries[L];if(F.tryLoc<=this.prev&&r.call(F,"finallyLoc")&&this.prev<F.finallyLoc){var $=F;break}}$&&(R==="break"||R==="continue")&&$.tryLoc<=T&&T<=$.finallyLoc&&($=null);var J=$?$.completion:{};return J.type=R,J.arg=T,$?(this.method="next",this.next=$.finallyLoc,w):this.complete(J)},complete:function(R,T){if(R.type==="throw")throw R.arg;return R.type==="break"||R.type==="continue"?this.next=R.arg:R.type==="return"?(this.rval=this.arg=R.arg,this.method="return",this.next="end"):R.type==="normal"&&T&&(this.next=T),w},finish:function(R){for(var T=this.tryEntries.length-1;T>=0;--T){var L=this.tryEntries[T];if(L.finallyLoc===R)return this.complete(L.completion,L.afterLoc),re(L),w}},catch:function(R){for(var T=this.tryEntries.length-1;T>=0;--T){var L=this.tryEntries[T];if(L.tryLoc===R){var F=L.completion;if(F.type==="throw"){var $=F.arg;re(L)}return $}}throw new Error("illegal catch attempt")},delegateYield:function(R,T,L){return this.delegate={iterator:M(R),resultName:T,nextLoc:L},this.method==="next"&&(this.arg=o),w}},t}(n.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(rN);var rS=(n,e)=>`${n}-${e}-${Math.random().toString(16).slice(3,8)}`;const iN=rS;let uE=0;var Dx=({id:n,action:e,payload:t={}})=>{let s=n;return typeof s>"u"&&(s=iN("Job",uE),uE+=1),{id:s,action:e,payload:t}},Wh={};let iS=!1;Wh.logging=iS;Wh.setLogging=n=>{iS=n};Wh.log=(...n)=>iS?console.log.apply(void 0,n):null;const oN=Dx,{log:Gg}=Wh,aN=rS;let hE=0;var lN=()=>{const n=aN("Scheduler",hE),e={},t={};let s=[];hE+=1;const r=()=>s.length,i=()=>Object.keys(e).length,o=()=>{if(s.length!==0){const d=Object.keys(e);for(let f=0;f<d.length;f+=1)if(typeof t[d[f]]>"u"){s[0](e[d[f]]);break}}},l=(d,f)=>new Promise((p,y)=>{const v=oN({action:d,payload:f});s.push(async S=>{s.shift(),t[S.id]=v;try{p(await S[d].apply(void 0,[...f,v.id]))}catch(m){y(m)}finally{delete t[S.id],o()}}),Gg(`[${n}]: Add ${v.id} to JobQueue`),Gg(`[${n}]: JobQueue length=${s.length}`),o()});return{addWorker:d=>(e[d.id]=d,Gg(`[${n}]: Add ${d.id}`),Gg(`[${n}]: Number of workers=${i()}`),o(),d.id),addJob:async(d,...f)=>{if(i()===0)throw Error(`[${n}]: You need to have at least one worker before adding jobs`);return l(d,f)},terminate:async()=>{Object.keys(e).forEach(async d=>{await e[d].terminate()}),s=[]},getQueueLen:r,getNumWorkers:i}};function cN(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var uN=n=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof cN=="function"&&(e.type="node"),typeof n>"u"?e:e[n]};const hN=uN("type")==="browser",dN=hN?n=>new URL(n,window.location.href).href:n=>n;var fN=n=>{const e={...n};return["corePath","workerPath","langPath"].forEach(t=>{n[t]&&(e[t]=dN(e[t]))}),e},Nx={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const pN="7.0.0",gN={version:pN};var mN={workerBlobURL:!0,logger:()=>{}};const yN=gN.version,vN=mN;var wN={...vN,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${yN}/dist/worker.min.js`},_N=({workerPath:n,workerBlobURL:e})=>{let t;if(Blob&&URL&&e){const s=new Blob([`importScripts("${n}");`],{type:"application/javascript"});t=new Worker(URL.createObjectURL(s))}else t=new Worker(n);return t},bN=n=>{n.terminate()},SN=(n,e)=>{n.onmessage=({data:t})=>{e(t)}},AN=async(n,e)=>{n.postMessage(e)};const uw=n=>new Promise((e,t)=>{const s=new FileReader;s.onload=()=>{e(s.result)},s.onerror=({target:{error:{code:r}}})=>{t(Error(`File could not be read! Code=${r}`))},s.readAsArrayBuffer(n)}),C0=async n=>{let e=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?e=atob(n.split(",")[1]).split("").map(t=>t.charCodeAt(0)):e=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(e=await C0(n.src)),n.tagName==="VIDEO"&&(e=await C0(n.poster)),n.tagName==="CANVAS"&&await new Promise(t=>{n.toBlob(async s=>{e=await uw(s),t()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const t=await n.convertToBlob();e=await uw(t)}else(n instanceof File||n instanceof Blob)&&(e=await uw(n));return new Uint8Array(e)};var EN=C0;const kN=wN,CN=_N,xN=bN,TN=SN,PN=AN,RN=EN;var ON={defaultOptions:kN,spawnWorker:CN,terminateWorker:xN,onMessage:TN,send:PN,loadImage:RN};const IN=fN,yr=Dx,{log:dE}=Wh,LN=rS,Sa=Nx,{defaultOptions:DN,spawnWorker:NN,terminateWorker:MN,onMessage:FN,loadImage:fE,send:BN}=ON;let pE=0;var Mx=async(n="eng",e=Sa.LSTM_ONLY,t={},s={})=>{const r=LN("Worker",pE),{logger:i,errorHandler:o,...l}=IN({...DN,...t}),c={},u=typeof n=="string"?n.split("+"):n;let h=e,d=s;const f=[Sa.DEFAULT,Sa.LSTM_ONLY].includes(e)&&!l.legacyCore;let p,y;const v=new Promise((M,O)=>{y=M,p=O}),S=M=>{p(M.message)};let m=NN(l);m.onerror=S,pE+=1;const w=({id:M,action:O,payload:R})=>new Promise((T,L)=>{dE(`[${r}]: Start ${M}, action=${O}`);const F=`${O}-${M}`;c[F]={resolve:T,reject:L},BN(m,{workerId:r,jobId:M,action:O,payload:R})}),_=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),E=M=>w(yr({id:M,action:"load",payload:{options:{lstmOnly:f,corePath:l.corePath,logging:l.logging}}})),k=(M,O,R)=>w(yr({id:R,action:"FS",payload:{method:"writeFile",args:[M,O]}})),C=(M,O)=>w(yr({id:O,action:"FS",payload:{method:"readFile",args:[M,{encoding:"utf8"}]}})),x=(M,O)=>w(yr({id:O,action:"FS",payload:{method:"unlink",args:[M]}})),P=(M,O,R)=>w(yr({id:R,action:"FS",payload:{method:M,args:O}})),I=(M,O)=>w(yr({id:O,action:"loadLanguage",payload:{langs:M,options:{langPath:l.langPath,dataPath:l.dataPath,cachePath:l.cachePath,cacheMethod:l.cacheMethod,gzip:l.gzip,lstmOnly:[Sa.DEFAULT,Sa.LSTM_ONLY].includes(h)&&!l.legacyLang}}})),N=(M,O,R,T)=>w(yr({id:T,action:"initialize",payload:{langs:M,oem:O,config:R}})),j=(M="eng",O,R,T)=>{if(f&&[Sa.TESSERACT_ONLY,Sa.TESSERACT_LSTM_COMBINED].includes(O))throw Error("Legacy model requested but code missing.");const L=O||h;h=L;const F=R||d;d=F;const J=(typeof M=="string"?M.split("+"):M).filter(ie=>!u.includes(ie));return u.push(...J),J.length>0?I(J,T).then(()=>N(M,L,F,T)):N(M,L,F,T)},ee=(M={},O)=>w(yr({id:O,action:"setParameters",payload:{params:M}})),se=async(M,O={},R={text:!0},T)=>w(yr({id:T,action:"recognize",payload:{image:await fE(M),options:O,output:R}})),Q=async(M,O)=>{if(f)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return w(yr({id:O,action:"detect",payload:{image:await fE(M)}}))},re=async()=>(m!==null&&(MN(m),m=null),Promise.resolve());FN(m,({workerId:M,jobId:O,status:R,action:T,data:L})=>{const F=`${T}-${O}`;if(R==="resolve")dE(`[${M}]: Complete ${O}`),c[F].resolve({jobId:O,data:L}),delete c[F];else if(R==="reject")if(c[F].reject(L),delete c[F],T==="load"&&p(L),o)o(L);else throw Error(L);else R==="progress"&&i({...L,userJobId:O})});const K={id:r,worker:m,load:_,writeText:k,readText:C,removeFile:x,FS:P,reinitialize:j,setParameters:ee,recognize:se,detect:Q,terminate:re};return E().then(()=>I(n)).then(()=>N(n,e,s)).then(()=>y(K)).catch(()=>{}),v};const Fx=Mx,jN=async(n,e,t)=>{const s=await Fx(e,1,t);return s.recognize(n).finally(async()=>{await s.terminate()})},UN=async(n,e)=>{const t=await Fx("osd",0,e);return t.detect(n).finally(async()=>{await t.terminate()})};var $N={recognize:jN,detect:UN},zN={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},HN={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const VN=lN,WN=Mx,GN=$N,qN=zN,KN=Nx,XN=HN,{setLogging:YN}=Wh;var JN={languages:qN,OEM:KN,PSM:XN,createScheduler:VN,createWorker:WN,setLogging:YN,...GN};const QN=zE(JN),wn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),x0=[.001,0,0,.001,0,0],hw=1.35,ls={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},lo={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},gf="pdfjs_internal_editor_",ce={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ve={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},ZN={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},T0={TRIANGLES:1,LATTICE:2},St={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},pm={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},gt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Cc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},_v={ERRORS:0,WARNINGS:1,INFOS:5},mf={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ed={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},eM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let bv=_v.WARNINGS;function tM(n){Number.isInteger(n)&&(bv=n)}function nM(){return bv}function Sv(n){bv>=_v.INFOS&&console.info(`Info: ${n}`)}function oe(n){bv>=_v.WARNINGS&&console.warn(`Warning: ${n}`)}function Fe(n){throw new Error(n)}function we(n,e){n||Fe(e)}function sM(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Bx(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const r=n.match(/\./g);(r==null?void 0:r.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=lM(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return sM(s)?s:null}function jx(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&Bx(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function ae(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const fc=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class gE extends fc{constructor(e,t){super(e,"PasswordException"),this.code=t}}class dw extends fc{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class P0 extends fc{constructor(e){super(e,"InvalidPDFException")}}class by extends fc{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class rM extends fc{constructor(e){super(e,"FormatError")}}class fa extends fc{constructor(e){super(e,"AbortException")}}function Ux(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Fe("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let r=0;r<e;r+=t){const i=Math.min(r+t,e),o=n.subarray(r,i);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function vg(n){typeof n!="string"&&Fe("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function iM(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function oM(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function aM(){try{return new Function(""),!0}catch{return!1}}class Rt{static get isLittleEndian(){return ae(this,"isLittleEndian",oM())}static get isEvalSupported(){return ae(this,"isEvalSupported",aM())}static get isOffscreenCanvasSupported(){return ae(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ae(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ae(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ae(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return ae(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return ae(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const fw=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Hi,gm,R0;class V{static makeHexColor(e,t,s){return`#${fw[e]}${fw[t]}${fw[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const r=e[s],i=e[s+1];e[s]=r*t[0]+i*t[2]+t[4],e[s+1]=r*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const r=t[0],i=t[1],o=t[2],l=t[3],c=t[4],u=t[5];for(let h=0;h<6;h+=2){const d=e[s+h],f=e[s+h+1];e[s+h]=d*r+f*o+c,e[s+h+1]=d*i+f*l+u}}static applyInverseTransform(e,t){const s=e[0],r=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-s*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,s){const r=t[0],i=t[1],o=t[2],l=t[3],c=t[4],u=t[5],h=e[0],d=e[1],f=e[2],p=e[3];let y=r*h+c,v=y,S=r*f+c,m=S,w=l*d+u,_=w,E=l*p+u,k=E;if(i!==0||o!==0){const C=i*h,x=i*f,P=o*d,I=o*p;y+=P,m+=P,S+=I,v+=I,w+=C,k+=C,E+=x,_+=x}s[0]=Math.min(s[0],y,S,v,m),s[1]=Math.min(s[1],w,E,_,k),s[2]=Math.max(s[2],y,S,v,m),s[3]=Math.max(s[3],w,E,_,k)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],r=e[1],i=e[2],o=e[3],l=s**2+r**2,c=s*i+r*o,u=i**2+o**2,h=(l+u)/2,d=Math.sqrt(h**2-(l*u-c**2));t[0]=Math.sqrt(h+d||1),t[1]=Math.sqrt(h-d||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>r)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>o?null:[s,i,r,o]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,r,i){i[0]=Math.min(i[0],e,s),i[1]=Math.min(i[1],t,r),i[2]=Math.max(i[2],e,s),i[3]=Math.max(i[3],t,r)}static bezierBoundingBox(e,t,s,r,i,o,l,c,u){u[0]=Math.min(u[0],e,l),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,l),u[3]=Math.max(u[3],t,c),A(this,Hi,R0).call(this,e,s,i,l,t,r,o,c,3*(-e+3*(s-i)+l),6*(e-2*s+i),3*(s-e),u),A(this,Hi,R0).call(this,e,s,i,l,t,r,o,c,3*(-t+3*(r-o)+c),6*(t-2*r+o),3*(r-t),u)}}Hi=new WeakSet,gm=function(e,t,s,r,i,o,l,c,u,h){if(u<=0||u>=1)return;const d=1-u,f=u*u,p=f*u,y=d*(d*(d*e+3*u*t)+3*f*s)+p*r,v=d*(d*(d*i+3*u*o)+3*f*l)+p*c;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],v),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],v)},R0=function(e,t,s,r,i,o,l,c,u,h,d,f){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&A(this,Hi,gm).call(this,e,t,s,r,i,o,l,c,-d/h,f);return}const p=h**2-4*d*u;if(p<0)return;const y=Math.sqrt(p),v=2*u;A(this,Hi,gm).call(this,e,t,s,r,i,o,l,c,(-h+y)/v,f),A(this,Hi,gm).call(this,e,t,s,r,i,o,l,c,(-h-y)/v,f)},b(V,Hi);function lM(n){return decodeURIComponent(escape(n))}let pw=null,mE=null;function cM(n){return pw||(pw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,mE=new Map([["","t"]])),n.replaceAll(pw,(e,t,s)=>t?t.normalize("NFKC"):mE.get(s))}function $x(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),Ux(n)}const qc="pdfjs_internal_id_";function uM(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,r,...i]=t;if(!n(s)&&!Number.isInteger(s)||!e(r))return!1;const o=i.length;let l=!0;switch(r.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;l=!1;break;default:return!1}for(const c of i)if(!(typeof c=="number"||l&&c===null))return!1;return!0}function _n(n,e,t){return Math.min(Math.max(n,e),t)}function zx(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(Ux(n))}function hM(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):vg(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class yf{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function r(i){var c;if(!i)return;let o=null;const l=i.name;if(l==="#text")o=i.value;else if(yf.shouldBuildText(l))(c=i==null?void 0:i.attributes)!=null&&c.textContent?o=i.attributes.textContent:i.value&&(o=i.value);else return;if(o!==null&&t.push({str:o}),!!i.children)for(const u of i.children)r(u)}return r(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class Hx{static setupStorage(e,t,s,r,i){const o=r.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),i==="print")break;e.addEventListener("input",l=>{r.setValue(t,{value:l.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",l=>{r.setValue(t,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),i==="print")break;e.addEventListener("input",l=>{r.setValue(t,{value:l.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const l of s.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}e.addEventListener("input",l=>{const c=l.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;r.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:r,linkService:i}){const{attributes:o}=t,l=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${r}`);for(const[c,u]of Object.entries(o))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!l||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}l&&i.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){var d,f;const t=e.annotationStorage,s=e.linkService,r=e.xfaHtml,i=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:i,linkService:s});const l=i!=="richText",c=e.div;if(c.append(o),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=p}l&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(r.children.length===0){if(r.value){const p=document.createTextNode(r.value);o.append(p),l&&yf.shouldBuildText(r.name)&&u.push(p)}return{textDivs:u}}const h=[[r,-1,o]];for(;h.length>0;){const[p,y,v]=h.at(-1);if(y+1===p.children.length){h.pop();continue}const S=p.children[++h.at(-1)[1]];if(S===null)continue;const{name:m}=S;if(m==="#text"){const _=document.createTextNode(S.value);u.push(_),v.append(_);continue}const w=(d=S==null?void 0:S.attributes)!=null&&d.xmlns?document.createElementNS(S.attributes.xmlns,m):document.createElement(m);if(v.append(w),S.attributes&&this.setAttributes({html:w,element:S,storage:t,intent:i,linkService:s}),((f=S.children)==null?void 0:f.length)>0)h.push([S,-1,w]);else if(S.value){const _=document.createTextNode(S.value);l&&yf.shouldBuildText(m)&&u.push(_),w.append(_)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Jr="http://www.w3.org/2000/svg",Oa=class Oa{};B(Oa,"CSS",96),B(Oa,"PDF",72),B(Oa,"PDF_TO_CSS_UNITS",Oa.CSS/Oa.PDF);let pa=Oa;async function wg(n,e="text"){if(hd(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class _g{constructor({viewBox:e,userUnit:t,scale:s,rotation:r,offsetX:i=0,offsetY:o=0,dontFlip:l=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=r,this.offsetX=i,this.offsetY=o,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,d,f,p;switch(r%=360,r<0&&(r+=360),r){case 180:h=-1,d=0,f=0,p=1;break;case 90:h=0,d=1,f=1,p=0;break;case 270:h=0,d=-1,f=-1,p=0;break;case 0:h=1,d=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(f=-f,p=-p);let y,v,S,m;h===0?(y=Math.abs(u-e[1])*s+i,v=Math.abs(c-e[0])*s+o,S=(e[3]-e[1])*s,m=(e[2]-e[0])*s):(y=Math.abs(c-e[0])*s+i,v=Math.abs(u-e[1])*s+o,S=(e[2]-e[0])*s,m=(e[3]-e[1])*s),this.transform=[h*s,d*s,f*s,p*s,y-h*s*c-f*s*u,v-d*s*c-p*s*u],this.width=S,this.height=m}get rawDims(){const e=this.viewBox;return ae(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:i=!1}={}){return new _g({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:r,dontFlip:i})}convertToViewportPoint(e,t){const s=[e,t];return V.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];V.applyTransform(t,this.transform);const s=[e[2],e[3]];return V.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return V.applyInverseTransform(s,this.transform),s}}class oS extends fc{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Av(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function aS(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function dM(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function fM(n,e="document.pdf"){if(typeof n!="string")return e;if(Av(n))return oe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const r=l=>{try{let c=decodeURIComponent(l);return c.includes("/")?(c=c.split("/").at(-1),c.test(/^\.pdf$/i)?c:l):c}catch{return l}},i=/\.pdf$/i,o=s.pathname.split("/").at(-1);if(i.test(o))return r(o);if(s.searchParams.size>0){const l=Array.from(s.searchParams.values()).reverse();for(const u of l)if(i.test(u))return r(u);const c=Array.from(s.searchParams.keys()).reverse();for(const u of c)if(i.test(u))return r(u)}if(s.hash){const c=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(c)return r(c[0])}return e}class yE{constructor(){B(this,"started",Object.create(null));B(this,"times",[])}time(e){e in this.started&&oe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||oe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:r,end:i}of this.times)e.push(`${s.padEnd(t)} ${i-r}ms
`);return e.join("")}}function hd(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function zs(n){n.preventDefault()}function ut(n){n.preventDefault(),n.stopPropagation()}function pM(n){console.log("Deprecated API usage: "+n)}var _f;class Sy{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;a(this,_f)||g(this,_f,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=a(this,_f).exec(e);if(!t)return null;const s=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(t[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(o+=h,l+=d):u==="+"&&(o-=h,l-=d),new Date(Date.UTC(s,r,i,o,l,c))}}_f=new WeakMap,b(Sy,_f);function gM(n,{scale:e=1,rotation:t=0}){const{width:s,height:r}=n.attributes.style,i=[0,0,parseInt(s),parseInt(r)];return new _g({viewBox:i,userUnit:1,scale:e,rotation:t})}function bg(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(oe(`Not a valid color format: "${n}"`),[0,0,0])}function mM(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,bg(s))}e.remove()}function Je(n){const{a:e,b:t,c:s,d:r,e:i,f:o}=n.getTransform();return[e,t,s,r,i,o]}function vr(n){const{a:e,b:t,c:s,d:r,e:i,f:o}=n.getTransform().invertSelf();return[e,t,s,r,i,o]}function ac(n,e,t=!1,s=!0){if(e instanceof _g){const{pageWidth:r,pageHeight:i}=e.rawDims,{style:o}=n,l=Rt.isCSSRoundSupported,c=`var(--total-scale-factor) * ${r}px`,u=`var(--total-scale-factor) * ${i}px`,h=l?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,d=l?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=h,o.height=d):(o.width=d,o.height=h)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Xr{constructor(){const{pixelRatio:e}=Xr;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,r,i=-1){let o=1/0,l=1/0,c=1/0;s=Xr.capPixels(s,i),s>0&&(o=Math.sqrt(s/(e*t))),r!==-1&&(l=r/e,c=r/t);const u=Math.min(o,l,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const O0=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class yM{static get isDarkMode(){var e;return ae(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class vM{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),ae(this,"commentForegroundColor",bg(s))}}function wM(n,e,t,s){s=Math.min(Math.max(s??1,0),1);const r=255*(1-s);return n=Math.round(n*s+r),e=Math.round(e*s+r),t=Math.round(t*s+r),[n,e,t]}function vE(n,e){const t=n[0]/255,s=n[1]/255,r=n[2]/255,i=Math.max(t,s,r),o=Math.min(t,s,r),l=(i+o)/2;if(i===o)e[0]=e[1]=0;else{const c=i-o;switch(e[1]=l<.5?c/(i+o):c/(2-i-o),i){case t:e[0]=((s-r)/c+(s<r?6:0))*60;break;case s:e[0]=((r-t)/c+2)*60;break;case r:e[0]=((t-s)/c+4)*60;break}}e[2]=l}function I0(n,e){const t=n[0],s=n[1],r=n[2],i=(1-Math.abs(2*r-1))*s,o=i*(1-Math.abs(t/60%2-1)),l=r-i/2;switch(Math.floor(t/60)){case 0:e[0]=i+l,e[1]=o+l,e[2]=l;break;case 1:e[0]=o+l,e[1]=i+l,e[2]=l;break;case 2:e[0]=l,e[1]=i+l,e[2]=o+l;break;case 3:e[0]=l,e[1]=o+l,e[2]=i+l;break;case 4:e[0]=o+l,e[1]=l,e[2]=i+l;break;case 5:case 6:e[0]=i+l,e[1]=l,e[2]=o+l;break}}function wE(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function _E(n,e,t){I0(n,t),t.map(wE);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];I0(e,t),t.map(wE);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>r?(s+.05)/(r+.05):(r+.05)/(s+.05)}const bE=new Map;function _M(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=bE.get(t);if(s)return s;const r=new Float32Array(9),i=r.subarray(0,3),o=r.subarray(3,6);vE(n,o);const l=r.subarray(6,9);vE(e,l);const c=l[2]<.5,u=c?12:4.5;if(o[2]=c?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),_E(o,l,i)<u){let h,d;c?(h=o[2],d=1):(h=0,d=o[2]);const f=.005;for(;d-h>f;){const p=o[2]=(h+d)/2;c===_E(o,l,i)<u?h=p:d=p}o[2]=c?d:h}return I0(o,i),s=V.makeHexColor(Math.round(i[0]*255),Math.round(i[1]*255),Math.round(i[2]*255)),bE.set(t,s),s}function Vx({html:n,dir:e,className:t},s){const r=document.createDocumentFragment();if(typeof n=="string"){const i=document.createElement("p");i.dir=e||"auto";const o=n.split(/(?:\r\n?|\n)/);for(let l=0,c=o.length;l<c;++l){const u=o[l];i.append(document.createTextNode(u)),l<c-1&&i.append(document.createElement("br"))}r.append(i)}else Hx.render({xfaHtml:n,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",t),s.append(r)}function Wx(n){const e=new Path2D;if(!n)return e;for(let t=0,s=n.length;t<s;)switch(n[t++]){case ed.moveTo:e.moveTo(n[t++],n[t++]);break;case ed.lineTo:e.lineTo(n[t++],n[t++]);break;case ed.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case ed.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case ed.closePath:e.closePath();break;default:oe(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}var co,uo,Ss,As,bf,ho,au,lu,Sf,Dy,Gx,Qt,qx,Kx,xc,dd;const ni=class ni{constructor(e){b(this,Qt);b(this,co,null);b(this,uo,null);b(this,Ss);b(this,As,null);b(this,bf,null);b(this,ho,null);b(this,au,null);b(this,lu,null);g(this,Ss,e),a(ni,Sf)||g(ni,Sf,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=g(this,co,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=a(this,Ss)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",zs,{signal:t}),e.addEventListener("pointerdown",A(ni,Dy,Gx),{signal:t}));const s=g(this,As,document.createElement("div"));s.className="buttons",e.append(s);const r=a(this,Ss).toolbarPosition;if(r){const{style:i}=e,o=a(this,Ss)._uiManager.direction==="ltr"?1-r[0]:r[0];i.insetInlineEnd=`${100*o}%`,i.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return a(this,co)}hide(){var e;a(this,co).classList.add("hidden"),(e=a(this,uo))==null||e.hideDropdown()}show(){var e,t;a(this,co).classList.remove("hidden"),(e=a(this,bf))==null||e.shown(),(t=a(this,ho))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=a(this,Ss),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",a(ni,Sf)[e]),A(this,Qt,xc).call(this,s)&&s.addEventListener("click",r=>{t.delete()},{signal:t._signal}),a(this,As).append(s)}async addAltText(e){const t=await e.render();A(this,Qt,xc).call(this,t),a(this,As).append(t,a(this,Qt,dd)),g(this,bf,e)}addComment(e,t=null){if(a(this,ho))return;const s=e.renderForToolbar();if(!s)return;A(this,Qt,xc).call(this,s);const r=g(this,au,a(this,Qt,dd));t?(a(this,As).insertBefore(s,t),a(this,As).insertBefore(r,t)):a(this,As).append(s,r),g(this,ho,e),e.toolbar=this}addColorPicker(e){if(a(this,uo))return;g(this,uo,e);const t=e.renderButton();A(this,Qt,xc).call(this,t),a(this,As).append(t,a(this,Qt,dd))}async addEditSignatureButton(e){const t=g(this,lu,await e.renderEditButton(a(this,Ss)));A(this,Qt,xc).call(this,t),a(this,As).append(t,a(this,Qt,dd))}removeButton(e){var t,s;switch(e){case"comment":(t=a(this,ho))==null||t.removeToolbarCommentButton(),g(this,ho,null),(s=a(this,au))==null||s.remove(),g(this,au,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,s){if(!t&&e==="comment")return;const r=a(this,As).querySelector(s);r&&e==="comment"&&this.addComment(t,r)}updateEditSignatureButton(e){a(this,lu)&&(a(this,lu).title=e)}remove(){var e;a(this,co).remove(),(e=a(this,uo))==null||e.destroy(),g(this,uo,null)}};co=new WeakMap,uo=new WeakMap,Ss=new WeakMap,As=new WeakMap,bf=new WeakMap,ho=new WeakMap,au=new WeakMap,lu=new WeakMap,Sf=new WeakMap,Dy=new WeakSet,Gx=function(e){e.stopPropagation()},Qt=new WeakSet,qx=function(e){a(this,Ss)._focusEventsAllowed=!1,ut(e)},Kx=function(e){a(this,Ss)._focusEventsAllowed=!0,ut(e)},xc=function(e){const t=a(this,Ss)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",A(this,Qt,qx).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",A(this,Qt,Kx).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",zs,{signal:t}),!0)},dd=function(){const e=document.createElement("div");return e.className="divider",e},b(ni,Dy),b(ni,Sf,null);let L0=ni;var Af,Ba,ii,Yi,Xx,Yx,D0;class bM{constructor(e){b(this,Yi);b(this,Af,null);b(this,Ba,null);b(this,ii);g(this,ii,e)}show(e,t,s){const[r,i]=A(this,Yi,Yx).call(this,t,s),{style:o}=a(this,Ba)||g(this,Ba,A(this,Yi,Xx).call(this));e.append(a(this,Ba)),o.insetInlineEnd=`${100*r}%`,o.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){a(this,Ba).remove()}}Af=new WeakMap,Ba=new WeakMap,ii=new WeakMap,Yi=new WeakSet,Xx=function(){const e=g(this,Ba,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=a(this,ii)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",zs,{signal:t});const s=g(this,Af,document.createElement("div"));return s.className="buttons",e.append(s),a(this,ii).hasCommentManager()&&A(this,Yi,D0).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{a(this,ii).commentSelection("floating_button")}),A(this,Yi,D0).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{a(this,ii).highlightSelection("floating_button")}),e},Yx=function(e,t){let s=0,r=0;for(const i of e){const o=i.y+i.height;if(o<s)continue;const l=i.x+(t?i.width:0);if(o>s){r=l,s=o;continue}t?l>r&&(r=l):l<r&&(r=l)}return[t?1-r:r,s]},D0=function(e,t,s,r){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const o=document.createElement("span");i.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",s);const l=a(this,ii)._signal;l instanceof AbortSignal&&!l.aborted&&(i.addEventListener("contextmenu",zs,{signal:l}),i.addEventListener("click",r,{signal:l})),a(this,Af).append(i)};function Jx(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var ja,Ua,cu,$a;const Te=class Te{static initializeAndAddPointerId(e){(a(Te,Ua)||g(Te,Ua,new Set)).add(e)}static setPointer(e,t){a(Te,ja)||g(Te,ja,t),a(Te,$a)??g(Te,$a,e)}static setTimeStamp(e){g(Te,cu,e)}static isSamePointerId(e){return a(Te,ja)===e}static isSamePointerIdOrRemove(e){var t;return a(Te,ja)===e?!0:((t=a(Te,Ua))==null||t.delete(e),!1)}static isSamePointerType(e){return a(Te,$a)===e}static isInitializedAndDifferentPointerType(e){return a(Te,$a)!==null&&!Te.isSamePointerType(e)}static isSameTimeStamp(e){return a(Te,cu)===e}static isUsingMultiplePointers(){var e;return((e=a(Te,Ua))==null?void 0:e.size)>=1}static clearPointerType(){g(Te,$a,null)}static clearPointerIds(){g(Te,ja,NaN),g(Te,Ua,null)}static clearTimeStamp(){g(Te,cu,NaN)}};ja=new WeakMap,Ua=new WeakMap,cu=new WeakMap,$a=new WeakMap,b(Te,ja,NaN),b(Te,Ua,null),b(Te,cu,NaN),b(Te,$a,null);let rn=Te;var Ny;class SM{constructor(){b(this,Ny,0)}get id(){return`${gf}${bt(this,Ny)._++}`}}Ny=new WeakMap;var uu,Ef,on,hu,mm;const gS=class gS{constructor(){b(this,hu);b(this,uu,$x());b(this,Ef,0);b(this,on,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const i=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ae(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:s,size:r,type:i}=e;return A(this,hu,mm).call(this,`${t}_${s}_${r}_${i}`,e)}async getFromUrl(e){return A(this,hu,mm).call(this,e,e)}async getFromBlob(e,t){const s=await t;return A(this,hu,mm).call(this,e,s)}async getFromId(e){a(this,on)||g(this,on,new Map);const t=a(this,on).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){a(this,on)||g(this,on,new Map);let s=a(this,on).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${a(this,uu)}_${bt(this,Ef)._++}`,refCounter:1,isSvg:!1},a(this,on).set(e,s),a(this,on).set(s.id,s),s}getSvgUrl(e){const t=a(this,on).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var r;a(this,on)||g(this,on,new Map);const t=a(this,on).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(s.width,s.height);i.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=i.convertToBlob()}(r=s.close)==null||r.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${a(this,uu)}_`)}};uu=new WeakMap,Ef=new WeakMap,on=new WeakMap,hu=new WeakSet,mm=async function(e,t){a(this,on)||g(this,on,new Map);let s=a(this,on).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${a(this,uu)}_${bt(this,Ef)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(s.url=t,r=await wg(t,"blob")):t instanceof File?r=s.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const i=gS._isSVGFittingCanvas,o=new FileReader,l=new Image,c=new Promise((u,h)=>{l.onload=()=>{s.bitmap=l,s.isSvg=!0,u()},o.onload=async()=>{const d=s.svgUrl=o.result;l.src=await i?`${d}#svgView(preserveAspectRatio(none))`:d},l.onerror=o.onerror=h});o.readAsDataURL(r),await c}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){oe(r),s=null}return a(this,on).set(e,s),s&&a(this,on).set(s.id,s),s};let N0=gS;var ht,fo,kf,Ye;class AM{constructor(e=128){b(this,ht,[]);b(this,fo,!1);b(this,kf);b(this,Ye,-1);g(this,kf,e)}add({cmd:e,undo:t,post:s,mustExec:r,type:i=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(r&&e(),a(this,fo))return;const c={cmd:e,undo:t,post:s,type:i};if(a(this,Ye)===-1){a(this,ht).length>0&&(a(this,ht).length=0),g(this,Ye,0),a(this,ht).push(c);return}if(o&&a(this,ht)[a(this,Ye)].type===i){l&&(c.undo=a(this,ht)[a(this,Ye)].undo),a(this,ht)[a(this,Ye)]=c;return}const u=a(this,Ye)+1;u===a(this,kf)?a(this,ht).splice(0,1):(g(this,Ye,u),u<a(this,ht).length&&a(this,ht).splice(u)),a(this,ht).push(c)}undo(){if(a(this,Ye)===-1)return;g(this,fo,!0);const{undo:e,post:t}=a(this,ht)[a(this,Ye)];e(),t==null||t(),g(this,fo,!1),g(this,Ye,a(this,Ye)-1)}redo(){if(a(this,Ye)<a(this,ht).length-1){g(this,Ye,a(this,Ye)+1),g(this,fo,!0);const{cmd:e,post:t}=a(this,ht)[a(this,Ye)];e(),t==null||t(),g(this,fo,!1)}}hasSomethingToUndo(){return a(this,Ye)!==-1}hasSomethingToRedo(){return a(this,Ye)<a(this,ht).length-1}cleanType(e){if(a(this,Ye)!==-1){for(let t=a(this,Ye);t>=0;t--)if(a(this,ht)[t].type!==e){a(this,ht).splice(t+1,a(this,Ye)-t),g(this,Ye,t);return}a(this,ht).length=0,g(this,Ye,-1)}}destroy(){g(this,ht,null)}}ht=new WeakMap,fo=new WeakMap,kf=new WeakMap,Ye=new WeakMap;var My,Qx;class Sg{constructor(e){b(this,My);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Rt.platform;for(const[s,r,i={}]of e)for(const o of s){const l=o.startsWith("mac+");t&&l?(this.callbacks.set(o.slice(4),{callback:r,options:i}),this.allKeys.add(o.split("+").at(-1))):!t&&!l&&(this.callbacks.set(o,{callback:r,options:i}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(A(this,My,Qx).call(this,t));if(!s)return;const{callback:r,options:{bubbles:i=!1,args:o=[],checker:l=null}}=s;l&&!l(e,t)||(r.bind(e,...o,t)(),i||ut(t))}}My=new WeakSet,Qx=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Fy=class Fy{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return mM(e),ae(this,"_colors",e)}convert(e){const t=bg(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,r]of this._colors)if(r.every((i,o)=>i===t[o]))return Fy._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?V.makeHexColor(...t):e}};B(Fy,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let M0=Fy;var du,Hn,fu,st,kt,pu,Es,gu,ks,an,po,go,mu,mo,Sr,Cs,za,Cf,xf,yu,Tf,Ar,yo,vu,vo,Er,By,wo,wu,Pf,_o,Ha,_u,bo,Rf,mt,ke,oi,So,Ao,Of,bu,If,Eo,kr,ai,Lf,Df,xs,H,ym,F0,Zx,eT,fd,tT,nT,sT,B0,rT,iT,oT,aT,pn,Qr,lT,cT,j0,uT,pd,U0;const Xc=class Xc{constructor(e,t,s,r,i,o,l,c,u,h,d,f,p,y,v,S){b(this,H);b(this,du,new AbortController);b(this,Hn,null);b(this,fu,null);b(this,st,new Map);b(this,kt,new Map);b(this,pu,null);b(this,Es,null);b(this,gu,null);b(this,ks,new AM);b(this,an,null);b(this,po,null);b(this,go,null);b(this,mu,0);b(this,mo,new Set);b(this,Sr,null);b(this,Cs,null);b(this,za,new Set);B(this,"_editorUndoBar",null);b(this,Cf,!1);b(this,xf,!1);b(this,yu,!1);b(this,Tf,null);b(this,Ar,null);b(this,yo,null);b(this,vu,null);b(this,vo,!1);b(this,Er,null);b(this,By,new SM);b(this,wo,!1);b(this,wu,!1);b(this,Pf,!1);b(this,_o,null);b(this,Ha,null);b(this,_u,null);b(this,bo,null);b(this,Rf,null);b(this,mt,ce.NONE);b(this,ke,new Set);b(this,oi,null);b(this,So,null);b(this,Ao,null);b(this,Of,null);b(this,bu,null);b(this,If,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});b(this,Eo,[0,0]);b(this,kr,null);b(this,ai,null);b(this,Lf,null);b(this,Df,null);b(this,xs,null);const m=this._signal=a(this,du).signal;g(this,ai,e),g(this,Lf,t),g(this,Df,s),g(this,pu,r),g(this,an,i),g(this,So,o),g(this,bu,c),this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:m}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),l._on("setpreference",this.onSetPreference.bind(this),{signal:m}),l._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:m}),window.addEventListener("pointerdown",()=>{g(this,wu,!0)},{capture:!0,signal:m}),window.addEventListener("pointerup",()=>{g(this,wu,!1)},{capture:!0,signal:m}),A(this,H,tT).call(this),A(this,H,aT).call(this),A(this,H,B0).call(this),g(this,Es,c.annotationStorage),g(this,Tf,c.filterFactory),g(this,Ao,u),g(this,vu,h||null),g(this,Cf,d),g(this,xf,f),g(this,yu,p),g(this,Rf,y||null),this.viewParameters={realScale:pa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=S!==!1,i==null||i.setSidebarUiManager(this)}static get _keyboardManager(){const e=Xc.prototype,t=o=>a(o,ai).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},r=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return ae(this,"_keyboardManager",new Sg([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&a(o,ai).contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&a(o,ai).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,s,r,i,o,l,c,u;(e=a(this,xs))==null||e.resolve(),g(this,xs,null),(t=a(this,du))==null||t.abort(),g(this,du,null),this._signal=null;for(const h of a(this,kt).values())h.destroy();a(this,kt).clear(),a(this,st).clear(),a(this,za).clear(),(s=a(this,bo))==null||s.clear(),g(this,Hn,null),a(this,ke).clear(),a(this,ks).destroy(),(r=a(this,pu))==null||r.destroy(),(i=a(this,an))==null||i.destroy(),(o=a(this,So))==null||o.destroy(),(l=a(this,Er))==null||l.hide(),g(this,Er,null),(c=a(this,_u))==null||c.destroy(),g(this,_u,null),g(this,fu,null),a(this,Ar)&&(clearTimeout(a(this,Ar)),g(this,Ar,null)),a(this,kr)&&(clearTimeout(a(this,kr)),g(this,kr,null)),(u=this._editorUndoBar)==null||u.destroy(),g(this,bu,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return a(this,Rf)}get useNewAltTextFlow(){return a(this,xf)}get useNewAltTextWhenAddingImage(){return a(this,yu)}get hcmFilter(){return ae(this,"hcmFilter",a(this,Ao)?a(this,Tf).addHCMFilter(a(this,Ao).foreground,a(this,Ao).background):"none")}get direction(){return ae(this,"direction",getComputedStyle(a(this,ai)).direction)}get _highlightColors(){return ae(this,"_highlightColors",a(this,vu)?new Map(a(this,vu).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return ae(this,"highlightColors",null);const t=new Map,s=!!a(this,Ao);for(const[r,i]of e){const o=r.endsWith("_HCM");if(s&&o){t.set(r.replace("_HCM",""),i);continue}!s&&!o&&t.set(r,i)}return ae(this,"highlightColors",t)}get highlightColorNames(){return ae(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),g(this,go,e)}setMainHighlightColorPicker(e){g(this,_u,e)}editAltText(e,t=!1){var s;(s=a(this,pu))==null||s.editAltText(this,e,t)}hasCommentManager(){return!!a(this,an)}editComment(e,t,s,r){var i;(i=a(this,an))==null||i.showDialog(this,e,t,s,r)}selectComment(e,t){const s=a(this,kt).get(e),r=s==null?void 0:s.getEditorByUID(t);r==null||r.toggleComment(!0,!0)}updateComment(e){var t;(t=a(this,an))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=a(this,an))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=a(this,an))==null||t.removeComments([e.uid])}toggleComment(e,t,s=void 0){var r;(r=a(this,an))==null||r.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){var s;return e&&((s=a(this,an))==null?void 0:s.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=a(this,an))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(a(this,kt).has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),r=i=>{i.pageNumber===e&&(this._eventBus._off("editorsrendered",r),t())};this._eventBus.on("editorsrendered",r),await s}getSignature(e){var t;(t=a(this,So))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return a(this,So)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":g(this,yu,t);break}}onPageChanging({pageNumber:e}){g(this,mu,e-1)}focusMainContainer(){a(this,ai).focus()}findParent(e,t){for(const s of a(this,kt).values()){const{x:r,y:i,width:o,height:l}=s.div.getBoundingClientRect();if(e>=r&&e<=r+o&&t>=i&&t<=i+l)return s}return null}disableUserSelect(e=!1){a(this,Lf).classList.toggle("noUserSelect",e)}addShouldRescale(e){a(this,za).add(e)}removeShouldRescale(e){a(this,za).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*pa.PDF_TO_CSS_UNITS;for(const s of a(this,za))s.onScaleChanging();(t=a(this,go))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:l}=s,c=s.toString(),h=A(this,H,ym).call(this,s).closest(".textLayer"),d=this.getSelectionBoxes(h);if(!d)return;s.empty();const f=A(this,H,F0).call(this,h),p=a(this,mt)===ce.NONE,y=()=>{const v=f==null?void 0:f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:r,anchorOffset:i,focusNode:o,focusOffset:l,text:c});p&&this.showAllEditors("highlight",!0,!0),t&&(v==null||v.editComment())};if(p){this.switchToMode(ce.HIGHLIGHT,y);return}y()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!a(this,Es))return null;const t=`${gf}${e}`,s=a(this,Es).getRawValue(t);return s&&a(this,Es).remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&a(this,Es)&&!a(this,Es).has(e.id)&&a(this,Es).setValue(e.id,e)}a11yAlert(e,t=null){const s=a(this,Df);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,a(this,vo)&&(g(this,vo,!1),A(this,H,fd).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of a(this,ke))if(t.div.contains(e)){g(this,Ha,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!a(this,Ha))return;const[e,t]=a(this,Ha);g(this,Ha,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){A(this,H,B0).call(this),this.setEditingState(!0)}removeEditListeners(){A(this,H,rT).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of a(this,Cs))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of a(this,Cs))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=a(this,Hn))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of a(this,ke)){const i=r.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const o of a(this,Cs))if(o.isHandlingMimeForPasting(i.type)){o.paste(i,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){oe(`paste: "${i.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const i=[];for(const c of s){const u=await r.deserialize(c);if(!u)return;i.push(u)}const o=()=>{for(const c of i)A(this,H,j0).call(this,c);A(this,H,U0).call(this,i)},l=()=>{for(const c of i)c.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(i){oe(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),a(this,mt)!==ce.NONE&&!this.isEditorHandlingKeyboard&&Xc._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,a(this,vo)&&(g(this,vo,!1),A(this,H,fd).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(A(this,H,nT).call(this),A(this,H,iT).call(this),A(this,H,pn).call(this,{isEditing:a(this,mt)!==ce.NONE,isEmpty:A(this,H,pd).call(this),hasSomethingToUndo:a(this,ks).hasSomethingToUndo(),hasSomethingToRedo:a(this,ks).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,H,sT).call(this),A(this,H,oT).call(this),A(this,H,pn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!a(this,Cs)){g(this,Cs,e);for(const t of a(this,Cs))A(this,H,Qr).call(this,t.defaultPropertiesToUpdate)}}getId(){return a(this,By).id}get currentLayer(){return a(this,kt).get(a(this,mu))}getLayer(e){return a(this,kt).get(e)}get currentPageIndex(){return a(this,mu)}addLayer(e){a(this,kt).set(e.pageIndex,e),a(this,wo)?e.enable():e.disable()}removeLayer(e){a(this,kt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,r=!1,i=!1,o=!1){var l,c,u,h,d,f;if(a(this,mt)!==e&&!(a(this,xs)&&(await a(this,xs).promise,!a(this,xs)))){if(g(this,xs,Promise.withResolvers()),(l=a(this,go))==null||l.commitOrRemove(),a(this,mt)===ce.POPUP&&((c=a(this,an))==null||c.hideSidebar()),(u=a(this,an))==null||u.destroyPopup(),g(this,mt,e),e===ce.NONE){this.setEditingState(!1),A(this,H,cT).call(this);for(const p of a(this,st).values())p.hideStandaloneCommentButton();(h=this._editorUndoBar)==null||h.hide(),this.toggleComment(null),a(this,xs).resolve();return}for(const p of a(this,st).values())p.addStandaloneCommentButton();e===ce.SIGNATURE&&await((d=a(this,So))==null?void 0:d.loadSignatures()),s&&rn.clearPointerType(),this.setEditingState(!0),await A(this,H,lT).call(this),this.unselectAll();for(const p of a(this,kt).values())p.updateMode(e);if(e===ce.POPUP){a(this,fu)||g(this,fu,await a(this,bu).getAnnotationsByType(new Set(a(this,Cs).map(v=>v._editorType))));const p=new Set,y=[];for(const v of a(this,st).values()){const{annotationElementId:S,hasComment:m,deleted:w}=v;S&&p.add(S),m&&!w&&y.push(v.getData())}for(const v of a(this,fu)){const{id:S,popupRef:m,contentsObj:w}=v;m&&(w!=null&&w.str)&&!p.has(S)&&!a(this,mo).has(S)&&y.push(v)}(f=a(this,an))==null||f.showSidebar(y)}if(!t){r&&this.addNewEditorFromKeyboard(),a(this,xs).resolve();return}for(const p of a(this,st).values())p.uid===t?(this.setSelected(p),o?p.editComment():i?p.enterInEditMode():p.focus()):p.unselect();a(this,xs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==a(this,mt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(a(this,Cs)){switch(e){case ve.CREATE:this.currentLayer.addNewEditor(t);return;case ve.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(a(this,Of)||g(this,Of,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of a(this,ke))s.updateParams(e,t);else for(const s of a(this,Cs))s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var i;for(const o of a(this,st).values())o.editorType===e&&o.show(t);(((i=a(this,Of))==null?void 0:i.get(ve.HIGHLIGHT_SHOW_ALL))??!0)!==t&&A(this,H,Qr).call(this,[[ve.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(a(this,Pf)!==e){g(this,Pf,e);for(const t of a(this,kt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of a(this,st).values())t.pageIndex===e&&(yield t)}getEditor(e){return a(this,st).get(e)}addEditor(e){a(this,st).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(a(this,Ar)&&clearTimeout(a(this,Ar)),g(this,Ar,setTimeout(()=>{this.focusMainContainer(),g(this,Ar,null)},0))),a(this,st).delete(e.id),e.annotationElementId&&((t=a(this,bo))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!a(this,mo).has(e.annotationElementId))&&((s=a(this,Es))==null||s.remove(e.id))}addDeletedAnnotationElement(e){a(this,mo).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return a(this,mo).has(e)}removeDeletedAnnotationElement(e){a(this,mo).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){a(this,Hn)!==e&&(g(this,Hn,e),e&&A(this,H,Qr).call(this,e.propertiesToUpdate))}updateUI(e){a(this,H,uT)===e&&A(this,H,Qr).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){A(this,H,Qr).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(a(this,ke).has(e)){a(this,ke).delete(e),e.unselect(),A(this,H,pn).call(this,{hasSelectedEditor:this.hasSelection});return}a(this,ke).add(e),e.select(),A(this,H,Qr).call(this,e.propertiesToUpdate),A(this,H,pn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=a(this,go))==null||t.commitOrRemove();for(const s of a(this,ke))s!==e&&s.unselect();a(this,ke).clear(),a(this,ke).add(e),e.select(),A(this,H,Qr).call(this,e.propertiesToUpdate),A(this,H,pn).call(this,{hasSelectedEditor:!0})}isSelected(e){return a(this,ke).has(e)}get firstSelectedEditor(){return a(this,ke).values().next().value}unselect(e){e.unselect(),a(this,ke).delete(e),A(this,H,pn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return a(this,ke).size!==0}get isEnterHandled(){return a(this,ke).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;a(this,ks).undo(),A(this,H,pn).call(this,{hasSomethingToUndo:a(this,ks).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,H,pd).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){a(this,ks).redo(),A(this,H,pn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:a(this,ks).hasSomethingToRedo(),isEmpty:A(this,H,pd).call(this)})}addCommands(e){a(this,ks).add(e),A(this,H,pn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,H,pd).call(this)})}cleanUndoStack(e){a(this,ks).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...a(this,ke)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(r,t.length===1?t[0].editorType:t.length);for(const l of t)l.remove()},r=()=>{for(const o of t)A(this,H,j0).call(this,o)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){var e;(e=a(this,Hn))==null||e.commitOrRemove()}hasSomethingToControl(){return a(this,Hn)||this.hasSelection}selectAll(){for(const e of a(this,ke))e.commit();A(this,H,U0).call(this,a(this,st).values())}unselectAll(){var e;if(!(a(this,Hn)&&(a(this,Hn).commitOrRemove(),a(this,mt)!==ce.NONE))&&!((e=a(this,go))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of a(this,ke))t.unselect();a(this,ke).clear(),A(this,H,pn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;a(this,Eo)[0]+=e,a(this,Eo)[1]+=t;const[r,i]=a(this,Eo),o=[...a(this,ke)],l=1e3;a(this,kr)&&clearTimeout(a(this,kr)),g(this,kr,setTimeout(()=>{g(this,kr,null),a(this,Eo)[0]=a(this,Eo)[1]=0,this.addCommands({cmd:()=>{for(const c of o)a(this,st).has(c.id)&&(c.translateInPage(r,i),c.translationDone())},undo:()=>{for(const c of o)a(this,st).has(c.id)&&(c.translateInPage(-r,-i),c.translationDone())},mustExec:!1})},l));for(const c of o)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),g(this,Sr,new Map);for(const e of a(this,ke))a(this,Sr).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!a(this,Sr))return!1;this.disableUserSelect(!1);const e=a(this,Sr);g(this,Sr,null);let t=!1;for(const[{x:r,y:i,pageIndex:o},l]of e)l.newX=r,l.newY=i,l.newPageIndex=o,t||(t=r!==l.savedX||i!==l.savedY||o!==l.savedPageIndex);if(!t)return!1;const s=(r,i,o,l)=>{if(a(this,st).has(r.id)){const c=a(this,kt).get(l);c?r._setParentAndPosition(c,i,o):(r.pageIndex=l,r.x=i,r.y=o)}};return this.addCommands({cmd:()=>{for(const[r,{newX:i,newY:o,newPageIndex:l}]of e)s(r,i,o,l)},undo:()=>{for(const[r,{savedX:i,savedY:o,savedPageIndex:l}]of e)s(r,i,o,l)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(a(this,Sr))for(const s of a(this,Sr).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||a(this,ke).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return a(this,Hn)===e}getActive(){return a(this,Hn)}getMode(){return a(this,mt)}isEditingMode(){return a(this,mt)!==ce.NONE}get imageManager(){return ae(this,"imageManager",new N0)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:r,width:i,height:o}=e.getBoundingClientRect();let l;switch(e.getAttribute("data-main-rotation")){case"90":l=(u,h,d,f)=>({x:(h-r)/o,y:1-(u+d-s)/i,width:f/o,height:d/i});break;case"180":l=(u,h,d,f)=>({x:1-(u+d-s)/i,y:1-(h+f-r)/o,width:d/i,height:f/o});break;case"270":l=(u,h,d,f)=>({x:1-(h+f-r)/o,y:(u-s)/i,width:f/o,height:d/i});break;default:l=(u,h,d,f)=>({x:(u-s)/i,y:(h-r)/o,width:d/i,height:f/o});break}const c=[];for(let u=0,h=t.rangeCount;u<h;u++){const d=t.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:p,width:y,height:v}of d.getClientRects())y===0||v===0||c.push(l(f,p,y,v))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(a(this,gu)||g(this,gu,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=a(this,gu))==null||t.delete(e)}renderAnnotationElement(e){var r;const t=(r=a(this,gu))==null?void 0:r.get(e.data.id);if(!t)return;const s=a(this,Es).getRawValue(t);s&&(a(this,mt)===ce.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var i;const r=(i=a(this,bo))==null?void 0:i.get(e);r&&(r.setCanvas(t,s),a(this,bo).delete(e))}addMissingCanvas(e,t){(a(this,bo)||g(this,bo,new Map)).set(e,t)}};du=new WeakMap,Hn=new WeakMap,fu=new WeakMap,st=new WeakMap,kt=new WeakMap,pu=new WeakMap,Es=new WeakMap,gu=new WeakMap,ks=new WeakMap,an=new WeakMap,po=new WeakMap,go=new WeakMap,mu=new WeakMap,mo=new WeakMap,Sr=new WeakMap,Cs=new WeakMap,za=new WeakMap,Cf=new WeakMap,xf=new WeakMap,yu=new WeakMap,Tf=new WeakMap,Ar=new WeakMap,yo=new WeakMap,vu=new WeakMap,vo=new WeakMap,Er=new WeakMap,By=new WeakMap,wo=new WeakMap,wu=new WeakMap,Pf=new WeakMap,_o=new WeakMap,Ha=new WeakMap,_u=new WeakMap,bo=new WeakMap,Rf=new WeakMap,mt=new WeakMap,ke=new WeakMap,oi=new WeakMap,So=new WeakMap,Ao=new WeakMap,Of=new WeakMap,bu=new WeakMap,If=new WeakMap,Eo=new WeakMap,kr=new WeakMap,ai=new WeakMap,Lf=new WeakMap,Df=new WeakMap,xs=new WeakMap,H=new WeakSet,ym=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},F0=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of a(this,kt).values())if(s.hasTextLayer(e))return s;return null},Zx=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=A(this,H,ym).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(a(this,Er)||g(this,Er,new bM(this)),a(this,Er).show(s,r,this.direction==="ltr"))},eT=function(){var i,o,l;const e=document.getSelection();if(!e||e.isCollapsed){a(this,oi)&&((i=a(this,Er))==null||i.hide(),g(this,oi,null),A(this,H,pn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===a(this,oi))return;const r=A(this,H,ym).call(this,e).closest(".textLayer");if(!r){a(this,oi)&&((o=a(this,Er))==null||o.hide(),g(this,oi,null),A(this,H,pn).call(this,{hasSelectedText:!1}));return}if((l=a(this,Er))==null||l.hide(),g(this,oi,t),A(this,H,pn).call(this,{hasSelectedText:!0}),!(a(this,mt)!==ce.HIGHLIGHT&&a(this,mt)!==ce.NONE)&&(a(this,mt)===ce.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),g(this,vo,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=a(this,mt)===ce.HIGHLIGHT?A(this,H,F0).call(this,r):null;if(c==null||c.toggleDrawing(),a(this,wu)){const u=new AbortController,h=this.combinedSignal(u),d=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&A(this,H,fd).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}else c==null||c.toggleDrawing(!0),A(this,H,fd).call(this,"main_toolbar")}},fd=function(e=""){a(this,mt)===ce.HIGHLIGHT?this.highlightSelection(e):a(this,Cf)&&A(this,H,Zx).call(this)},tT=function(){document.addEventListener("selectionchange",A(this,H,eT).bind(this),{signal:this._signal})},nT=function(){if(a(this,yo))return;g(this,yo,new AbortController);const e=this.combinedSignal(a(this,yo));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},sT=function(){var e;(e=a(this,yo))==null||e.abort(),g(this,yo,null)},B0=function(){if(a(this,_o))return;g(this,_o,new AbortController);const e=this.combinedSignal(a(this,_o));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},rT=function(){var e;(e=a(this,_o))==null||e.abort(),g(this,_o,null)},iT=function(){if(a(this,po))return;g(this,po,new AbortController);const e=this.combinedSignal(a(this,po));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},oT=function(){var e;(e=a(this,po))==null||e.abort(),g(this,po,null)},aT=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},pn=function(e){Object.entries(e).some(([s,r])=>a(this,If)[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(a(this,If),e)}),a(this,mt)===ce.HIGHLIGHT&&e.hasSelectedEditor===!1&&A(this,H,Qr).call(this,[[ve.HIGHLIGHT_FREE,!0]]))},Qr=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},lT=async function(){if(!a(this,wo)){g(this,wo,!0);const e=[];for(const t of a(this,kt).values())e.push(t.enable());await Promise.all(e);for(const t of a(this,st).values())t.enable()}},cT=function(){if(this.unselectAll(),a(this,wo)){g(this,wo,!1);for(const e of a(this,kt).values())e.disable();for(const e of a(this,st).values())e.disable()}},j0=function(e){const t=a(this,kt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},uT=function(){let e=null;for(e of a(this,ke));return e},pd=function(){if(a(this,st).size===0)return!0;if(a(this,st).size===1)for(const e of a(this,st).values())return e.isEmpty();return!1},U0=function(e){for(const t of a(this,ke))t.unselect();a(this,ke).clear();for(const t of e)t.isEmpty()||(a(this,ke).add(t),t.select());A(this,H,pn).call(this,{hasSelectedEditor:this.hasSelection})},B(Xc,"TRANSLATE_SMALL",1),B(Xc,"TRANSLATE_BIG",10);let lc=Xc;var It,Cr,Ys,Su,xr,Vn,Au,Tr,Pn,li,Va,Pr,ko,hr,gd,vm;const gn=class gn{constructor(e){b(this,hr);b(this,It,null);b(this,Cr,!1);b(this,Ys,null);b(this,Su,null);b(this,xr,null);b(this,Vn,null);b(this,Au,!1);b(this,Tr,null);b(this,Pn,null);b(this,li,null);b(this,Va,null);b(this,Pr,!1);g(this,Pn,e),g(this,Pr,e._uiManager.useNewAltTextFlow),a(gn,ko)||g(gn,ko,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){gn._l10n??(gn._l10n=e)}async render(){const e=g(this,Ys,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=g(this,Su,document.createElement("span"));e.append(t),a(this,Pr)?(e.classList.add("new"),e.setAttribute("data-l10n-id",a(gn,ko).missing),t.setAttribute("data-l10n-id",a(gn,ko)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=a(this,Pn)._uiManager._signal;e.addEventListener("contextmenu",zs,{signal:s}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const r=i=>{i.preventDefault(),a(this,Pn)._uiManager.editAltText(a(this,Pn)),a(this,Pr)&&a(this,Pn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:a(this,hr,gd)}})};return e.addEventListener("click",r,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(g(this,Au,!0),r(i))},{signal:s}),await A(this,hr,vm).call(this),e}finish(){a(this,Ys)&&(a(this,Ys).focus({focusVisible:a(this,Au)}),g(this,Au,!1))}isEmpty(){return a(this,Pr)?a(this,It)===null:!a(this,It)&&!a(this,Cr)}hasData(){return a(this,Pr)?a(this,It)!==null||!!a(this,li):this.isEmpty()}get guessedText(){return a(this,li)}async setGuessedText(e){a(this,It)===null&&(g(this,li,e),g(this,Va,await gn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),A(this,hr,vm).call(this))}toggleAltTextBadge(e=!1){var t;if(!a(this,Pr)||a(this,It)){(t=a(this,Tr))==null||t.remove(),g(this,Tr,null);return}if(!a(this,Tr)){const s=g(this,Tr,document.createElement("div"));s.className="noAltTextBadge",a(this,Pn).div.append(s)}a(this,Tr).classList.toggle("hidden",!e)}serialize(e){let t=a(this,It);return!e&&a(this,li)===t&&(t=a(this,Va)),{altText:t,decorative:a(this,Cr),guessedText:a(this,li),textWithDisclaimer:a(this,Va)}}get data(){return{altText:a(this,It),decorative:a(this,Cr)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:r,cancel:i=!1}){s&&(g(this,li,s),g(this,Va,r)),!(a(this,It)===e&&a(this,Cr)===t)&&(i||(g(this,It,e),g(this,Cr,t)),A(this,hr,vm).call(this))}toggle(e=!1){a(this,Ys)&&(!e&&a(this,Vn)&&(clearTimeout(a(this,Vn)),g(this,Vn,null)),a(this,Ys).disabled=!e)}shown(){a(this,Pn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:a(this,hr,gd)}})}destroy(){var e,t;(e=a(this,Ys))==null||e.remove(),g(this,Ys,null),g(this,Su,null),g(this,xr,null),(t=a(this,Tr))==null||t.remove(),g(this,Tr,null)}};It=new WeakMap,Cr=new WeakMap,Ys=new WeakMap,Su=new WeakMap,xr=new WeakMap,Vn=new WeakMap,Au=new WeakMap,Tr=new WeakMap,Pn=new WeakMap,li=new WeakMap,Va=new WeakMap,Pr=new WeakMap,ko=new WeakMap,hr=new WeakSet,gd=function(){return a(this,It)&&"added"||a(this,It)===null&&this.guessedText&&"review"||"missing"},vm=async function(){var r,i,o;const e=a(this,Ys);if(!e)return;if(a(this,Pr)){if(e.classList.toggle("done",!!a(this,It)),e.setAttribute("data-l10n-id",a(gn,ko)[a(this,hr,gd)]),(r=a(this,Su))==null||r.setAttribute("data-l10n-id",a(gn,ko)[`${a(this,hr,gd)}-label`]),!a(this,It)){(i=a(this,xr))==null||i.remove();return}}else{if(!a(this,It)&&!a(this,Cr)){e.classList.remove("done"),(o=a(this,xr))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=a(this,xr);if(!t){g(this,xr,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${a(this,Pn).id}`;const l=100,c=a(this,Pn)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(a(this,Vn)),g(this,Vn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{g(this,Vn,setTimeout(()=>{g(this,Vn,null),a(this,xr).classList.add("show"),a(this,Pn)._reportTelemetry({action:"alt_text_tooltip"})},l))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;a(this,Vn)&&(clearTimeout(a(this,Vn)),g(this,Vn,null)),(u=a(this,xr))==null||u.classList.remove("show")},{signal:c})}a(this,Cr)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=a(this,It)),t.parentNode||e.append(t);const s=a(this,Pn).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},b(gn,ko,null),B(gn,"_l10n",null);let Ay=gn;var Vt,Ts,Wa,Ue,Nf,Ga,Js,qa,Ka,Xa,Mf,$0;class qg{constructor(e){b(this,Mf);b(this,Vt,null);b(this,Ts,null);b(this,Wa,!1);b(this,Ue,null);b(this,Nf,null);b(this,Ga,null);b(this,Js,null);b(this,qa,null);b(this,Ka,!1);b(this,Xa,null);g(this,Ue,e)}renderForToolbar(){const e=g(this,Ts,document.createElement("button"));return e.className="comment",A(this,Mf,$0).call(this,e,!1)}renderForStandalone(){const e=g(this,Vt,document.createElement("button"));e.className="annotationCommentButton";const t=a(this,Ue).commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(a(this,Ue)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const r=a(this,Ue).commentButtonColor;r&&(s.backgroundColor=r)}return A(this,Mf,$0).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=a(this,Vt)??a(this,Ts))==null||e.focus()},0)}onUpdatedColor(){if(!a(this,Vt))return;const e=a(this,Ue).commentButtonColor;e&&(a(this,Vt).style.backgroundColor=e),a(this,Ue)._uiManager.updatePopupColor(a(this,Ue))}get commentButtonWidth(){var e;return(((e=a(this,Vt))==null?void 0:e.getBoundingClientRect().width)??0)/a(this,Ue).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(a(this,Xa))return a(this,Xa);if(!a(this,Vt))return null;const{x:e,y:t,height:s}=a(this,Vt).getBoundingClientRect(),{x:r,y:i,width:o,height:l}=a(this,Ue).parent.boundingClientRect;return[(e-r)/o,(t+s-i)/l]}set commentPopupPositionInLayer(e){g(this,Xa,e)}hasDefaultPopupPosition(){return a(this,Xa)===null}removeStandaloneCommentButton(){var e;(e=a(this,Vt))==null||e.remove(),g(this,Vt,null)}removeToolbarCommentButton(){var e;(e=a(this,Ts))==null||e.remove(),g(this,Ts,null)}setCommentButtonStates({selected:e,hasPopup:t}){a(this,Vt)&&(a(this,Vt).classList.toggle("selected",e),a(this,Vt).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let s,r;if(t)[s,r]=t;else{[s,r]=a(this,Ue).commentButtonPosition;const{width:h,height:d,x:f,y:p}=a(this,Ue);s=f+s*h,r=p+r*d}const i=a(this,Ue).parent.boundingClientRect,{x:o,y:l,width:c,height:u}=i;a(this,Ue)._uiManager.editComment(a(this,Ue),o+s*c,l+r*u,{...e,parentDimensions:i})}finish(){a(this,Ts)&&(a(this,Ts).focus({focusVisible:a(this,Wa)}),g(this,Wa,!1))}isDeleted(){return a(this,Ka)||a(this,Js)===""}isEmpty(){return a(this,Js)===null}hasBeenEdited(){return this.isDeleted()||a(this,Js)!==a(this,Nf)}serialize(){return this.data}get data(){return{text:a(this,Js),richText:a(this,Ga),date:a(this,qa),deleted:this.isDeleted()}}set data(e){if(e!==a(this,Js)&&g(this,Ga,null),e===null){g(this,Js,""),g(this,Ka,!0);return}g(this,Js,e),g(this,qa,new Date),g(this,Ka,!1)}setInitialText(e,t=null){g(this,Nf,e),this.data=e,g(this,qa,null),g(this,Ga,t)}shown(){}destroy(){var e,t;(e=a(this,Ts))==null||e.remove(),g(this,Ts,null),(t=a(this,Vt))==null||t.remove(),g(this,Vt,null),g(this,Js,""),g(this,Ga,null),g(this,qa,null),g(this,Ue,null),g(this,Wa,!1),g(this,Ka,!1)}}Vt=new WeakMap,Ts=new WeakMap,Wa=new WeakMap,Ue=new WeakMap,Nf=new WeakMap,Ga=new WeakMap,Js=new WeakMap,qa=new WeakMap,Ka=new WeakMap,Xa=new WeakMap,Mf=new WeakSet,$0=function(e,t){if(!a(this,Ue)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[a(this,Ue)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=a(this,Ue)._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",zs,{signal:s}),t&&(e.addEventListener("focusin",i=>{a(this,Ue)._focusEventsAllowed=!1,ut(i)},{capture:!0,signal:s}),e.addEventListener("focusout",i=>{a(this,Ue)._focusEventsAllowed=!0,ut(i)},{capture:!0,signal:s})),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const r=i=>{i.preventDefault(),e===a(this,Ts)?this.edit():a(this,Ue).toggleComment(!0)};return e.addEventListener("click",r,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(g(this,Wa,!0),r(i))},{signal:s}),e.addEventListener("pointerenter",()=>{a(this,Ue).toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{a(this,Ue).toggleComment(!1,!1)},{signal:s}),e};var Eu,Ya,Ff,Bf,jf,Uf,$f,ci,Ja,ui,Qa,hi,ga,hT,dT,fT;const mS=class mS{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:i=null,onPinchEnd:o=null,signal:l}){b(this,ga);b(this,Eu);b(this,Ya,!1);b(this,Ff,null);b(this,Bf);b(this,jf);b(this,Uf);b(this,$f);b(this,ci,null);b(this,Ja);b(this,ui,null);b(this,Qa);b(this,hi,null);g(this,Eu,e),g(this,Ff,s),g(this,Bf,t),g(this,jf,r),g(this,Uf,i),g(this,$f,o),g(this,Qa,new AbortController),g(this,Ja,AbortSignal.any([l,a(this,Qa).signal])),e.addEventListener("touchstart",A(this,ga,hT).bind(this),{passive:!1,signal:a(this,Ja)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Xr.pixelRatio}destroy(){var e,t;(e=a(this,Qa))==null||e.abort(),g(this,Qa,null),(t=a(this,ci))==null||t.abort(),g(this,ci,null)}};Eu=new WeakMap,Ya=new WeakMap,Ff=new WeakMap,Bf=new WeakMap,jf=new WeakMap,Uf=new WeakMap,$f=new WeakMap,ci=new WeakMap,Ja=new WeakMap,ui=new WeakMap,Qa=new WeakMap,hi=new WeakMap,ga=new WeakSet,hT=function(e){var r,i,o;if((r=a(this,Bf))!=null&&r.call(this))return;if(e.touches.length===1){if(a(this,ci))return;const l=g(this,ci,new AbortController),c=AbortSignal.any([a(this,Ja),l.signal]),u=a(this,Eu),h={capture:!0,signal:c,passive:!1},d=f=>{var p;f.pointerType==="touch"&&((p=a(this,ci))==null||p.abort(),g(this,ci,null))};u.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ut(f),d(f))},h),u.addEventListener("pointerup",d,h),u.addEventListener("pointercancel",d,h);return}if(!a(this,hi)){g(this,hi,new AbortController);const l=AbortSignal.any([a(this,Ja),a(this,hi).signal]),c=a(this,Eu),u={signal:l,capture:!1,passive:!1};c.addEventListener("touchmove",A(this,ga,dT).bind(this),u);const h=A(this,ga,fT).bind(this);c.addEventListener("touchend",h,u),c.addEventListener("touchcancel",h,u),u.capture=!0,c.addEventListener("pointerdown",ut,u),c.addEventListener("pointermove",ut,u),c.addEventListener("pointercancel",ut,u),c.addEventListener("pointerup",ut,u),(i=a(this,jf))==null||i.call(this)}if(ut(e),e.touches.length!==2||(o=a(this,Ff))!=null&&o.call(this)){g(this,ui,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),g(this,ui,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},dT=function(e){var E;if(!a(this,ui)||e.touches.length!==2)return;ut(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:r,screenY:i}=t,{screenX:o,screenY:l}=s,c=a(this,ui),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,p=d-u,y=f-h,v=o-r,S=l-i,m=Math.hypot(v,S)||1,w=Math.hypot(p,y)||1;if(!a(this,Ya)&&Math.abs(w-m)<=mS.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=r,c.touch0Y=i,c.touch1X=o,c.touch1Y=l,!a(this,Ya)){g(this,Ya,!0);return}const _=[(r+o)/2,(i+l)/2];(E=a(this,Uf))==null||E.call(this,_,w,m)},fT=function(e){var t;e.touches.length>=2||(a(this,hi)&&(a(this,hi).abort(),g(this,hi,null),(t=a(this,$f))==null||t.call(this)),a(this,ui)&&(ut(e),g(this,ui,null),g(this,Ya,!1)))};let Ey=mS;var Za,Qs,qe,De,di,ku,Co,zf,Wt,el,fi,Ps,xo,Hf,tl,Wn,Vf,nl,pi,Rr,Cu,xu,Rs,sl,Wf,jy,Z,z0,Gf,H0,wm,pT,gT,V0,_m,W0,mT,yT,vT,G0,wT,q0,_T,bT,ST,K0,md;const le=class le{constructor(e){b(this,Z);b(this,Za,null);b(this,Qs,null);b(this,qe,null);b(this,De,null);b(this,di,null);b(this,ku,!1);b(this,Co,null);b(this,zf,"");b(this,Wt,null);b(this,el,null);b(this,fi,null);b(this,Ps,null);b(this,xo,null);b(this,Hf,"");b(this,tl,!1);b(this,Wn,null);b(this,Vf,!1);b(this,nl,!1);b(this,pi,!1);b(this,Rr,null);b(this,Cu,0);b(this,xu,0);b(this,Rs,null);b(this,sl,null);B(this,"isSelected",!1);B(this,"_isCopy",!1);B(this,"_editToolbar",null);B(this,"_initialOptions",Object.create(null));B(this,"_initialData",null);B(this,"_isVisible",!0);B(this,"_uiManager",null);B(this,"_focusEventsAllowed",!0);b(this,Wf,!1);b(this,jy,le._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:s,pageHeight:r,pageX:i,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[i,o];const[l,c]=this.parentDimensions;this.x=e.x/l,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=le.prototype._resizeWithKeyboard,t=lc.TRANSLATE_SMALL,s=lc.TRANSLATE_BIG;return ae(this,"_resizerKeyboardManager",new Sg([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],le.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ae(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new EM({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(le._l10n??(le._l10n=e),le._l10nResizer||(le._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),le._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);le._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Fe("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return a(this,Wf)}set _isDraggable(e){var t;g(this,Wf,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=a(this,jy)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(A(this,Z,md).call(this),(t=a(this,Ps))==null||t.remove(),g(this,Ps,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(a(this,tl)?g(this,tl,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,r){const[i,o]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(e+s)/i,this.y=(t+r)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,r]=this.parentDimensions;this.setAt(e*s,t*r,this.width*s,this.height*r),this._onTranslated()}translate(e,t){A(this,Z,z0).call(this,this.parentDimensions,e,t)}translateInPage(e,t){a(this,Wn)||g(this,Wn,[this.x,this.y,this.width,this.height]),A(this,Z,z0).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){a(this,Wn)||g(this,Wn,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[r,i]}=this;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:l}=this;const[c,u]=this.getBaseTranslation();o+=c,l+=u;const{style:h}=s;h.left=`${(100*o).toFixed(2)}%`,h.top=`${(100*l).toFixed(2)}%`,this._onTranslating(o,l),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!a(this,Wn)&&(a(this,Wn)[0]!==this.x||a(this,Wn)[1]!==this.y)}get _hasBeenResized(){return!!a(this,Wn)&&(a(this,Wn)[2]!==this.width||a(this,Wn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=le,r=s/e,i=s/t;switch(this.rotation){case 90:return[-r,i];case 180:return[r,i];case 270:return[r,-i];default:return[-r,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,r]}=this;let{x:i,y:o,width:l,height:c}=this;if(l*=s,c*=r,i*=s,o*=r,this._mustFixPosition)switch(e){case 0:i=_n(i,0,s-l),o=_n(o,0,r-c);break;case 90:i=_n(i,0,s-c),o=_n(o,l,r);break;case 180:i=_n(i,l,s),o=_n(o,c,r);break;case 270:i=_n(i,c,s),o=_n(o,0,r-l);break}this.x=i/=s,this.y=o/=r;const[u,h]=this.getBaseTranslation();i+=u,o+=h,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return A(s=le,Gf,H0).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return A(s=le,Gf,H0).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=a(this,qe))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||a(this,nl))return this._editToolbar;this._editToolbar=new L0(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=a(this,qe))==null||t.destroy()}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return a(this,qe)||(Ay.initialize(le._l10n),g(this,qe,new Ay(this)),a(this,Za)&&(a(this,qe).data=a(this,Za),g(this,Za,null))),a(this,qe)}get altTextData(){var e;return(e=a(this,qe))==null?void 0:e.data}set altTextData(e){a(this,qe)&&(a(this,qe).data=e)}get guessedAltText(){var e;return(e=a(this,qe))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=a(this,qe))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=a(this,qe))==null?void 0:t.serialize(e)}hasAltText(){return!!a(this,qe)&&!a(this,qe).isEmpty()}hasAltTextData(){var e;return((e=a(this,qe))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=a(this,De))==null||e.focusButton()}addCommentButton(){return this.canAddComment?a(this,De)||g(this,De,new qg(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(a(this,di)){this._uiManager.isEditingMode()&&a(this,di).classList.remove("hidden");return}this.hasComment&&(g(this,di,a(this,De).renderForStandalone()),this.div.append(a(this,di)))}}removeStandaloneCommentButton(){a(this,De).removeStandaloneCommentButton(),g(this,di,null)}hideStandaloneCommentButton(){var e;(e=a(this,di))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:s,deleted:r}}=a(this,De);return{text:t,richText:e,date:s,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){a(this,De)||g(this,De,new qg(this)),a(this,De).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(a(this,De)||g(this,De,new qg(this)),a(this,De).setInitialText(e,s),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){var e;return(e=a(this,De))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=a(this,De))==null?void 0:e.isDeleted()}get hasComment(){return!!a(this,De)&&!a(this,De).isEmpty()&&!a(this,De).isDeleted()}async editComment(e){a(this,De)||g(this,De,new qg(this)),a(this,De).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){a(this,De).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,r]=e.rect,[i]=this.pageDimensions,[o]=this.pageTranslation,l=o+i+1,c=r-100,u=l+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,c,u,r]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){a(this,De).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=a(this,ku)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),A(this,Z,q0).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[r,i]=this.getInitialTranslation();return this.translate(r,i),Jx(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(a(this,sl)||g(this,sl,new Ey({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,Z,mT).bind(this),onPinching:A(this,Z,yT).bind(this),onPinchEnd:A(this,Z,vT).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=Rt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(g(this,tl,!0),this._isDraggable){A(this,Z,wT).call(this,e);return}A(this,Z,G0).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){a(this,Rr)&&clearTimeout(a(this,Rr)),g(this,Rr,setTimeout(()=>{var e;g(this,Rr,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const r=this.parentScale,[i,o]=this.pageDimensions,[l,c]=this.pageTranslation,u=e/r,h=t/r,d=this.x*i,f=this.y*o,p=this.width*i,y=this.height*o;switch(s){case 0:return[d+u+l,o-f-h-y+c,d+u+p+l,o-f-h+c];case 90:return[d+h+l,o-f+u+c,d+h+y+l,o-f+u+p+c];case 180:return[d-u-p+l,o-f+h+c,d-u+l,o-f+h+y+c];case 270:return[d-h-y+l,o-f-u-p+c,d-h+l,o-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,r,i,o]=e,l=i-s,c=o-r;switch(this.rotation){case 0:return[s,t-o,l,c];case 90:return[s,t-r,c,l];case 180:return[i,t-r,l,c];case 270:return[i,t-o,c,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&le._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=a(this,De))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:r,deleted:i,richText:o},uid:l,pageIndex:c,creationDate:u,modificationDate:h}=this;return{id:l,pageIndex:c,rect:this.getPDFRect(),richText:o,contentsObj:{str:e},creationDate:u,modificationDate:s||h,popupRef:!i,color:t,opacity:r}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),g(this,nl,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),g(this,nl,!1),!0):!1}isInEditMode(){return a(this,nl)}shouldGetKeyboardEvents(){return a(this,pi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:i,innerWidth:o}=window;return t<o&&r>0&&e<i&&s>0}rebuild(){A(this,Z,q0).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var s;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((s=this._initialData)==null?void 0:s.popupRef)||""}}static async deserialize(e,t,s){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});r.rotation=e.rotation,g(r,Za,e.accessibilityData),r._isCopy=e.isCopy||!1;const[i,o]=r.pageDimensions,[l,c,u,h]=r.getRectInCurrentCoords(e.rect,o);return r.x=l/i,r.y=c/o,r.width=u/i,r.height=h/o,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,s;if((e=a(this,xo))==null||e.abort(),g(this,xo,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),a(this,Rr)&&(clearTimeout(a(this,Rr)),g(this,Rr,null)),A(this,Z,md).call(this),this.removeEditToolbar(),a(this,Rs)){for(const r of a(this,Rs).values())clearTimeout(r);g(this,Rs,null)}this.parent=null,(t=a(this,sl))==null||t.destroy(),g(this,sl,null),(s=a(this,Ps))==null||s.remove(),g(this,Ps,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,Z,pT).call(this),a(this,Wt).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,r,i,o]=this.getPDFRect();return[le._round(s+(i-s)*e),le._round(r+(o-r)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return a(this,De).commentPopupPositionInLayer}set commentPopupPosition(e){a(this,De).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return a(this,De).hasDefaultPopupPosition()}get commentButtonWidth(){return a(this,De).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=a(this,De))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),g(this,fi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=a(this,Wt).children;if(!a(this,Qs)){g(this,Qs,Array.from(t));const o=A(this,Z,_T).bind(this),l=A(this,Z,bT).bind(this),c=this._uiManager._signal;for(const u of a(this,Qs)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:c}),u.addEventListener("blur",l,{signal:c}),u.addEventListener("focus",A(this,Z,ST).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",le._l10nResizer[h])}}const s=a(this,Qs)[0];let r=0;for(const o of t){if(o===s)break;r++}const i=(360-this.rotation+this.parentRotation)%360/90*(a(this,Qs).length/4);if(i!==r){if(i<r)for(let l=0;l<r-i;l++)a(this,Wt).append(a(this,Wt).firstElementChild);else if(i>r)for(let l=0;l<i-r;l++)a(this,Wt).firstElementChild.before(a(this,Wt).lastElementChild);let o=0;for(const l of t){const u=a(this,Qs)[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",le._l10nResizer[u])}}A(this,Z,K0).call(this,0),g(this,pi,!0),a(this,Wt).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){a(this,pi)&&A(this,Z,W0).call(this,a(this,Hf),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,Z,md).call(this),this.div.focus()}select(){var e,t,s;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,i;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(s=a(this,qe))==null||s.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,s,r,i;this.isSelected&&(this.isSelected=!1,(e=a(this,Wt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(i=a(this,qe))==null||i.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return a(this,Vf)}set isEditing(e){g(this,Vf,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){a(this,Rs)||g(this,Rs,new Map);const{action:s}=e;let r=a(this,Rs).get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),a(this,Rs).delete(s),a(this,Rs).size===0&&g(this,Rs,null)},le._telemetryTimeout),a(this,Rs).set(s,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),g(this,ku,!1)}disable(){this.div&&(this.div.tabIndex=-1),g(this,ku,!0)}updateFakeAnnotationElement(e){if(!a(this,Ps)&&!this.deleted){g(this,Ps,e.addFakeAnnotation(this));return}if(this.deleted){a(this,Ps).remove(),g(this,Ps,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&a(this,Ps).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Za=new WeakMap,Qs=new WeakMap,qe=new WeakMap,De=new WeakMap,di=new WeakMap,ku=new WeakMap,Co=new WeakMap,zf=new WeakMap,Wt=new WeakMap,el=new WeakMap,fi=new WeakMap,Ps=new WeakMap,xo=new WeakMap,Hf=new WeakMap,tl=new WeakMap,Wn=new WeakMap,Vf=new WeakMap,nl=new WeakMap,pi=new WeakMap,Rr=new WeakMap,Cu=new WeakMap,xu=new WeakMap,Rs=new WeakMap,sl=new WeakMap,Wf=new WeakMap,jy=new WeakMap,Z=new WeakSet,z0=function([e,t],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Gf=new WeakSet,H0=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},wm=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},pT=function(){if(a(this,Wt))return;g(this,Wt,document.createElement("div")),a(this,Wt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const r=document.createElement("div");a(this,Wt).append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",A(this,Z,gT).bind(this,s),{signal:t}),r.addEventListener("contextmenu",zs,{signal:t}),r.tabIndex=-1}this.div.prepend(a(this,Wt))},gT=function(e,t){var h;t.preventDefault();const{isMac:s}=Rt.platform;if(t.button!==0||t.ctrlKey&&s)return;(h=a(this,qe))==null||h.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,g(this,el,[t.screenX,t.screenY]);const i=new AbortController,o=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,Z,W0).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",ut,{passive:!1,signal:o}),window.addEventListener("contextmenu",zs,{signal:o}),g(this,fi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var d;i.abort(),this.parent.togglePointerEvents(!0),(d=a(this,qe))==null||d.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=l,this.div.style.cursor=c,A(this,Z,_m).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},V0=function(e,t,s,r){this.width=s,this.height=r,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},_m=function(){if(!a(this,fi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:r}=a(this,fi);g(this,fi,null);const i=this.x,o=this.y,l=this.width,c=this.height;i===e&&o===t&&l===s&&c===r||this.addCommands({cmd:A(this,Z,V0).bind(this,i,o,l,c),undo:A(this,Z,V0).bind(this,e,t,s,r),mustExec:!0})},W0=function(e,t){const[s,r]=this.parentDimensions,i=this.x,o=this.y,l=this.width,c=this.height,u=le.MIN_SIZE/s,h=le.MIN_SIZE/r,d=A(this,Z,wm).call(this,this.rotation),f=(K,M)=>[d[0]*K+d[2]*M,d[1]*K+d[3]*M],p=A(this,Z,wm).call(this,360-this.rotation),y=(K,M)=>[p[0]*K+p[2]*M,p[1]*K+p[3]*M];let v,S,m=!1,w=!1;switch(e){case"topLeft":m=!0,v=(K,M)=>[0,0],S=(K,M)=>[K,M];break;case"topMiddle":v=(K,M)=>[K/2,0],S=(K,M)=>[K/2,M];break;case"topRight":m=!0,v=(K,M)=>[K,0],S=(K,M)=>[0,M];break;case"middleRight":w=!0,v=(K,M)=>[K,M/2],S=(K,M)=>[0,M/2];break;case"bottomRight":m=!0,v=(K,M)=>[K,M],S=(K,M)=>[0,0];break;case"bottomMiddle":v=(K,M)=>[K/2,M],S=(K,M)=>[K/2,0];break;case"bottomLeft":m=!0,v=(K,M)=>[0,M],S=(K,M)=>[K,0];break;case"middleLeft":w=!0,v=(K,M)=>[0,M/2],S=(K,M)=>[K,M/2];break}const _=v(l,c),E=S(l,c);let k=f(...E);const C=le._round(i+k[0]),x=le._round(o+k[1]);let P=1,I=1,N,j;if(t.fromKeyboard)({deltaX:N,deltaY:j}=t);else{const{screenX:K,screenY:M}=t,[O,R]=a(this,el);[N,j]=this.screenToPageTranslation(K-O,M-R),a(this,el)[0]=K,a(this,el)[1]=M}if([N,j]=y(N/s,j/r),m){const K=Math.hypot(l,c);P=I=Math.max(Math.min(Math.hypot(E[0]-_[0]-N,E[1]-_[1]-j)/K,1/l,1/c),u/l,h/c)}else w?P=_n(Math.abs(E[0]-_[0]-N),u,1)/l:I=_n(Math.abs(E[1]-_[1]-j),h,1)/c;const ee=le._round(l*P),se=le._round(c*I);k=f(...S(ee,se));const Q=C-k[0],re=x-k[1];a(this,Wn)||g(this,Wn,[this.x,this.y,this.width,this.height]),this.width=ee,this.height=se,this.x=Q,this.y=re,this.setDims(),this.fixAndSetPosition(),this._onResizing()},mT=function(){var e;g(this,fi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=a(this,qe))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},yT=function(e,t,s){let i=.7*(s/t)+1-.7;if(i===1)return;const o=A(this,Z,wm).call(this,this.rotation),l=(C,x)=>[o[0]*C+o[2]*x,o[1]*C+o[3]*x],[c,u]=this.parentDimensions,h=this.x,d=this.y,f=this.width,p=this.height,y=le.MIN_SIZE/c,v=le.MIN_SIZE/u;i=Math.max(Math.min(i,1/f,1/p),y/f,v/p);const S=le._round(f*i),m=le._round(p*i);if(S===f&&m===p)return;a(this,Wn)||g(this,Wn,[h,d,f,p]);const w=l(f/2,p/2),_=le._round(h+w[0]),E=le._round(d+w[1]),k=l(S/2,m/2);this.x=_-k[0],this.y=E-k[1],this.width=S,this.height=m,this.setDims(),this.fixAndSetPosition(),this._onResizing()},vT=function(){var e;(e=a(this,qe))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),A(this,Z,_m).call(this)},G0=function(e){const{isMac:t}=Rt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},wT=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,i=this._uiManager.combinedSignal(r),o={capture:!0,passive:!1,signal:i},l=u=>{r.abort(),g(this,Co,null),g(this,tl,!1),this._uiManager.endDragSession()||A(this,Z,G0).call(this,u),s&&this._onStopDragging()};t&&(g(this,Cu,e.clientX),g(this,xu,e.clientY),g(this,Co,e.pointerId),g(this,zf,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=u;if(f!==a(this,Co)){ut(u);return}const[p,y]=this.screenToPageTranslation(h-a(this,Cu),d-a(this,xu));g(this,Cu,h),g(this,xu,d),this._uiManager.dragSelectedEditors(p,y)},o),window.addEventListener("touchmove",ut,o),window.addEventListener("pointerdown",u=>{u.pointerType===a(this,zf)&&(a(this,sl)||u.isPrimary)&&l(u),ut(u)},o));const c=u=>{if(!a(this,Co)||a(this,Co)===u.pointerId){l(u);return}ut(u)};window.addEventListener("pointerup",c,{signal:i}),window.addEventListener("blur",c,{signal:i})},q0=function(){if(a(this,xo)||!this.div)return;g(this,xo,new AbortController);const e=this._uiManager.combinedSignal(a(this,xo));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},_T=function(e){le._resizerKeyboardManager.exec(this,e)},bT=function(e){var t;a(this,pi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==a(this,Wt)&&A(this,Z,md).call(this)},ST=function(e){g(this,Hf,a(this,pi)?e:"")},K0=function(e){if(a(this,Qs))for(const t of a(this,Qs))t.tabIndex=e},md=function(){g(this,pi,!1),A(this,Z,K0).call(this,-1),A(this,Z,_m).call(this)},b(le,Gf),B(le,"_l10n",null),B(le,"_l10nResizer",null),B(le,"_borderLineWidth",-1),B(le,"_colorManager",new M0),B(le,"_zIndex",1),B(le,"_telemetryTimeout",1e3);let ze=le;class EM extends ze{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const SE=3285377520,_s=4294901760,wr=65535;class AT{constructor(e){this.h1=e?e&4294967295:SE,this.h2=e?e&4294967295:SE}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let v=0,S=e.length;v<S;v++){const m=e.charCodeAt(v);m<=255?t[s++]=m:(t[s++]=m>>>8,t[s++]=m&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,i=s-r*4,o=new Uint32Array(t.buffer,0,r);let l=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,p=d&wr,y=f&wr;for(let v=0;v<r;v++)v&1?(l=o[v],l=l*d&_s|l*p&wr,l=l<<15|l>>>17,l=l*f&_s|l*y&wr,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(c=o[v],c=c*d&_s|c*p&wr,c=c<<15|c>>>17,c=c*f&_s|c*y&wr,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(l=0,i){case 3:l^=t[r*4+2]<<16;case 2:l^=t[r*4+1]<<8;case 1:l^=t[r*4],l=l*d&_s|l*p&wr,l=l<<15|l>>>17,l=l*f&_s|l*y&wr,r&1?u^=l:h^=l}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&_s|e*36045&wr,t=t*4283543511&_s|((t<<16|e>>>16)*2950163797&_s)>>>16,e^=t>>>1,e=e*444984403&_s|e*60499&wr,t=t*3301882366&_s|((t<<16|e>>>16)*3120437893&_s)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const X0=Object.freeze({map:null,hash:"",transfer:void 0});var rl,il,gi,Gt,Uy,ET;class lS{constructor(){b(this,Uy);b(this,rl,!1);b(this,il,null);b(this,gi,null);b(this,Gt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=a(this,Gt).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return a(this,Gt).get(e)}remove(e){const t=a(this,Gt).get(e);if(t!==void 0&&(t instanceof ze&&a(this,gi).delete(t.annotationElementId),a(this,Gt).delete(e),a(this,Gt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of a(this,Gt).values())if(s instanceof ze)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=a(this,Gt).get(e);let r=!1;if(s!==void 0)for(const[i,o]of Object.entries(t))s[i]!==o&&(r=!0,s[i]=o);else r=!0,a(this,Gt).set(e,t);r&&A(this,Uy,ET).call(this),t instanceof ze&&((a(this,gi)||g(this,gi,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return a(this,Gt).has(e)}get size(){return a(this,Gt).size}resetModified(){a(this,rl)&&(g(this,rl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new kT(this)}get serializable(){if(a(this,Gt).size===0)return X0;const e=new Map,t=new AT,s=[],r=Object.create(null);let i=!1;for(const[o,l]of a(this,Gt)){const c=l instanceof ze?l.serialize(!1,r):l;c&&(e.set(o,c),t.update(`${o}:${JSON.stringify(c)}`),i||(i=!!c.bitmap))}if(i)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:X0}get editorStats(){let e=null;const t=new Map;let s=0,r=0;for(const i of a(this,Gt).values()){if(!(i instanceof ze)){i.popup&&(i.popup.deleted?r+=1:s+=1);continue}i.isCommentDeleted?r+=1:i.hasEditedComment&&(s+=1);const o=i.telemetryFinalData;if(!o)continue;const{type:l}=o;t.has(l)||t.set(l,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const c=e[l]||(e[l]=new Map);for(const[u,h]of Object.entries(o)){if(u==="type")continue;let d=c.get(u);d||(d=new Map,c.set(u,d));const f=d.get(h)??0;d.set(h,f+1)}}if((r>0||s>0)&&(e||(e=Object.create(null)),e.comments={deleted:r,edited:s}),!e)return null;for(const[i,o]of t)e[i]=o.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){g(this,il,null)}updateEditor(e,t){var r;const s=(r=a(this,gi))==null?void 0:r.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=a(this,gi))==null?void 0:t.get(e))||null}get modifiedIds(){if(a(this,il))return a(this,il);const e=[];if(a(this,gi))for(const t of a(this,gi).values())t.serialize()&&e.push(t.annotationElementId);return g(this,il,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return a(this,Gt).entries()}}rl=new WeakMap,il=new WeakMap,gi=new WeakMap,Gt=new WeakMap,Uy=new WeakSet,ET=function(){a(this,rl)||(g(this,rl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var qf;class kT extends lS{constructor(t){super();b(this,qf);const{map:s,hash:r,transfer:i}=t.serializable,o=structuredClone(s,i?{transfer:i}:null);g(this,qf,{map:o,hash:r,transfer:i})}get print(){Fe("Should not call PrintAnnotationStorage.print")}get serializable(){return a(this,qf)}get modifiedIds(){return ae(this,"modifiedIds",{ids:new Set,hash:""})}}qf=new WeakMap;var Tu;class kM{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){b(this,Tu,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),a(this,Tu).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||a(this,Tu).has(e.loadedName))){if(we(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:i,style:o}=e,l=new FontFace(r,i,o);this.addNativeFontFace(l);try{await l.load(),a(this,Tu).add(r),s==null||s(e)}catch{oe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Fe("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw oe(`Failed to load font '${s.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ae(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return ae(this,"isSyncFontLoadingSupported",wn||Rt.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(we(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:t,callback:e};return s.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ae(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,k){return E.charCodeAt(k)<<24|E.charCodeAt(k+1)<<16|E.charCodeAt(k+2)<<8|E.charCodeAt(k+3)&255}function r(E,k,C,x){const P=E.substring(0,k),I=E.substring(k+C);return P+x+I}let i,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;function h(E,k){if(++u>30){oe("Load test font never loaded."),k();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){k();return}setTimeout(h.bind(null,E,k))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=r(f,976,d.length,d);const y=16,v=1482184792;let S=s(f,y);for(i=0,o=d.length-3;i<o;i+=4)S=S-v+s(d,i)|0;i<d.length&&(S=S-v+s(d+"XXX",i)|0),f=r(f,y,4,iM(S));const m=`url(data:font/opentype;base64,${btoa(f)});`,w=`@font-face {font-family:"${d}";src:${m}}`;this.insertRule(w);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const E of[e.loadedName,d]){const k=this._document.createElement("span");k.textContent="Hi",k.style.fontFamily=E,_.append(k)}this._document.body.append(_),h(d,()=>{_.remove(),t.complete()})}}Tu=new WeakMap;var Pe;class CM{constructor(e,t=null,s,r){b(this,Pe);this.compiledGlyphs=Object.create(null),g(this,Pe,e),this._inspectFont=t,s&&Object.assign(this,s),r&&(this.charProcOperatorList=r)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${zx(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let r;try{r=e.get(s)}catch(o){oe(`getPathGenerator - ignoring character: "${o}".`)}const i=Wx(r==null?void 0:r.path);return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=i}get black(){return a(this,Pe).black}get bold(){return a(this,Pe).bold}get disableFontFace(){return a(this,Pe).disableFontFace??!1}set disableFontFace(e){ae(this,"disableFontFace",!!e)}get fontExtraProperties(){return a(this,Pe).fontExtraProperties??!1}get isInvalidPDFjsFont(){return a(this,Pe).isInvalidPDFjsFont}get isType3Font(){return a(this,Pe).isType3Font}get italic(){return a(this,Pe).italic}get missingFile(){return a(this,Pe).missingFile}get remeasure(){return a(this,Pe).remeasure}get vertical(){return a(this,Pe).vertical}get ascent(){return a(this,Pe).ascent}get defaultWidth(){return a(this,Pe).defaultWidth}get descent(){return a(this,Pe).descent}get bbox(){return a(this,Pe).bbox}set bbox(e){ae(this,"bbox",e)}get fontMatrix(){return a(this,Pe).fontMatrix}get fallbackName(){return a(this,Pe).fallbackName}get loadedName(){return a(this,Pe).loadedName}get mimetype(){return a(this,Pe).mimetype}get name(){return a(this,Pe).name}get data(){return a(this,Pe).data}clearData(){a(this,Pe).clearData()}get cssFontInfo(){return a(this,Pe).cssFontInfo}get systemFontInfo(){return a(this,Pe).systemFontInfo}get defaultVMetrics(){return a(this,Pe).defaultVMetrics}}Pe=new WeakMap;var Pu,Ru,Kf,Ou,bm;const Yc=class Yc{constructor(e){b(this,Ou);b(this,Pu);b(this,Ru);b(this,Kf);g(this,Pu,e),g(this,Ru,new DataView(a(this,Pu))),g(this,Kf,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let r=0;for(const u of Yc.strings){const h=t.encode(e[u]);s[u]=h,r+=4+h.length}const i=new ArrayBuffer(r),o=new Uint8Array(i),l=new DataView(i);let c=0;for(const u of Yc.strings){const h=s[u],d=h.length;l.setUint32(c,d),o.set(h,c+4),c+=4+d}return we(c===i.byteLength,"CssFontInfo.write: Buffer overflow"),i}get fontFamily(){return A(this,Ou,bm).call(this,0)}get fontWeight(){return A(this,Ou,bm).call(this,1)}get italicAngle(){return A(this,Ou,bm).call(this,2)}};Pu=new WeakMap,Ru=new WeakMap,Kf=new WeakMap,Ou=new WeakSet,bm=function(e){we(e<Yc.strings.length,"Invalid string index");let t=0;for(let r=0;r<e;r++)t+=a(this,Ru).getUint32(t)+4;const s=a(this,Ru).getUint32(t);return a(this,Kf).decode(new Uint8Array(a(this,Pu),t+4,s))},B(Yc,"strings",["fontFamily","fontWeight","italicAngle"]);let ky=Yc;var To,Or,ol,al,yd;const Jc=class Jc{constructor(e){b(this,al);b(this,To);b(this,Or);b(this,ol);g(this,To,e),g(this,Or,new DataView(a(this,To))),g(this,ol,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let r=0;for(const f of Jc.strings){const p=t.encode(e[f]);s[f]=p,r+=4+p.length}r+=4;let i,o,l=1+r;e.style&&(i=t.encode(e.style.style),o=t.encode(e.style.weight),l+=4+i.length+4+o.length);const c=new ArrayBuffer(l),u=new Uint8Array(c),h=new DataView(c);let d=0;h.setUint8(d++,e.guessFallback?1:0),h.setUint32(d,0),d+=4,r=0;for(const f of Jc.strings){const p=s[f],y=p.length;r+=4+y,h.setUint32(d,y),u.set(p,d+4),d+=4+y}return h.setUint32(d-r-4,r),e.style&&(h.setUint32(d,i.length),u.set(i,d+4),d+=4+i.length,h.setUint32(d,o.length),u.set(o,d+4),d+=4+o.length),we(d<=c.byteLength,"SubstitionInfo.write: Buffer overflow"),c.transferToFixedLength(d)}get guessFallback(){return a(this,Or).getUint8(0)!==0}get css(){return A(this,al,yd).call(this,0)}get loadedName(){return A(this,al,yd).call(this,1)}get baseFontName(){return A(this,al,yd).call(this,2)}get src(){return A(this,al,yd).call(this,3)}get style(){let e=1;e+=4+a(this,Or).getUint32(e);const t=a(this,Or).getUint32(e),s=a(this,ol).decode(new Uint8Array(a(this,To),e+4,t));e+=4+t;const r=a(this,Or).getUint32(e),i=a(this,ol).decode(new Uint8Array(a(this,To),e+4,r));return{style:s,weight:i}}};To=new WeakMap,Or=new WeakMap,ol=new WeakMap,al=new WeakSet,yd=function(e){we(e<Jc.strings.length,"Invalid string index");let t=5;for(let r=0;r<e;r++)t+=a(this,Or).getUint32(t)+4;const s=a(this,Or).getUint32(t);return a(this,ol).decode(new Uint8Array(a(this,To),t+4,s))},B(Jc,"strings",["css","loadedName","baseFontName","src"]);let Cy=Jc;var Iu,Lu,Du,Nu,Gn,Ir,Xf,Re,lt,Gs,Sm,vd;const ue=class ue{constructor({data:e,extra:t}){b(this,lt);b(this,Ir);b(this,Xf);b(this,Re);g(this,Ir,e),g(this,Xf,new TextDecoder),g(this,Re,new DataView(a(this,Ir))),t&&Object.assign(this,t)}get black(){return A(this,lt,Gs).call(this,0)}get bold(){return A(this,lt,Gs).call(this,1)}get disableFontFace(){return A(this,lt,Gs).call(this,2)}get fontExtraProperties(){return A(this,lt,Gs).call(this,3)}get isInvalidPDFjsFont(){return A(this,lt,Gs).call(this,4)}get isType3Font(){return A(this,lt,Gs).call(this,5)}get italic(){return A(this,lt,Gs).call(this,6)}get missingFile(){return A(this,lt,Gs).call(this,7)}get remeasure(){return A(this,lt,Gs).call(this,8)}get vertical(){return A(this,lt,Gs).call(this,9)}get ascent(){return A(this,lt,Sm).call(this,0)}get defaultWidth(){return A(this,lt,Sm).call(this,1)}get descent(){return A(this,lt,Sm).call(this,2)}get bbox(){let e=a(ue,Lu);if(a(this,Re).getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<4;r++)s.push(a(this,Re).getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=a(ue,Du);if(a(this,Re).getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<6;r++)s.push(a(this,Re).getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=a(ue,Nu);if(a(this,Re).getUint8(e)===0)return;e+=1;const s=[];for(let r=0;r<3;r++)s.push(a(this,Re).getInt16(e,!0)),e+=2;return s}get fallbackName(){return A(this,lt,vd).call(this,0)}get loadedName(){return A(this,lt,vd).call(this,1)}get mimetype(){return A(this,lt,vd).call(this,2)}get name(){return A(this,lt,vd).call(this,3)}get data(){let e=a(ue,Gn);const t=a(this,Re).getUint32(e);e+=4+t;const s=a(this,Re).getUint32(e);e+=4+s;const r=a(this,Re).getUint32(e);e+=4+r;const i=a(this,Re).getUint32(e);if(i!==0)return new Uint8Array(a(this,Ir),e+4,i)}clearData(){let e=a(ue,Gn);const t=a(this,Re).getUint32(e);e+=4+t;const s=a(this,Re).getUint32(e);e+=4+s;const r=a(this,Re).getUint32(e);e+=4+r;const i=a(this,Re).getUint32(e);new Uint8Array(a(this,Ir),e+4,i).fill(0),a(this,Re).setUint32(e,0)}get cssFontInfo(){let e=a(ue,Gn);const t=a(this,Re).getUint32(e);e+=4+t;const s=a(this,Re).getUint32(e);e+=4+s;const r=a(this,Re).getUint32(e);if(r===0)return null;const i=new Uint8Array(r);return i.set(new Uint8Array(a(this,Ir),e+4,r)),new ky(i.buffer)}get systemFontInfo(){let e=a(ue,Gn);const t=a(this,Re).getUint32(e);e+=4+t;const s=a(this,Re).getUint32(e);if(s===0)return null;const r=new Uint8Array(s);return r.set(new Uint8Array(a(this,Ir),e+4,s)),new Cy(r.buffer)}static write(e){const t=e.systemFontInfo?Cy.write(e.systemFontInfo):null,s=e.cssFontInfo?ky.write(e.cssFontInfo):null,r=new TextEncoder,i={};let o=0;for(const v of ue.strings)i[v]=r.encode(e[v]),o+=4+i[v].length;const l=a(ue,Gn)+4+o+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),c=new ArrayBuffer(l),u=new Uint8Array(c),h=new DataView(c);let d=0;const f=ue.bools.length;let p=0,y=0;for(let v=0;v<f;v++){const S=e[ue.bools[v]];p|=(S===void 0?0:S?2:1)<<y,y+=2,(y===8||v===f-1)&&(h.setUint8(d++,p),p=0,y=0)}we(d===a(ue,Iu),"FontInfo.write: Boolean properties offset mismatch");for(const v of ue.numbers)h.setFloat64(d,e[v]),d+=8;if(we(d===a(ue,Lu),"FontInfo.write: Number properties offset mismatch"),e.bbox){h.setUint8(d++,4);for(const v of e.bbox)h.setInt16(d,v,!0),d+=2}else h.setUint8(d++,0),d+=2*4;if(we(d===a(ue,Du),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){h.setUint8(d++,6);for(const v of e.fontMatrix)h.setFloat64(d,v,!0),d+=8}else h.setUint8(d++,0),d+=8*6;if(we(d===a(ue,Nu),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){h.setUint8(d++,1);for(const v of e.defaultVMetrics)h.setInt16(d,v,!0),d+=2}else h.setUint8(d++,0),d+=3*2;we(d===a(ue,Gn),"FontInfo.write: DefaultVMetrics properties offset mismatch"),h.setUint32(a(ue,Gn),0),d+=4;for(const v of ue.strings){const S=i[v],m=S.length;h.setUint32(d,m),u.set(S,d+4),d+=4+m}if(h.setUint32(a(ue,Gn),d-a(ue,Gn)-4),!t)h.setUint32(d,0),d+=4;else{const v=t.byteLength;h.setUint32(d,v),we(d+4+v<=c.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),d+4),d+=4+v}if(!s)h.setUint32(d,0),d+=4;else{const v=s.byteLength;h.setUint32(d,v),we(d+4+v<=c.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(s),d+4),d+=4+v}return e.data===void 0?(h.setUint32(d,0),d+=4):(h.setUint32(d,e.data.length),u.set(e.data,d+4),d+=4+e.data.length),we(d<=c.byteLength,"FontInfo.write: Buffer overflow"),c.transferToFixedLength(d)}};Iu=new WeakMap,Lu=new WeakMap,Du=new WeakMap,Nu=new WeakMap,Gn=new WeakMap,Ir=new WeakMap,Xf=new WeakMap,Re=new WeakMap,lt=new WeakSet,Gs=function(e){we(e<ue.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,r=a(this,Re).getUint8(t)>>s&3;return r===0?void 0:r===2},Sm=function(e){return we(e<ue.numbers.length,"Invalid number index"),a(this,Re).getFloat64(a(ue,Iu)+e*8)},vd=function(e){we(e<ue.strings.length,"Invalid string index");let t=a(ue,Gn)+4;for(let i=0;i<e;i++)t+=a(this,Re).getUint32(t)+4;const s=a(this,Re).getUint32(t),r=new Uint8Array(s);return r.set(new Uint8Array(a(this,Ir),t+4,s)),a(this,Xf).decode(r)},B(ue,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),B(ue,"numbers",["ascent","defaultWidth","descent"]),B(ue,"strings",["fallbackName","loadedName","mimetype","name"]),b(ue,Iu,Math.ceil(ue.bools.length*2/8)),b(ue,Lu,a(ue,Iu)+ue.numbers.length*8),b(ue,Du,a(ue,Lu)+1+2*4),b(ue,Nu,a(ue,Du)+1+8*6),b(ue,Gn,a(ue,Nu)+1+2*3);let Y0=ue;var Yf,Jf,Qf,Zf,ep,tp,np,sp;const je=class je{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,s=null,r=[],i=[],o=[],l=[],c=null,u=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,s=e[2],o=e[3],t===1?r.push(...e[4],...e[5]):r.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,c=e[1],r=e[2],i=e[3],l=e[4]||[],s=e[6],u=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const h=Math.floor(r.length/2),d=Math.floor(i.length/3),f=o.length,p=l.length;let y=0;for(const k of l)y+=1,y=Math.ceil(y/4)*4,y+=4+k.coords.length*4,y+=4+k.colors.length*4,k.verticesPerRow!==void 0&&(y+=4);const v=20+h*8+d*3+f*8+(s?16:0)+(u?3:0)+y,S=new ArrayBuffer(v),m=new DataView(S),w=new Uint8Array(S);m.setUint8(a(je,Yf),t),m.setUint8(a(je,Jf),s?1:0),m.setUint8(a(je,Qf),u?1:0),m.setUint8(a(je,Zf),c),m.setUint32(a(je,ep),h,!0),m.setUint32(a(je,tp),d,!0),m.setUint32(a(je,np),f,!0),m.setUint32(a(je,sp),p,!0);let _=20;new Float32Array(S,_,h*2).set(r),_+=h*8,w.set(i,_),_+=d*3;for(const[k,C]of o)m.setFloat32(_,k,!0),_+=4,m.setUint32(_,parseInt(C.slice(1),16),!0),_+=4;if(s)for(const k of s)m.setFloat32(_,k,!0),_+=4;u&&(w.set(u,_),_+=3);for(let k=0;k<l.length;k++){const C=l[k];m.setUint8(_,C.type),_+=1,_=Math.ceil(_/4)*4,m.setUint32(_,C.coords.length,!0),_+=4,new Int32Array(S,_,C.coords.length).set(C.coords),_+=C.coords.length*4,m.setUint32(_,C.colors.length,!0),_+=4,new Int32Array(S,_,C.colors.length).set(C.colors),_+=C.colors.length*4,C.verticesPerRow!==void 0&&(m.setUint32(_,C.verticesPerRow,!0),_+=4)}return S}getIR(){const e=this.view,t=this.data[a(je,Yf)],s=!!this.data[a(je,Jf)],r=!!this.data[a(je,Qf)],i=e.getUint32(a(je,ep),!0),o=e.getUint32(a(je,tp),!0),l=e.getUint32(a(je,np),!0),c=e.getUint32(a(je,sp),!0);let u=20;const h=new Float32Array(this.buffer,u,i*2);u+=i*8;const d=new Uint8Array(this.buffer,u,o*3);u+=o*3;const f=[];for(let S=0;S<l;++S){const m=e.getFloat32(u,!0);u+=4;const w=e.getUint32(u,!0);u+=4,f.push([m,`#${w.toString(16).padStart(6,"0")}`])}let p=null;if(s){p=[];for(let S=0;S<4;++S)p.push(e.getFloat32(u,!0)),u+=4}let y=null;r&&(y=new Uint8Array(this.buffer,u,3),u+=3);const v=[];for(let S=0;S<c;++S){const m=e.getUint8(u);u+=1,u=Math.ceil(u/4)*4;const w=e.getUint32(u,!0);u+=4;const _=new Int32Array(this.buffer,u,w);u+=w*4;const E=e.getUint32(u,!0);u+=4;const k=new Int32Array(this.buffer,u,E);u+=E*4;const C={type:m,coords:_,colors:k};m===T0.LATTICE&&(C.verticesPerRow=e.getUint32(u,!0),u+=4),v.push(C)}if(t===1)return["RadialAxial","axial",p,f,Array.from(h.slice(0,2)),Array.from(h.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",p,f,[h[0],h[1]],[h[3],h[4]],h[2],h[5]];if(t===3){const S=this.data[a(je,Zf)];let m=null;if(h.length>0){let w=h[0],_=h[0],E=h[1],k=h[1];for(let C=0;C<h.length;C+=2){const x=h[C],P=h[C+1];w=w>x?x:w,E=E>P?P:E,_=_<x?x:_,k=k<P?P:k}m=[w,E,_,k]}return["Mesh",S,h,d,v,m,p,y]}throw new Error(`Unsupported pattern kind: ${t}`)}};Yf=new WeakMap,Jf=new WeakMap,Qf=new WeakMap,Zf=new WeakMap,ep=new WeakMap,tp=new WeakMap,np=new WeakMap,sp=new WeakMap,b(je,Yf,0),b(je,Jf,1),b(je,Qf,2),b(je,Zf,3),b(je,ep,4),b(je,tp,8),b(je,np,12),b(je,sp,16);let J0=je;var Mu;class xM{constructor(e){b(this,Mu);g(this,Mu,e)}static write(e){let t,s;return Rt.isFloat16ArraySupported?(s=new ArrayBuffer(e.length*2),t=new Float16Array(s)):(s=new ArrayBuffer(e.length*4),t=new Float32Array(s)),t.set(e),s}get path(){return Rt.isFloat16ArraySupported?new Float16Array(a(this,Mu)):new Float32Array(a(this,Mu))}}Mu=new WeakMap;function TM(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(wn)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function PM(n){if(wn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return vg(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Kg(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Q0=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,RM=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",OM=uM.bind(null,Q0,RM);var mi,$y;class IM{constructor(){b(this,mi,new Map);b(this,$y,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};a(this,$y).then(()=>{for(const[r]of a(this,mi))r.call(this,s)})}addEventListener(e,t,s=null){let r=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:i}=s;if(i.aborted){oe("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);r=()=>i.removeEventListener("abort",o),i.addEventListener("abort",o)}a(this,mi).set(t,r)}removeEventListener(e,t){const s=a(this,mi).get(t);s==null||s(),a(this,mi).delete(t)}terminate(){for(const[,e]of a(this,mi))e==null||e();a(this,mi).clear()}}mi=new WeakMap,$y=new WeakMap;const Xg={DATA:1,ERROR:2},pt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function AE(){}function xn(n){if(n instanceof fa||n instanceof P0||n instanceof gE||n instanceof by||n instanceof dw)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Fe('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new fa(n.message);case"InvalidPDFException":return new P0(n.message);case"PasswordException":return new gE(n.message,n.code);case"ResponseException":return new by(n.message,n.status,n.missing);case"UnknownErrorException":return new dw(n.message,n.details)}return new dw(n.message,n.toString())}var Fu,js,CT,xT,TT,Am;class wd{constructor(e,t,s){b(this,js);b(this,Fu,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",A(this,js,CT).bind(this),{signal:a(this,Fu).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const r=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[r]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},s)}catch(o){i.reject(o)}return i.promise}sendWithStream(e,t,s,r){const i=this.streamId++,o=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[i]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:l,action:e,streamId:i,data:t,desiredSize:u.desiredSize},r),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[i].pullCall=h,c.postMessage({sourceName:o,targetName:l,stream:pt.PULL,streamId:i,desiredSize:u.desiredSize}),h.promise},cancel:u=>{we(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[i].cancelCall=h,this.streamControllers[i].isClosed=!0,c.postMessage({sourceName:o,targetName:l,stream:pt.CANCEL,streamId:i,reason:xn(u)}),h.promise}},s)}destroy(){var e;(e=a(this,Fu))==null||e.abort(),g(this,Fu,null)}}Fu=new WeakMap,js=new WeakSet,CT=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){A(this,js,TT).call(this,e);return}if(e.callback){const s=e.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Xg.DATA)r.resolve(e.data);else if(e.callback===Xg.ERROR)r.reject(xn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,r=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(o){i.postMessage({sourceName:s,targetName:r,callback:Xg.DATA,callbackId:e.callbackId,data:o})},function(o){i.postMessage({sourceName:s,targetName:r,callback:Xg.ERROR,callbackId:e.callbackId,reason:xn(o)})});return}if(e.streamId){A(this,js,xT).call(this,e);return}t(e.data)},xT=function(e){const t=e.streamId,s=this.sourceName,r=e.sourceName,i=this.comObj,o=this,l=this.actionHandler[e.action],c={enqueue(u,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:r,stream:pt.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:r,stream:pt.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){we(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:r,stream:pt.ERROR,streamId:t,reason:xn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(l,e.data,c).then(function(){i.postMessage({sourceName:s,targetName:r,stream:pt.START_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:s,targetName:r,stream:pt.START_COMPLETE,streamId:t,reason:xn(u)})})},TT=function(e){const t=e.streamId,s=this.sourceName,r=e.sourceName,i=this.comObj,o=this.streamControllers[t],l=this.streamSinks[t];switch(e.stream){case pt.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(xn(e.reason));break;case pt.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(xn(e.reason));break;case pt.PULL:if(!l){i.postMessage({sourceName:s,targetName:r,stream:pt.PULL_COMPLETE,streamId:t,success:!0});break}l.desiredSize<=0&&e.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=e.desiredSize,Promise.try(l.onPull||AE).then(function(){i.postMessage({sourceName:s,targetName:r,stream:pt.PULL_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:s,targetName:r,stream:pt.PULL_COMPLETE,streamId:t,reason:xn(u)})});break;case pt.ENQUEUE:if(we(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case pt.CLOSE:if(we(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),A(this,js,Am).call(this,o,t);break;case pt.ERROR:we(o,"error should have stream controller"),o.controller.error(xn(e.reason)),A(this,js,Am).call(this,o,t);break;case pt.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(xn(e.reason)),A(this,js,Am).call(this,o,t);break;case pt.CANCEL:if(!l)break;const c=xn(e.reason);Promise.try(l.onCancel||AE,c).then(function(){i.postMessage({sourceName:s,targetName:r,stream:pt.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:s,targetName:r,stream:pt.CANCEL_COMPLETE,streamId:t,reason:xn(u)})}),l.sinkCapability.reject(c),l.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Am=async function(e,t){var s,r,i;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(r=e.pullCall)==null?void 0:r.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var rp;class PT{constructor({enableHWA:e=!1}){b(this,rp,!1);g(this,rp,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!a(this,rp)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Fe("Abstract method `_createCanvas` called.")}}rp=new WeakMap;class LM extends PT{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class RT{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Fe("Abstract method `_fetch` called.")}}class EE extends RT{async _fetch(e){const t=await wg(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):vg(t)}}class OT{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,r,i){return"none"}destroy(e=!1){}}var ll,Bu,yi,vi,ln,cl,ul,W,sn,_d,Tc,Em,Pc,IT,Z0,Rc,bd,Sd,e_,Ad;class DM extends OT{constructor({docId:t,ownerDocument:s=globalThis.document}){super();b(this,W);b(this,ll);b(this,Bu);b(this,yi);b(this,vi);b(this,ln);b(this,cl);b(this,ul,0);g(this,vi,t),g(this,ln,s)}addFilter(t){if(!t)return"none";let s=a(this,W,sn).get(t);if(s)return s;const[r,i,o]=A(this,W,Em).call(this,t),l=t.length===1?r:`${r}${i}${o}`;if(s=a(this,W,sn).get(l),s)return a(this,W,sn).set(t,s),s;const c=`g_${a(this,vi)}_transfer_map_${bt(this,ul)._++}`,u=A(this,W,Pc).call(this,c);a(this,W,sn).set(t,u),a(this,W,sn).set(l,u);const h=A(this,W,Rc).call(this,c);return A(this,W,Sd).call(this,r,i,o,h),u}addHCMFilter(t,s){var y;const r=`${t}-${s}`,i="base";let o=a(this,W,_d).get(i);if((o==null?void 0:o.key)===r||(o?((y=o.filter)==null||y.remove(),o.key=r,o.url="none",o.filter=null):(o={key:r,url:"none",filter:null},a(this,W,_d).set(i,o)),!t||!s))return o.url;const l=A(this,W,Ad).call(this,t);t=V.makeHexColor(...l);const c=A(this,W,Ad).call(this,s);if(s=V.makeHexColor(...c),a(this,W,Tc).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return o.url;const u=new Array(256);for(let v=0;v<=255;v++){const S=v/255;u[v]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const h=u.join(","),d=`g_${a(this,vi)}_hcm_filter`,f=o.filter=A(this,W,Rc).call(this,d);A(this,W,Sd).call(this,h,h,h,f),A(this,W,Z0).call(this,f);const p=(v,S)=>{const m=l[v]/255,w=c[v]/255,_=new Array(S+1);for(let E=0;E<=S;E++)_[E]=m+E/S*(w-m);return _.join(",")};return A(this,W,Sd).call(this,p(0,5),p(1,5),p(2,5),f),o.url=A(this,W,Pc).call(this,d),o.url}addAlphaFilter(t){let s=a(this,W,sn).get(t);if(s)return s;const[r]=A(this,W,Em).call(this,[t]),i=`alpha_${r}`;if(s=a(this,W,sn).get(i),s)return a(this,W,sn).set(t,s),s;const o=`g_${a(this,vi)}_alpha_map_${bt(this,ul)._++}`,l=A(this,W,Pc).call(this,o);a(this,W,sn).set(t,l),a(this,W,sn).set(i,l);const c=A(this,W,Rc).call(this,o);return A(this,W,e_).call(this,r,c),l}addLuminosityFilter(t){let s=a(this,W,sn).get(t||"luminosity");if(s)return s;let r,i;if(t?([r]=A(this,W,Em).call(this,[t]),i=`luminosity_${r}`):i="luminosity",s=a(this,W,sn).get(i),s)return a(this,W,sn).set(t,s),s;const o=`g_${a(this,vi)}_luminosity_map_${bt(this,ul)._++}`,l=A(this,W,Pc).call(this,o);a(this,W,sn).set(t,l),a(this,W,sn).set(i,l);const c=A(this,W,Rc).call(this,o);return A(this,W,IT).call(this,c),t&&A(this,W,e_).call(this,r,c),l}addHighlightHCMFilter(t,s,r,i,o){var w;const l=`${s}-${r}-${i}-${o}`;let c=a(this,W,_d).get(t);if((c==null?void 0:c.key)===l||(c?((w=c.filter)==null||w.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},a(this,W,_d).set(t,c)),!s||!r))return c.url;const[u,h]=[s,r].map(A(this,W,Ad).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[p,y]=[i,o].map(A(this,W,Ad).bind(this));f<d&&([d,f,p,y]=[f,d,y,p]),a(this,W,Tc).style.color="";const v=(_,E,k)=>{const C=new Array(256),x=(f-d)/k,P=_/255,I=(E-_)/(255*k);let N=0;for(let j=0;j<=k;j++){const ee=Math.round(d+j*x),se=P+j*I;for(let Q=N;Q<=ee;Q++)C[Q]=se;N=ee+1}for(let j=N;j<256;j++)C[j]=C[N-1];return C.join(",")},S=`g_${a(this,vi)}_hcm_${t}_filter`,m=c.filter=A(this,W,Rc).call(this,S);return A(this,W,Z0).call(this,m),A(this,W,Sd).call(this,v(p[0],y[0],5),v(p[1],y[1],5),v(p[2],y[2],5),m),c.url=A(this,W,Pc).call(this,S),c.url}destroy(t=!1){var s,r,i,o;t&&((s=a(this,cl))!=null&&s.size)||((r=a(this,yi))==null||r.parentNode.parentNode.remove(),g(this,yi,null),(i=a(this,Bu))==null||i.clear(),g(this,Bu,null),(o=a(this,cl))==null||o.clear(),g(this,cl,null),g(this,ul,0))}}ll=new WeakMap,Bu=new WeakMap,yi=new WeakMap,vi=new WeakMap,ln=new WeakMap,cl=new WeakMap,ul=new WeakMap,W=new WeakSet,sn=function(){return a(this,Bu)||g(this,Bu,new Map)},_d=function(){return a(this,cl)||g(this,cl,new Map)},Tc=function(){if(!a(this,yi)){const t=a(this,ln).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const r=a(this,ln).createElementNS(Jr,"svg");r.setAttribute("width",0),r.setAttribute("height",0),g(this,yi,a(this,ln).createElementNS(Jr,"defs")),t.append(r),r.append(a(this,yi)),a(this,ln).body.append(t)}return a(this,yi)},Em=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const d=h.join(",");return[d,d,d]}const[s,r,i]=t,o=new Array(256),l=new Array(256),c=new Array(256);for(let u=0;u<256;u++)o[u]=s[u]/255,l[u]=r[u]/255,c[u]=i[u]/255;return[o.join(","),l.join(","),c.join(",")]},Pc=function(t){if(a(this,ll)===void 0){g(this,ll,"");const s=a(this,ln).URL;s!==a(this,ln).baseURI&&(Av(s)?oe('#createUrl: ignore "data:"-URL for performance reasons.'):g(this,ll,jx(s,"")))}return`url(${a(this,ll)}#${t})`},IT=function(t){const s=a(this,ln).createElementNS(Jr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Z0=function(t){const s=a(this,ln).createElementNS(Jr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Rc=function(t){const s=a(this,ln).createElementNS(Jr,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),a(this,W,Tc).append(s),s},bd=function(t,s,r){const i=a(this,ln).createElementNS(Jr,s);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),t.append(i)},Sd=function(t,s,r,i){const o=a(this,ln).createElementNS(Jr,"feComponentTransfer");i.append(o),A(this,W,bd).call(this,o,"feFuncR",t),A(this,W,bd).call(this,o,"feFuncG",s),A(this,W,bd).call(this,o,"feFuncB",r)},e_=function(t,s){const r=a(this,ln).createElementNS(Jr,"feComponentTransfer");s.append(r),A(this,W,bd).call(this,r,"feFuncA",t)},Ad=function(t){return a(this,W,Tc).style.color=t,bg(getComputedStyle(a(this,W,Tc)).getPropertyValue("color"))};class LT{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Fe("Abstract method `_fetch` called.")}}class kE extends LT{async _fetch(e){const t=await wg(e,"arraybuffer");return new Uint8Array(t)}}class DT{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Fe("Abstract method `_fetch` called.")}}class CE extends DT{async _fetch(e){const t=await wg(e,"arraybuffer");return new Uint8Array(t)}}wn&&oe("Please use the `legacy` build in Node.js environments.");async function cS(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class NM extends OT{}class MM extends PT{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class FM extends RT{async _fetch(e){return cS(e)}}class BM extends LT{async _fetch(e){return cS(e)}}class jM extends DT{async _fetch(e){return cS(e)}}const Sc="__forcedDependency",{floor:xE,ceil:TE}=Math;function Yg(n,e,t,s,r,i){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],s),n[e*4+2]=Math.max(n[e*4+2],r),n[e*4+3]=Math.max(n[e*4+3],i)}const t_=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var ju,Po;class UM{constructor(e,t){b(this,ju);b(this,Po);g(this,ju,e),g(this,Po,t)}get length(){return a(this,ju).length}isEmpty(e){return a(this,ju)[e]===t_}minX(e){return a(this,Po)[e*4+0]/256}minY(e){return a(this,Po)[e*4+1]/256}maxX(e){return(a(this,Po)[e*4+2]+1)/256}maxY(e){return(a(this,Po)[e*4+3]+1)/256}}ju=new WeakMap,Po=new WeakMap;const Jg=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var Rn,On,hl,Zs,dl,wi,Ce,Oe,_i,In,ip,Uu,fl,pl,bi,cn,Lr,op,n_;class $M{constructor(e,t,s=!1){b(this,op);b(this,Rn,{__proto__:null});b(this,On,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Sc]:[]});b(this,hl,new Map);b(this,Zs,[]);b(this,dl,[]);b(this,wi,[[1,0,0,1,0,0]]);b(this,Ce,[-1/0,-1/0,1/0,1/0]);b(this,Oe,new Float64Array([1/0,1/0,-1/0,-1/0]));b(this,_i,-1);b(this,In,new Set);b(this,ip,new Map);b(this,Uu,new Map);b(this,fl);b(this,pl);b(this,bi);b(this,cn);b(this,Lr);g(this,fl,e.width),g(this,pl,e.height),A(this,op,n_).call(this,t),s&&g(this,Lr,new Map)}growOperationsCount(e){e>=a(this,cn).length&&A(this,op,n_).call(this,e,a(this,cn))}save(e){return g(this,Rn,{__proto__:a(this,Rn)}),g(this,On,{__proto__:a(this,On),transform:{__proto__:a(this,On).transform},moveText:{__proto__:a(this,On).moveText},sameLineText:{__proto__:a(this,On).sameLineText},[Sc]:{__proto__:a(this,On)[Sc]}}),g(this,Ce,{__proto__:a(this,Ce)}),a(this,Zs).push(e),this}restore(e){var r;const t=Object.getPrototypeOf(a(this,Rn));if(t===null)return this;g(this,Rn,t),g(this,On,Object.getPrototypeOf(a(this,On))),g(this,Ce,Object.getPrototypeOf(a(this,Ce)));const s=a(this,Zs).pop();return s!==void 0&&((r=Jg(a(this,Lr),e))==null||r.dependencies.add(s),a(this,cn)[e]=a(this,cn)[s]),this}recordOpenMarker(e){return a(this,Zs).push(e),this}getOpenMarker(){return a(this,Zs).length===0?null:a(this,Zs).at(-1)}recordCloseMarker(e){var s;const t=a(this,Zs).pop();return t!==void 0&&((s=Jg(a(this,Lr),e))==null||s.dependencies.add(t),a(this,cn)[e]=a(this,cn)[t]),this}beginMarkedContent(e){return a(this,dl).push(e),this}endMarkedContent(e){var s;const t=a(this,dl).pop();return t!==void 0&&((s=Jg(a(this,Lr),e))==null||s.dependencies.add(t),a(this,cn)[e]=a(this,cn)[t]),this}pushBaseTransform(e){return a(this,wi).push(V.multiplyByDOMMatrix(a(this,wi).at(-1),e.getTransform())),this}popBaseTransform(){return a(this,wi).length>1&&a(this,wi).pop(),this}recordSimpleData(e,t){return a(this,Rn)[e]=t,this}recordIncrementalData(e,t){return a(this,On)[e].push(t),this}resetIncrementalData(e,t){return a(this,On)[e].length=0,this}recordNamedData(e,t){return a(this,hl).set(e,t),this}recordSimpleDataFromNamed(e,t,s){a(this,Rn)[e]=a(this,hl).get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Sc,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in a(this,Rn)&&this.recordFutureForcedDependency(t,a(this,Rn)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of a(this,In))this.recordFutureForcedDependency(Sc,e);return this}resetBBox(e){return a(this,_i)!==e&&(g(this,_i,e),a(this,Oe)[0]=1/0,a(this,Oe)[1]=1/0,a(this,Oe)[2]=-1/0,a(this,Oe)[3]=-1/0),this}recordClipBox(e,t,s,r,i,o){const l=V.multiplyByDOMMatrix(a(this,wi).at(-1),t.getTransform()),c=[1/0,1/0,-1/0,-1/0];V.axialAlignedBoundingBox([s,i,r,o],l,c);const u=V.intersect(a(this,Ce),c);return u?(a(this,Ce)[0]=u[0],a(this,Ce)[1]=u[1],a(this,Ce)[2]=u[2],a(this,Ce)[3]=u[3]):(a(this,Ce)[0]=a(this,Ce)[1]=1/0,a(this,Ce)[2]=a(this,Ce)[3]=-1/0),this}recordBBox(e,t,s,r,i,o){const l=a(this,Ce);if(l[0]===1/0)return this;const c=V.multiplyByDOMMatrix(a(this,wi).at(-1),t.getTransform());if(l[0]===-1/0)return V.axialAlignedBoundingBox([s,i,r,o],c,a(this,Oe)),this;const u=[1/0,1/0,-1/0,-1/0];return V.axialAlignedBoundingBox([s,i,r,o],c,u),a(this,Oe)[0]=Math.min(a(this,Oe)[0],Math.max(u[0],l[0])),a(this,Oe)[1]=Math.min(a(this,Oe)[1],Math.max(u[1],l[1])),a(this,Oe)[2]=Math.max(a(this,Oe)[2],Math.min(u[2],l[2])),a(this,Oe)[3]=Math.max(a(this,Oe)[3],Math.min(u[3],l[3])),this}recordCharacterBBox(e,t,s,r=1,i=0,o=0,l){const c=s.bbox;let u,h;if(c&&(u=c[2]!==c[0]&&c[3]!==c[1]&&a(this,Uu).get(s),u!==!1&&(h=[0,0,0,0],V.axialAlignedBoundingBox(c,s.fontMatrix,h),(r!==1||i!==0||o!==0)&&V.scaleMinMax([r,0,0,-r,i,o],h),u)))return this.recordBBox(e,t,h[0],h[2],h[1],h[3]);if(!l)return this.recordFullPageBBox(e);const d=l();return c&&h&&u===void 0&&(u=h[0]<=i-d.actualBoundingBoxLeft&&h[2]>=i+d.actualBoundingBoxRight&&h[1]<=o-d.actualBoundingBoxAscent&&h[3]>=o+d.actualBoundingBoxDescent,a(this,Uu).set(s,u),u)?this.recordBBox(e,t,h[0],h[2],h[1],h[3]):this.recordBBox(e,t,i-d.actualBoundingBoxLeft,i+d.actualBoundingBoxRight,o-d.actualBoundingBoxAscent,o+d.actualBoundingBoxDescent)}recordFullPageBBox(e){return a(this,Oe)[0]=Math.max(0,a(this,Ce)[0]),a(this,Oe)[1]=Math.max(0,a(this,Ce)[1]),a(this,Oe)[2]=Math.min(a(this,fl),a(this,Ce)[2]),a(this,Oe)[3]=Math.min(a(this,pl),a(this,Ce)[3]),this}getSimpleIndex(e){return a(this,Rn)[e]}recordDependencies(e,t){const s=a(this,In),r=a(this,Rn),i=a(this,On);for(const o of t)o in a(this,Rn)?s.add(r[o]):o in i&&i[o].forEach(s.add,s);return this}recordNamedDependency(e,t){return a(this,hl).has(t)&&a(this,In).add(a(this,hl).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Sc]),a(this,Lr)){const s=Jg(a(this,Lr),e),{dependencies:r}=s;a(this,In).forEach(r.add,r),a(this,Zs).forEach(r.add,r),a(this,dl).forEach(r.add,r),r.delete(e),s.isRenderingOperation=!0}if(a(this,_i)===e){const s=xE(a(this,Oe)[0]*256/a(this,fl)),r=xE(a(this,Oe)[1]*256/a(this,pl)),i=TE(a(this,Oe)[2]*256/a(this,fl)),o=TE(a(this,Oe)[3]*256/a(this,pl));Yg(a(this,bi),e,s,r,i,o);for(const l of a(this,In))l!==e&&Yg(a(this,bi),l,s,r,i,o);for(const l of a(this,Zs))l!==e&&Yg(a(this,bi),l,s,r,i,o);for(const l of a(this,dl))l!==e&&Yg(a(this,bi),l,s,r,i,o);t||(a(this,In).clear(),g(this,_i,-1))}return this}recordShowTextOperation(e,t=!1){const s=Array.from(a(this,In));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const r of s)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(e,t=!1){return a(this,_i)===e&&(g(this,_i,-1),a(this,Ce)[0]=Math.max(a(this,Ce)[0],a(this,Oe)[0]),a(this,Ce)[1]=Math.max(a(this,Ce)[1],a(this,Oe)[1]),a(this,Ce)[2]=Math.min(a(this,Ce)[2],a(this,Oe)[2]),a(this,Ce)[3]=Math.min(a(this,Ce)[3],a(this,Oe)[3]),t||a(this,In).clear()),this}_takePendingDependencies(){const e=a(this,In);return g(this,In,new Set),e}_extractOperation(e){const t=a(this,ip).get(e);return a(this,ip).delete(e),t}_pushPendingDependencies(e){for(const t of e)a(this,In).add(t)}take(){return a(this,Uu).clear(),new UM(a(this,cn),a(this,bi))}takeDebugMetadata(){return a(this,Lr)}}Rn=new WeakMap,On=new WeakMap,hl=new WeakMap,Zs=new WeakMap,dl=new WeakMap,wi=new WeakMap,Ce=new WeakMap,Oe=new WeakMap,_i=new WeakMap,In=new WeakMap,ip=new WeakMap,Uu=new WeakMap,fl=new WeakMap,pl=new WeakMap,bi=new WeakMap,cn=new WeakMap,Lr=new WeakMap,op=new WeakSet,n_=function(e,t){const s=new ArrayBuffer(e*4);g(this,bi,new Uint8ClampedArray(s)),g(this,cn,new Uint32Array(s)),t&&t.length>0?(a(this,cn).set(t),a(this,cn).fill(t_,t.length)):a(this,cn).fill(t_)};var Ne,rt,er,$u,zu;const yS=class yS{constructor(e,t,s){b(this,Ne);b(this,rt);b(this,er);b(this,$u,0);b(this,zu,0);if(e instanceof yS&&a(e,er)===!!s)return e;g(this,Ne,e),g(this,rt,t),g(this,er,!!s)}growOperationsCount(){throw new Error("Unreachable")}save(e){return bt(this,zu)._++,a(this,Ne).save(a(this,rt)),this}restore(e){return a(this,zu)>0&&(a(this,Ne).restore(a(this,rt)),bt(this,zu)._--),this}recordOpenMarker(e){return bt(this,$u)._++,this}getOpenMarker(){return a(this,$u)>0?a(this,rt):a(this,Ne).getOpenMarker()}recordCloseMarker(e){return bt(this,$u)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return a(this,Ne).pushBaseTransform(e),this}popBaseTransform(){return a(this,Ne).popBaseTransform(),this}recordSimpleData(e,t){return a(this,Ne).recordSimpleData(e,a(this,rt)),this}recordIncrementalData(e,t){return a(this,Ne).recordIncrementalData(e,a(this,rt)),this}resetIncrementalData(e,t){return a(this,Ne).resetIncrementalData(e,a(this,rt)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return a(this,Ne).recordSimpleDataFromNamed(e,t,a(this,rt)),this}recordFutureForcedDependency(e,t){return a(this,Ne).recordFutureForcedDependency(e,a(this,rt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return a(this,Ne).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return a(this,Ne).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return a(this,er)||a(this,Ne).resetBBox(a(this,rt)),this}recordClipBox(e,t,s,r,i,o){return a(this,er)||a(this,Ne).recordClipBox(a(this,rt),t,s,r,i,o),this}recordBBox(e,t,s,r,i,o){return a(this,er)||a(this,Ne).recordBBox(a(this,rt),t,s,r,i,o),this}recordCharacterBBox(e,t,s,r,i,o,l){return a(this,er)||a(this,Ne).recordCharacterBBox(a(this,rt),t,s,r,i,o,l),this}recordFullPageBBox(e){return a(this,er)||a(this,Ne).recordFullPageBBox(a(this,rt)),this}getSimpleIndex(e){return a(this,Ne).getSimpleIndex(e)}recordDependencies(e,t){return a(this,Ne).recordDependencies(a(this,rt),t),this}recordNamedDependency(e,t){return a(this,Ne).recordNamedDependency(a(this,rt),t),this}recordOperation(e){return a(this,Ne).recordOperation(a(this,rt),!0),this}recordShowTextOperation(e){return a(this,Ne).recordShowTextOperation(a(this,rt),!0),this}bboxToClipBoxDropOperation(e){return a(this,er)||a(this,Ne).bboxToClipBoxDropOperation(a(this,rt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Ne=new WeakMap,rt=new WeakMap,er=new WeakMap,$u=new WeakMap,zu=new WeakMap;let xy=yS;const bs={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Yt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function s_(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,s),n.clip(r)}class uS{isModifyingCurrentTransform(){return!1}getPattern(){Fe("Abstract method `getPattern` called.")}}class zM extends uS{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let s,r=this._p0,i=this._p1;if(t&&(r=r.slice(),i=i.slice(),V.applyTransform(r,t),V.applyTransform(i,t)),this._type==="axial")s=e.createLinearGradient(r[0],r[1],i[0],i[1]);else if(this._type==="radial"){let o=this._r0,l=this._r1;if(t){const c=new Float32Array(2);V.singularValueDecompose2dScale(t,c),o*=c[0],l*=c[0]}s=e.createRadialGradient(r[0],r[1],o,i[0],i[1],l)}for(const o of this._colorStops)s.addColorStop(o[0],o[1]);return s}getPattern(e,t,s,r){let i;if(r===Yt.STROKE||r===Yt.FILL){if(this.isOriginBased()){let f=V.transform(s,t.baseTransform);this.matrix&&(f=V.transform(f,this.matrix));const p=.001,y=Math.hypot(f[0],f[1]),v=Math.hypot(f[2],f[3]),S=(f[0]*f[2]+f[1]*f[3])/(y*v);if(Math.abs(S)<p)if(this.isRadial()){if(Math.abs(y-v)<p)return this._createGradient(e,f)}else return this._createGradient(e,f)}const o=t.current.getClippedPathBoundingBox(r,Je(e))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",l,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-o[0],-o[1]),s=V.transform(s,[1,0,0,1,o[0],o[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),s_(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),i=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(s);i.setTransform(d)}else s_(e,this._bbox),i=this._createGradient(e);return i}}function gw(n,e,t,s,r,i,o,l){const c=e.coords,u=e.colors,h=n.data,d=n.width*4;let f;c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=i,i=o,o=f),c[s+1]>c[r+1]&&(f=s,s=r,r=f,f=o,o=l,l=f),c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=i,i=o,o=f);const p=(c[t]+e.offsetX)*e.scaleX,y=(c[t+1]+e.offsetY)*e.scaleY,v=(c[s]+e.offsetX)*e.scaleX,S=(c[s+1]+e.offsetY)*e.scaleY,m=(c[r]+e.offsetX)*e.scaleX,w=(c[r+1]+e.offsetY)*e.scaleY;if(y>=w)return;const _=u[i],E=u[i+1],k=u[i+2],C=u[o],x=u[o+1],P=u[o+2],I=u[l],N=u[l+1],j=u[l+2],ee=Math.round(y),se=Math.round(w);let Q,re,K,M,O,R,T,L;for(let F=ee;F<=se;F++){if(F<S){const fe=F<y?0:(y-F)/(y-S);Q=p-(p-v)*fe,re=_-(_-C)*fe,K=E-(E-x)*fe,M=k-(k-P)*fe}else{let fe;F>w?fe=1:S===w?fe=0:fe=(S-F)/(S-w),Q=v-(v-m)*fe,re=C-(C-I)*fe,K=x-(x-N)*fe,M=P-(P-j)*fe}let $;F<y?$=0:F>w?$=1:$=(y-F)/(y-w),O=p-(p-m)*$,R=_-(_-I)*$,T=E-(E-N)*$,L=k-(k-j)*$;const J=Math.round(Math.min(Q,O)),ie=Math.round(Math.max(Q,O));let pe=d*F+J*4;for(let fe=J;fe<=ie;fe++)$=(Q-fe)/(Q-O),$<0?$=0:$>1&&($=1),h[pe++]=re-(re-R)*$|0,h[pe++]=K-(K-T)*$|0,h[pe++]=M-(M-L)*$|0,h[pe++]=255}}function HM(n,e,t){const s=e.coords,r=e.colors;let i,o;switch(e.type){case T0.LATTICE:const l=e.verticesPerRow,c=Math.floor(s.length/l)-1,u=l-1;for(i=0;i<c;i++){let h=i*l;for(let d=0;d<u;d++,h++)gw(n,t,s[h],s[h+1],s[h+l],r[h],r[h+1],r[h+l]),gw(n,t,s[h+l+1],s[h+1],s[h+l],r[h+l+1],r[h+1],r[h+l])}break;case T0.TRIANGLES:for(i=0,o=s.length;i<o;i+=3)gw(n,t,s[i],s[i+1],s[i+2],r[i],r[i+1],r[i+2]);break;default:throw new Error("illegal figure")}}class VM extends uS{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const l=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-l,h=Math.ceil(this._bounds[3])-c,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),p=u/d,y=h/f,v={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-c,scaleX:1/p,scaleY:1/y},S=d+2*2,m=f+2*2,w=s.getCanvas("mesh",S,m),_=w.context,E=_.createImageData(d,f);if(t){const C=E.data;for(let x=0,P=C.length;x<P;x+=4)C[x]=t[0],C[x+1]=t[1],C[x+2]=t[2],C[x+3]=255}for(const C of this._figures)HM(E,C,v);return _.putImageData(E,2,2),{canvas:w.canvas,offsetX:l-2*p,offsetY:c-2*y,scaleX:p,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,r){s_(e,this._bbox);const i=new Float32Array(2);if(r===Yt.SHADING)V.singularValueDecompose2dScale(Je(e),i);else if(this.matrix){V.singularValueDecompose2dScale(this.matrix,i);const[l,c]=i;V.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=l,i[1]*=c}else V.singularValueDecompose2dScale(t.baseTransform,i);const o=this._createMeshCanvas(i,r===Yt.SHADING?null:this._background,t.cachedCanvases);return r!==Yt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class WM extends uS{getPattern(){return"hotpink"}}function GM(n){switch(n[0]){case"RadialAxial":return new zM(n);case"Mesh":return new VM(n);case"Dummy":return new WM}throw new Error(`Unknown IR type: ${n[0]}`)}const PE={COLORED:1,UNCOLORED:2},zy=class zy{constructor(e,t,s,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e,t){var R,T;const{bbox:s,operatorList:r,paintType:i,tilingType:o,color:l,canvasGraphicsFactory:c}=this;let{xstep:u,ystep:h}=this;u=Math.abs(u),h=Math.abs(h),Sv("TilingType: "+o);const d=s[0],f=s[1],p=s[2],y=s[3],v=p-d,S=y-f,m=new Float32Array(2);V.singularValueDecompose2dScale(this.matrix,m);const[w,_]=m;V.singularValueDecompose2dScale(this.baseTransform,m);const E=w*m[0],k=_*m[1];let C=v,x=S,P=!1,I=!1;const N=Math.ceil(u*E),j=Math.ceil(h*k),ee=Math.ceil(v*E),se=Math.ceil(S*k);N>=ee?C=u:P=!0,j>=se?x=h:I=!0;const Q=this.getSizeAndScale(C,this.ctx.canvas.width,E),re=this.getSizeAndScale(x,this.ctx.canvas.height,k),K=e.cachedCanvases.getCanvas("pattern",Q.size,re.size),M=K.context,O=c.createCanvasGraphics(M,t);if(O.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(O,i,l),M.translate(-Q.scale*d,-re.scale*f),O.transform(0,Q.scale,0,0,re.scale,0,0),M.save(),(R=O.dependencyTracker)==null||R.save(),this.clipBbox(O,d,f,p,y),O.baseTransform=Je(O.ctx),O.executeOperatorList(r),O.endDrawing(),(T=O.dependencyTracker)==null||T.restore(),M.restore(),P||I){const L=K.canvas;P&&(C=u),I&&(x=h);const F=this.getSizeAndScale(C,this.ctx.canvas.width,E),$=this.getSizeAndScale(x,this.ctx.canvas.height,k),J=F.size,ie=$.size,pe=e.cachedCanvases.getCanvas("pattern-workaround",J,ie),fe=pe.context,Ot=P?Math.floor(v/u):0,wa=I?Math.floor(S/h):0;for(let Hs=0;Hs<=Ot;Hs++)for(let fn=0;fn<=wa;fn++)fe.drawImage(L,J*Hs,ie*fn,J,ie,0,0,J,ie);return{canvas:pe.canvas,scaleX:F.scale,scaleY:$.scale,offsetX:d,offsetY:f}}return{canvas:K.canvas,scaleX:Q.scale,scaleY:re.scale,offsetX:d,offsetY:f}}getSizeAndScale(e,t,s){const r=Math.max(zy.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*s);return i>=r?i=r:s=i/e,{scale:s,size:i}}clipBbox(e,t,s,r,i){const o=r-t,l=i-s;e.ctx.rect(t,s,o,l),V.axialAlignedBoundingBox([t,s,r,i],Je(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const r=e.ctx,i=e.current;switch(t){case PE.COLORED:const{fillStyle:o,strokeStyle:l}=this.ctx;r.fillStyle=i.fillColor=o,r.strokeStyle=i.strokeColor=l;break;case PE.UNCOLORED:r.fillStyle=r.strokeStyle=s,i.fillColor=i.strokeColor=s;break;default:throw new rM(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,r,i){let o=s;r!==Yt.SHADING&&(o=V.transform(o,t.baseTransform),this.matrix&&(o=V.transform(o,this.matrix)));const l=this.createPatternCanvas(t,i);let c=new DOMMatrix(o);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const u=e.createPattern(l.canvas,"repeat");return u.setTransform(c),u}};B(zy,"MAX_PATTERN_SIZE",3e3);let r_=zy;function qM({src:n,srcPos:e=0,dest:t,width:s,height:r,nonBlackColor:i=4294967295,inverseDecode:o=!1}){const l=Rt.isLittleEndian?4278190080:255,[c,u]=o?[i,l]:[l,i],h=s>>3,d=s&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let y=0;y<r;y++){for(const S=e+h;e<S;e++){const m=e<f?n[e]:255;t[p++]=m&128?u:c,t[p++]=m&64?u:c,t[p++]=m&32?u:c,t[p++]=m&16?u:c,t[p++]=m&8?u:c,t[p++]=m&4?u:c,t[p++]=m&2?u:c,t[p++]=m&1?u:c}if(d===0)continue;const v=e<f?n[e++]:255;for(let S=0;S<d;S++)t[p++]=v&1<<7-S?u:c}return{srcPos:e,destPos:p}}const RE=16,OE=100,KM=15,IE=10,Nn=16,mw=new DOMMatrix,us=new Float32Array(2),Kc=new Float32Array([1/0,1/0,-1/0,-1/0]);function XM(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,r,i,o,l){e.transform(t,s,r,i,o,l),this.__originalTransform(t,s,r,i,o,l)},n.setTransform=function(t,s,r,i,o,l){e.setTransform(t,s,r,i,o,l),this.__originalSetTransform(t,s,r,i,o,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,r,i,o,l){e.bezierCurveTo(t,s,r,i,o,l),this.__originalBezierCurveTo(t,s,r,i,o,l)},n.rect=function(t,s,r,i){e.rect(t,s,r,i),this.__originalRect(t,s,r,i)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class YM{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,s)):(r=this.canvasFactory.create(t,s),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Qg(n,e,t,s,r,i,o,l,c,u){const[h,d,f,p,y,v]=Je(n);if(d===0&&f===0){const w=o*h+y,_=Math.round(w),E=l*p+v,k=Math.round(E),C=(o+c)*h+y,x=Math.abs(Math.round(C)-_)||1,P=(l+u)*p+v,I=Math.abs(Math.round(P)-k)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(p),_,k),n.drawImage(e,t,s,r,i,0,0,x,I),n.setTransform(h,d,f,p,y,v),[x,I]}if(h===0&&p===0){const w=l*f+y,_=Math.round(w),E=o*d+v,k=Math.round(E),C=(l+u)*f+y,x=Math.abs(Math.round(C)-_)||1,P=(o+c)*d+v,I=Math.abs(Math.round(P)-k)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,_,k),n.drawImage(e,t,s,r,i,0,0,I,x),n.setTransform(h,d,f,p,y,v),[I,x]}n.drawImage(e,t,s,r,i,o,l,c,u);const S=Math.hypot(h,d),m=Math.hypot(f,p);return[S*c,m*u]}class LE{constructor(e,t,s){B(this,"alphaIsShape",!1);B(this,"fontSize",0);B(this,"fontSizeScale",1);B(this,"textMatrix",null);B(this,"textMatrixScale",1);B(this,"fontMatrix",x0);B(this,"leading",0);B(this,"x",0);B(this,"y",0);B(this,"lineX",0);B(this,"lineY",0);B(this,"charSpacing",0);B(this,"wordSpacing",0);B(this,"textHScale",1);B(this,"textRenderingMode",St.FILL);B(this,"textRise",0);B(this,"fillColor","#000000");B(this,"strokeColor","#000000");B(this,"patternFill",!1);B(this,"patternStroke",!1);B(this,"fillAlpha",1);B(this,"strokeAlpha",1);B(this,"lineWidth",1);B(this,"activeSMask",null);B(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Kc.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Yt.FILL,t=null){const s=this.minMax.slice();if(e===Yt.STROKE){t||Fe("Stroke bounding box must include transform."),V.singularValueDecompose2dScale(t,us);const r=us[0]*this.lineWidth/2,i=us[1]*this.lineWidth/2;s[0]-=r,s[1]-=i,s[2]+=r,s[3]+=i}return s}updateClipFromPath(){const e=V.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Kc,0)}getClippedPathBoundingBox(e=Yt.FILL,t=null){return V.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function DE(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,r=t%Nn,i=(t-r)/Nn,o=r===0?i:i+1,l=n.createImageData(s,Nn);let c=0,u;const h=e.data,d=l.data;let f,p,y,v;if(e.kind===pm.GRAYSCALE_1BPP){const S=h.byteLength,m=new Uint32Array(d.buffer,0,d.byteLength>>2),w=m.length,_=s+7>>3,E=4294967295,k=Rt.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(y=f<i?Nn:r,u=0,p=0;p<y;p++){const C=S-c;let x=0;const P=C>_?s:C*8-7,I=P&-8;let N=0,j=0;for(;x<I;x+=8)j=h[c++],m[u++]=j&128?E:k,m[u++]=j&64?E:k,m[u++]=j&32?E:k,m[u++]=j&16?E:k,m[u++]=j&8?E:k,m[u++]=j&4?E:k,m[u++]=j&2?E:k,m[u++]=j&1?E:k;for(;x<P;x++)N===0&&(j=h[c++],N=128),m[u++]=j&N?E:k,N>>=1}for(;u<w;)m[u++]=0;n.putImageData(l,0,f*Nn)}}else if(e.kind===pm.RGBA_32BPP){for(p=0,v=s*Nn*4,f=0;f<i;f++)d.set(h.subarray(c,c+v)),c+=v,n.putImageData(l,0,p),p+=Nn;f<o&&(v=s*r*4,d.set(h.subarray(c,c+v)),n.putImageData(l,0,p))}else if(e.kind===pm.RGB_24BPP)for(y=Nn,v=s*y,f=0;f<o;f++){for(f>=i&&(y=r,v=s*y),u=0,p=v;p--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;n.putImageData(l,0,f*Nn)}else throw new Error(`bad image kind: ${e.kind}`)}function NE(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,r=t%Nn,i=(t-r)/Nn,o=r===0?i:i+1,l=n.createImageData(s,Nn);let c=0;const u=e.data,h=l.data;for(let d=0;d<o;d++){const f=d<i?Nn:r;({srcPos:c}=qM({src:u,srcPos:c,dest:h,width:s,height:f,nonBlackColor:0})),n.putImageData(l,0,d*Nn)}}function td(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Zg(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function ME(n,e){if(e)return!0;V.singularValueDecompose2dScale(n,us);const t=Math.fround(Xr.pixelRatio*pa.PDF_TO_CSS_UNITS);return us[0]<=t&&us[1]<=t}const JM=["butt","round","square"],QM=["miter","round","bevel"],ZM={},FE={};var gr,i_,o_,a_;const vS=class vS{constructor(e,t,s,r,i,{optionalContentConfig:o,markedContentStack:l=null},c,u,h){b(this,gr);this.ctx=e,this.current=new LE(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=r,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new YM(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=h??null}getObject(e,t,s=null){var r;return typeof t=="string"?((r=this.dependencyTracker)==null||r.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:r=null}){const i=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,i,o),this.ctx.fillStyle=l,s){const c=this.cachedCanvases.getCanvas("transparent",i,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Je(this.compositeCtx))}this.ctx.save(),Zg(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Je(this.ctx)}executeOperatorList(e,t,s,r,i){var m;const o=e.argsArray,l=e.fnArray;let c=t||0;const u=o.length;if(u===c)return c;const h=u-c>IE&&typeof s=="function",d=h?Date.now()+KM:0;let f=0;const p=this.commonObjs,y=this.objs;let v,S;for(;;){if(r!==void 0&&c===r.nextBreakPoint)return r.breakIt(c,s),c;if(!i||i(c))if(v=l[c],S=o[c]??null,v!==mf.dependency)S===null?this[v](c):this[v](c,...S);else for(const w of S){(m=this.dependencyTracker)==null||m.recordNamedData(w,c);const _=w.startsWith("g_")?p:y;if(!_.has(w))return _.get(w,s),c}if(c++,c===u)return c;if(h&&++f>IE){if(Date.now()>d)return s(),c;f=0}}}endDrawing(){A(this,gr,i_).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),A(this,gr,o_).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,r=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=s,c=r,u="prescale1",h,d;for(;i>2&&l>1||o>2&&c>1;){let f=l,p=c;i>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),i/=l/f),o>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/p),h=this.cachedCanvases.getCanvas(u,f,p),d=h.context,d.clearRect(0,0,f,p),d.drawImage(e,0,0,l,c,0,0,f,p),e=h.canvas,l=f,c=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e,t){var N,j;const s=this.ctx,{width:r,height:i}=t,o=this.current.fillColor,l=this.current.patternFill,c=Je(s);let u,h,d,f;if((t.bitmap||t.data)&&t.count>1){const ee=t.bitmap||t.data.buffer;h=JSON.stringify(l?c:[c.slice(0,4),o]),u=this._cachedBitmapsMap.get(ee),u||(u=new Map,this._cachedBitmapsMap.set(ee,u));const se=u.get(h);if(se&&!l){const Q=Math.round(Math.min(c[0],c[2])+c[4]),re=Math.round(Math.min(c[1],c[3])+c[5]);return(N=this.dependencyTracker)==null||N.recordDependencies(e,bs.transformAndFill),{canvas:se,offsetX:Q,offsetY:re}}d=se}d||(f=this.cachedCanvases.getCanvas("maskCanvas",r,i),NE(f.context,t));let p=V.transform(c,[1/r,0,0,-1/i,0,0]);p=V.transform(p,[1,0,0,1,0,-i]);const y=Kc.slice();V.axialAlignedBoundingBox([0,0,r,i],p,y);const[v,S,m,w]=y,_=Math.round(m-v)||1,E=Math.round(w-S)||1,k=this.cachedCanvases.getCanvas("fillCanvas",_,E),C=k.context,x=v,P=S;C.translate(-x,-P),C.transform(...p),d||(d=this._scaleImage(f.canvas,vr(C)),d=d.img,u&&l&&u.set(h,d)),C.imageSmoothingEnabled=ME(Je(C),t.interpolate),Qg(C,d,0,0,d.width,d.height,0,0,r,i),C.globalCompositeOperation="source-in";const I=V.transform(vr(C),[1,0,0,1,-x,-P]);return C.fillStyle=l?o.getPattern(s,this,I,Yt.FILL,e):o,C.fillRect(0,0,r,i),u&&!l&&(this.cachedCanvases.delete("fillCanvas"),u.set(h,k.canvas)),(j=this.dependencyTracker)==null||j.recordDependencies(e,bs.transformAndFill),{canvas:k.canvas,offsetX:Math.round(x),offsetY:Math.round(P)}}setLineWidth(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",e),this.ctx.lineCap=JM[t]}setLineJoin(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",e),this.ctx.lineJoin=QM[t]}setMiterLimit(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("dash",e);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var s,r,i,o,l;for(const[c,u]of t)switch(c){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(r=this.dependencyTracker)==null||r.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(i=this.dependencyTracker)==null||i.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(o=this.dependencyTracker)==null||o.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(l=this.dependencyTracker)==null||l.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,s);this.suspendedCtx=this.ctx;const o=this.ctx=i.context;o.setTransform(this.suspendedCtx.getTransform()),td(this.suspendedCtx,o),XM(o,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),td(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,r){const i=r[0],o=r[1],l=r[2]-i,c=r[3]-o;l===0||c===0||(this.genericComposeSMask(t.context,s,l,c,t.subtype,t.backdrop,t.transferMap,i,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,r,i,o,l,c,u,h,d){let f=e.canvas,p=c-h,y=u-d;if(o)if(p<0||y<0||p+s>f.width||y+r>f.height){const S=this.cachedCanvases.getCanvas("maskExtension",s,r),m=S.context;m.drawImage(f,-p,-y),m.globalCompositeOperation="destination-atop",m.fillStyle=o,m.fillRect(0,0,s,r),m.globalCompositeOperation="source-over",f=S.canvas,p=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const S=new Path2D;S.rect(p,y,s,r),e.clip(S),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(p,y,s,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&l?t.filter=this.filterFactory.addAlphaFilter(l):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(l));const v=new Path2D;v.rect(c,u,s,r),t.clip(v),t.globalCompositeOperation="destination-in",t.drawImage(f,p,y,s,r,c,u,s,r),t.restore()}save(e){var s;this.inSMaskMode&&td(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(s=this.dependencyTracker)==null||s.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&td(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,r,i,o,l){var c;(c=this.dependencyTracker)==null||c.recordIncrementalData("transform",e),this.ctx.transform(t,s,r,i,o,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,r){let[i]=s;if(!r){i||(i=s[0]=new Path2D),this[t](e,i);return}if(this.dependencyTracker!==null){const o=t===mf.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,r[0]-o,r[2]+o,r[1]-o,r[3]+o).recordDependencies(e,["transform"])}i instanceof Path2D||(i=s[0]=Wx(i)),V.axialAlignedBoundingBox(r,Je(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){var o;const r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const l=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=i.getPattern(r,this,vr(r),Yt.STROKE,e),l){const c=new Path2D;c.addPath(t,r.getTransform().invertSelf().multiplySelf(l)),t=c}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);(o=this.dependencyTracker)==null||o.recordDependencies(e,bs.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Yt.STROKE,Je(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){var u,h,d;const r=this.ctx,i=this.current.fillColor,o=this.current.patternFill;let l=!1;if(o){const f=i.isModifyingCurrentTransform()?r.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),r.save(),r.fillStyle=i.getPattern(r,this,vr(r),Yt.FILL,e),f){const p=new Path2D;p.addPath(t,r.getTransform().invertSelf().multiplySelf(f)),t=p}l=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),(h=this.dependencyTracker)==null||h.recordDependencies(e,bs.fill),l&&(r.restore(),(d=this.dependencyTracker)==null||d.restore(e)),s&&this.consumePath(e,t,c)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var s;this.ctx.fill(t),(s=this.dependencyTracker)==null||s.recordDependencies(e,bs.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=ZM}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=FE}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;t!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",e),r.recordCloseMarker(e)}if(t!==void 0){const r=new Path2D,i=s.getTransform().invertSelf();for(const{transform:o,x:l,y:c,fontSize:u,path:h}of t)h&&r.addPath(h,new DOMMatrix(o).preMultiplySelf(i).translate(l,c).scale(u,-u));s.clip(r)}delete this.pendingTextPaths}setCharSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){var d,f;(d=this.dependencyTracker)==null||d.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const r=this.commonObjs.get(t),i=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=r.fontMatrix||x0,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&oe("Invalid font matrix for font "+t),s<0?(s=-s,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=s,r.isType3Font)return;const o=r.loadedName||"sans-serif",l=((f=r.systemFontInfo)==null?void 0:f.css)||`"${o}", ${r.fallbackName}`;let c="normal";r.black?c="900":r.bold&&(c="bold");const u=r.italic?"italic":"normal";let h=s;s<RE?h=RE:s>OE&&(h=OE),this.current.fontSizeScale=s/h,this.ctx.font=`${u} ${c} ${h}px ${l}`}setTextRenderingMode(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,s,r,i,o){var m,w,_,E;const l=this.ctx,c=this.current,u=c.font,h=c.textRenderingMode,d=c.fontSize/c.fontSizeScale,f=h&St.FILL_STROKE_MASK,p=!!(h&St.ADD_TO_PATH_FLAG),y=c.patternFill&&!u.missingFile,v=c.patternStroke&&!u.missingFile;let S;if((u.disableFontFace||p||y||v)&&!u.missingFile&&(S=u.getPathGenerator(this.commonObjs,t)),S&&(u.disableFontFace||y||v)){l.save(),l.translate(s,r),l.scale(d,-d),(m=this.dependencyTracker)==null||m.recordCharacterBBox(e,l,u);let k;if(f===St.FILL||f===St.FILL_STROKE)if(i){k=l.getTransform(),l.setTransform(...i);const C=A(this,gr,a_).call(this,S,k,i);l.fill(C)}else l.fill(S);if(f===St.STROKE||f===St.FILL_STROKE)if(o){k||(k=l.getTransform()),l.setTransform(...o);const{a:C,b:x,c:P,d:I}=k,N=V.inverseTransform(o),j=V.transform([C,x,P,I,0,0],N);V.singularValueDecompose2dScale(j,us),l.lineWidth*=Math.max(us[0],us[1])/d,l.stroke(A(this,gr,a_).call(this,S,k,o))}else l.lineWidth/=d,l.stroke(S);l.restore()}else(f===St.FILL||f===St.FILL_STROKE)&&(l.fillText(t,s,r),(w=this.dependencyTracker)==null||w.recordCharacterBBox(e,l,u,d,s,r,()=>l.measureText(t))),(f===St.STROKE||f===St.FILL_STROKE)&&(this.dependencyTracker&&((_=this.dependencyTracker)==null||_.recordCharacterBBox(e,l,u,d,s,r,()=>l.measureText(t)).recordDependencies(e,bs.stroke)),l.strokeText(t,s,r));p&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Je(l),x:s,y:r,fontSize:d,path:S}),(E=this.dependencyTracker)==null||E.recordCharacterBBox(e,l,u,d,s,r))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){s=!0;break}return ae(this,"isFontSubpixelAAEnabled",s)}showText(e,t){var j,ee,se,Q;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,bs.showText).resetBBox(e),this.current.textRenderingMode&St.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,r=s.font;if(r.isType3Font){this.showType3Text(e,t),(j=this.dependencyTracker)==null||j.recordShowTextOperation(e);return}const i=s.fontSize;if(i===0){(ee=this.dependencyTracker)==null||ee.recordOperation(e);return}const o=this.ctx,l=s.fontSizeScale,c=s.charSpacing,u=s.wordSpacing,h=s.fontDirection,d=s.textHScale*h,f=t.length,p=r.vertical,y=p?1:-1,v=r.defaultVMetrics,S=i*s.fontMatrix[0],m=s.textRenderingMode===St.FILL&&!r.disableFontFace&&!s.patternFill;o.save(),s.textMatrix&&o.transform(...s.textMatrix),o.translate(s.x,s.y+s.textRise),h>0?o.scale(d,-1):o.scale(d,1);let w,_;const E=s.textRenderingMode&St.FILL_STROKE_MASK,k=E===St.FILL||E===St.FILL_STROKE,C=E===St.STROKE||E===St.FILL_STROKE;if(k&&s.patternFill){o.save();const re=s.fillColor.getPattern(o,this,vr(o),Yt.FILL,e);w=Je(o),o.restore(),o.fillStyle=re}if(C&&s.patternStroke){o.save();const re=s.strokeColor.getPattern(o,this,vr(o),Yt.STROKE,e);_=Je(o),o.restore(),o.strokeStyle=re}let x=s.lineWidth;const P=s.textMatrixScale;if(P===0||x===0?C&&(x=this.getSinglePixelWidth()):x/=P,l!==1&&(o.scale(l,l),x/=l),o.lineWidth=x,r.isInvalidPDFjsFont){const re=[];let K=0;for(const O of t)re.push(O.unicode),K+=O.width;const M=re.join("");if(o.fillText(M,0,0),this.dependencyTracker!==null){const O=o.measureText(M);this.dependencyTracker.recordBBox(e,this.ctx,-O.actualBoundingBoxLeft,O.actualBoundingBoxRight,-O.actualBoundingBoxAscent,O.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=K*S*d,o.restore(),this.compose();return}let I=0,N;for(N=0;N<f;++N){const re=t[N];if(typeof re=="number"){I+=y*re*i/1e3;continue}let K=!1;const M=(re.isSpace?u:0)+c,O=re.fontChar,R=re.accent;let T,L,F=re.width;if(p){const ie=re.vmetric||v,pe=-(re.vmetric?ie[1]:F*.5)*S,fe=ie[2]*S;F=ie?-ie[0]:F,T=pe/l,L=(I+fe)/l}else T=I/l,L=0;let $;if(r.remeasure&&F>0){$=o.measureText(O);const ie=$.width*1e3/i*l;if(F<ie&&this.isFontSubpixelAAEnabled){const pe=F/ie;K=!0,o.save(),o.scale(pe,1),T/=pe}else F!==ie&&(T+=(F-ie)/2e3*i/l)}if(this.contentVisible&&(re.isInFont||r.missingFile)){if(m&&!R)o.fillText(O,T,L),(se=this.dependencyTracker)==null||se.recordCharacterBBox(e,o,$?{bbox:null}:r,i/l,T,L,()=>$??o.measureText(O));else if(this.paintChar(e,O,T,L,w,_),R){const ie=T+i*R.offset.x/l,pe=L-i*R.offset.y/l;this.paintChar(e,R.fontChar,ie,pe,w,_)}}const J=p?F*S-M*h:F*S+M*h;I+=J,K&&o.restore()}p?s.y-=I:s.x+=I*d,o.restore(),this.compose(),(Q=this.dependencyTracker)==null||Q.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,r=this.current,i=r.font,o=r.fontSize,l=r.fontDirection,c=i.vertical?1:-1,u=r.charSpacing,h=r.wordSpacing,d=r.textHScale*l,f=r.fontMatrix||x0,p=t.length,y=r.textRenderingMode===St.INVISIBLE;let v,S,m,w;if(y||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),r.textMatrix&&s.transform(...r.textMatrix),s.translate(r.x,r.y+r.textRise),s.scale(d,l);const _=this.dependencyTracker;for(this.dependencyTracker=_?new xy(_,e):null,v=0;v<p;++v){if(S=t[v],typeof S=="number"){w=c*S*o/1e3,this.ctx.translate(w,0),r.x+=w*d;continue}const E=(S.isSpace?h:0)+u,k=i.charProcOperatorList[S.operatorListId];k?this.contentVisible&&(this.save(),s.scale(o,o),s.transform(...f),this.executeOperatorList(k),this.restore()):oe(`Type3 character "${S.operatorListId}" is not available.`);const C=[S.width,0];V.applyTransform(C,f),m=C[0]*o+E,s.translate(m,0),r.x+=m*d}s.restore(),_&&(this.dependencyTracker=_)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,r,i,o,l){var u;const c=new Path2D;c.rect(r,i,o-r,l-i),this.ctx.clip(c),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,r,o,i,l).recordClipBox(e,this.ctx,r,o,i,l),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const r=this.baseTransform||Je(this.ctx),i={createCanvasGraphics:(o,l)=>new vS(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new xy(this.dependencyTracker,l,!0):null)};s=new r_(t,this.ctx,i,r)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=GM(this.getObject(e,t)),this.cachedPatterns.set(t,r)),s&&(r.matrix=s),r}shadingFill(e,t){var o;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const r=this._getPattern(e,t);s.fillStyle=r.getPattern(s,this,vr(s),Yt.SHADING,e);const i=vr(s);if(i){const{width:l,height:c}=s.canvas,u=Kc.slice();V.axialAlignedBoundingBox([0,0,l,c],i,u);const[h,d,f,p]=u;this.ctx.fillRect(h,d,f-h,p-d)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(o=this.dependencyTracker)==null||o.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,bs.transform).recordDependencies(e,bs.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Fe("Should not call beginInlineImage")}beginImageData(){Fe("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){var r;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Je(this.ctx),s)){V.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[i,o,l,c]=s,u=new Path2D;u.rect(i,o,l-i,c-o),this.ctx.clip(u),(r=this.dependencyTracker)==null||r.recordClipBox(e,this.ctx,i,l,o,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var _;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||Sv("TODO: Support non-isolated groups."),t.knockout&&oe("Knockout groups not supported.");const r=Je(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=Kc.slice();V.axialAlignedBoundingBox(t.bbox,Je(s),i);const o=[0,0,s.canvas.width,s.canvas.height];i=V.intersect(i,o)||[0,0,0,0];const l=Math.floor(i[0]),c=Math.floor(i[1]),u=Math.max(Math.ceil(i[2])-l,1),h=Math.max(Math.ceil(i[3])-c,1);this.current.startNewPathAndClipBox([0,0,u,h]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(d,u,h),p=f.context;p.translate(-l,-c),p.transform(...r);let y=new Path2D;const[v,S,m,w]=t.bbox;if(y.rect(v,S,m-v,w-S),t.matrix){const E=new Path2D;E.addPath(y,new DOMMatrix(t.matrix)),y=E}p.clip(y),t.smask&&this.smaskStack.push({canvas:f.canvas,context:p,offsetX:l,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(l,c),s.save()),td(s,p),this.ctx=p,(_=this.dependencyTracker)==null||_.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var i;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,(i=this.dependencyTracker)==null||i.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=Je(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const l=Kc.slice();V.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],o,l),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,s,r,i,o){if(A(this,gr,i_).call(this),Zg(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const l=s[2]-s[0],c=s[3]-s[1];if(o&&this.annotationCanvasMap){r=r.slice(),r[4]-=s[0],r[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=l,s[3]=c,V.singularValueDecompose2dScale(Je(this.ctx),us);const{viewportScale:u}=this,h=Math.ceil(l*this.outputScaleX*u),d=Math.ceil(c*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,d);const{canvas:f,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(t,f),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(us[0],0,0,-us[1],0,c*us[1]),Zg(this.ctx)}else{Zg(this.ctx),this.endPath(e);const u=new Path2D;u.rect(s[0],s[1],l,c),this.ctx.clip(u)}}this.current=new LE(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...r),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),A(this,gr,o_).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var l;if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const r=this.ctx,i=this._createMaskCanvas(e,t),o=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(o,i.offsetX,i.offsetY),(l=this.dependencyTracker)==null||l.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+o.width,i.offsetY,i.offsetY+o.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,r=0,i=0,o,l){var d,f,p;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const c=this.ctx;c.save();const u=Je(c);c.transform(s,r,i,o,0,0);const h=this._createMaskCanvas(e,t);c.setTransform(1,0,0,1,h.offsetX-u[4],h.offsetY-u[5]),(d=this.dependencyTracker)==null||d.resetBBox(e);for(let y=0,v=l.length;y<v;y+=2){const S=V.transform(u,[s,r,i,o,l[y],l[y+1]]);c.drawImage(h.canvas,S[4],S[5]),(f=this.dependencyTracker)==null||f.recordBBox(e,this.ctx,S[4],S[4]+h.canvas.width,S[5],S[5]+h.canvas.height)}c.restore(),this.compose(),(p=this.dependencyTracker)==null||p.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var o,l,c;if(!this.contentVisible)return;const s=this.ctx,r=this.current.fillColor,i=this.current.patternFill;(o=this.dependencyTracker)==null||o.resetBBox(e).recordDependencies(e,bs.transformAndFill);for(const u of t){const{data:h,width:d,height:f,transform:p}=u,y=this.cachedCanvases.getCanvas("maskCanvas",d,f),v=y.context;v.save();const S=this.getObject(e,h,u);NE(v,S),v.globalCompositeOperation="source-in",v.fillStyle=i?r.getPattern(v,this,vr(s),Yt.FILL,e):r,v.fillRect(0,0,d,f),v.restore(),s.save(),s.transform(...p),s.scale(1,-1),Qg(s,y.canvas,0,0,d,f,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(e,s,0,d,0,f),s.restore()}this.compose(),(c=this.dependencyTracker)==null||c.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){oe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,r,i){if(!this.contentVisible)return;const o=this.getObject(e,t);if(!o){oe("Dependent image isn't ready yet");return}const l=o.width,c=o.height,u=[];for(let h=0,d=i.length;h<d;h+=2)u.push({transform:[s,0,0,r,i[h],i[h+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(e,o,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:r}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,r),o=i.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",i.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const s=t.width,r=t.height,i=this.ctx;this.save(e);const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none"),i.scale(1/s,-1/r);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const d=this.cachedCanvases.getCanvas("inlineImage",s,r).context;DE(d,t),l=this.applyTransferMapsToCanvas(d)}const c=this._scaleImage(l,vr(i));i.imageSmoothingEnabled=ME(Je(i),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,i,0,s,-r,0).recordDependencies(e,bs.imageXObject).recordOperation(e),Qg(i,c.img,0,0,c.paintWidth,c.paintHeight,0,-r,s,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){var o,l,c;if(!this.contentVisible)return;const r=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const u=t.width,h=t.height,f=this.cachedCanvases.getCanvas("inlineImage",u,h).context;DE(f,t),i=this.applyTransferMapsToCanvas(f)}(o=this.dependencyTracker)==null||o.resetBBox(e);for(const u of s)r.save(),r.transform(...u.transform),r.scale(1,-1),Qg(r,i,u.x,u.y,u.w,u.h,0,-1,1,1),(l=this.dependencyTracker)==null||l.recordBBox(e,r,0,1,-1,0),r.restore();(c=this.dependencyTracker)==null||c.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,bs.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){var o,l;const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const i=this.ctx;this.pendingClip?(r||(this.pendingClip===FE?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,(o=this.dependencyTracker)==null||o.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(l=this.dependencyTracker)==null||l.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Je(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:r,d:i}=this.ctx.getTransform();let o,l;if(s===0&&r===0){const c=Math.abs(t),u=Math.abs(i);if(c===u)if(e===0)o=l=1/c;else{const h=c*e;o=l=h<1?1/h:1}else if(e===0)o=1/c,l=1/u;else{const h=c*e,d=u*e;o=h<1?1/h:1,l=d<1?1/d:1}}else{const c=Math.abs(t*i-s*r),u=Math.hypot(t,s),h=Math.hypot(r,i);if(e===0)o=h/c,l=u/c;else{const d=e*c;o=h>d?h/d:1,l=u>d?u/d:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:r}}=this,[i,o]=this.getScaleForStroking();if(i===o){s.lineWidth=(r||1)*i,s.stroke(e);return}const l=s.getLineDash();t&&s.save(),s.scale(i,o),mw.a=1/i,mw.d=1/o;const c=new Path2D;if(c.addPath(e,mw),l.length>0){const u=Math.max(i,o);s.setLineDash(l.map(h=>h/u)),s.lineDashOffset/=u}s.lineWidth=r||1,s.stroke(c),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};gr=new WeakSet,i_=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},o_=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},a_=function(e,t,s){const r=new Path2D;return r.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),r};let ou=vS;for(const n in mf)ou.prototype[n]!==void 0&&(ou.prototype[mf[n]]=ou.prototype[n]);var ap,lp;class Gr{static get workerPort(){return a(this,ap)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");g(this,ap,e)}static get workerSrc(){return a(this,lp)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");g(this,lp,e)}}ap=new WeakMap,lp=new WeakMap,b(Gr,ap,null),b(Gr,lp,"");var Hu,cp;class e2{constructor({parsedData:e,rawData:t}){b(this,Hu);b(this,cp);g(this,Hu,e),g(this,cp,t)}getRaw(){return a(this,cp)}get(e){return a(this,Hu).get(e)??null}[Symbol.iterator](){return a(this,Hu).entries()}}Hu=new WeakMap,cp=new WeakMap;const Oc=Symbol("INTERNAL");var up,hp,dp,Vu;class t2{constructor(e,{name:t,intent:s,usage:r,rbGroups:i}){b(this,up,!1);b(this,hp,!1);b(this,dp,!1);b(this,Vu,!0);g(this,up,!!(e&ls.DISPLAY)),g(this,hp,!!(e&ls.PRINT)),this.name=t,this.intent=s,this.usage=r,this.rbGroups=i}get visible(){if(a(this,dp))return a(this,Vu);if(!a(this,Vu))return!1;const{print:e,view:t}=this.usage;return a(this,up)?(t==null?void 0:t.viewState)!=="OFF":a(this,hp)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Oc&&Fe("Internal method `_setVisible` called."),g(this,dp,s),g(this,Vu,t)}}up=new WeakMap,hp=new WeakMap,dp=new WeakMap,Vu=new WeakMap;var Ro,Ie,Wu,Gu,fp,l_;class n2{constructor(e,t=ls.DISPLAY){b(this,fp);b(this,Ro,null);b(this,Ie,new Map);b(this,Wu,null);b(this,Gu,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,g(this,Gu,e.order);for(const s of e.groups)a(this,Ie).set(s.id,new t2(t,s));if(e.baseState==="OFF")for(const s of a(this,Ie).values())s._setVisible(Oc,!1);for(const s of e.on)a(this,Ie).get(s)._setVisible(Oc,!0);for(const s of e.off)a(this,Ie).get(s)._setVisible(Oc,!1);g(this,Wu,this.getHash())}}isVisible(e){if(a(this,Ie).size===0)return!0;if(!e)return Sv("Optional content group not defined."),!0;if(e.type==="OCG")return a(this,Ie).has(e.id)?a(this,Ie).get(e.id).visible:(oe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return A(this,fp,l_).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!a(this,Ie).has(t))return oe(`Optional content group not found: ${t}`),!0;if(a(this,Ie).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!a(this,Ie).has(t))return oe(`Optional content group not found: ${t}`),!0;if(!a(this,Ie).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!a(this,Ie).has(t))return oe(`Optional content group not found: ${t}`),!0;if(!a(this,Ie).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!a(this,Ie).has(t))return oe(`Optional content group not found: ${t}`),!0;if(a(this,Ie).get(t).visible)return!1}return!0}return oe(`Unknown optional content policy ${e.policy}.`),!0}return oe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var i;const r=a(this,Ie).get(e);if(!r){oe(`Optional content group not found: ${e}`);return}if(s&&t&&r.rbGroups.length)for(const o of r.rbGroups)for(const l of o)l!==e&&((i=a(this,Ie).get(l))==null||i._setVisible(Oc,!1,!0));r._setVisible(Oc,!!t,!0),g(this,Ro,null)}setOCGState({state:e,preserveRB:t}){let s;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const i=a(this,Ie).get(r);if(i)switch(s){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!i.visible,t);break}}g(this,Ro,null)}get hasInitialVisibility(){return a(this,Wu)===null||this.getHash()===a(this,Wu)}getOrder(){return a(this,Ie).size?a(this,Gu)?a(this,Gu).slice():[...a(this,Ie).keys()]:null}getGroup(e){return a(this,Ie).get(e)||null}getHash(){if(a(this,Ro)!==null)return a(this,Ro);const e=new AT;for(const[t,s]of a(this,Ie))e.update(`${t}:${s.visible}`);return g(this,Ro,e.hexdigest())}[Symbol.iterator](){return a(this,Ie).entries()}}Ro=new WeakMap,Ie=new WeakMap,Wu=new WeakMap,Gu=new WeakMap,fp=new WeakSet,l_=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let r=1;r<t;r++){const i=e[r];let o;if(Array.isArray(i))o=A(this,fp,l_).call(this,i);else if(a(this,Ie).has(i))o=a(this,Ie).get(i).visible;else return oe(`Optional content group not found: ${i}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class s2{constructor(e,{disableRange:t=!1,disableStream:s=!1}){we(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:i,progressiveDone:o,contentDispositionFilename:l}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,(i==null?void 0:i.length)>0){const c=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)});we(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,r,i;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(i=(r=this._fullRequestReader)==null?void 0:r.onProgress)==null||i.call(r,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){we(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new r2(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new i2(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class r2{constructor(e,t,s=!1,r=null){this._stream=e,this._done=s||!1,this._filename=aS(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class i2{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function o2(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let h=l(t);return h=unescape(h),h=c(h),h=u(h),i(h)}if(t=o(n),t){const h=u(t);return i(h)}if(t=s("filename","i").exec(n),t){t=t[1];let h=l(t);return h=u(h),i(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function r(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),p=vg(d);d=f.decode(p),e=!1}catch{}}return d}function i(h){return e&&/[\x80-\xff]/.test(h)&&(h=r("utf-8",h),e&&(h=r("iso-8859-1",h))),h}function o(h){const d=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(h))!==null;){let[,v,S,m]=f;if(v=parseInt(v,10),v in d){if(v===0)break;continue}d[v]=[S,m]}const y=[];for(let v=0;v<d.length&&v in d;++v){let[S,m]=d[v];m=l(m),S&&(m=unescape(m),v===0&&(m=c(m))),y.push(m)}return y.join("")}function l(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const p=d[f].indexOf('"');p!==-1&&(d[f]=d[f].slice(0,p),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),y=h.slice(d+1).replace(/^[^']*'/,"");return r(f,y)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,p,y){if(p==="q"||p==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,S){return String.fromCharCode(parseInt(S,16))}),r(f,y);try{y=atob(y)}catch{}return r(f,y)})}return""}function NT(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const r=e[s];r!==void 0&&t.append(s,r)}return t}function Ev(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function MT({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(n.get("Content-Length"),10);return!Number.isInteger(i)||(r.suggestedLength=i,i<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function FT(n){const e=n.get("Content-Disposition");if(e){let t=o2(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(aS(t))return t}return null}function Ag(n,e){return new by(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function BT(n){return n===200||n===206}function jT(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function UT(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(oe(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class a2{constructor(e){B(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=NT(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return we(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new c2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class l2{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),r=t.url;fetch(r,jT(s,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=Ev(i.url),!BT(i.status))throw Ag(i.status,r);this._reader=i.body.getReader(),this._headersCapability.resolve();const o=i.headers,{allowRangeRequests:l,suggestedLength:c}=MT({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=c||this._contentLength,this._filename=FT(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new fa("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:UT(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class c2{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${s-1}`);const o=r.url;fetch(o,jT(i,this._withCredentials,this._abortController)).then(l=>{const c=Ev(l.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!BT(l.status))throw Ag(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:UT(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const yw=200,vw=206;function u2(n){const e=n.response;return typeof e!="string"?e:vg(e).buffer}class h2{constructor({url:e,httpHeaders:t,withCredentials:s}){B(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=NT(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,o]of this.headers)t.setRequestHeader(i,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=vw):r.expectedStatus=yw,t.responseType="arraybuffer",we(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var r;const s=this.pendingRequests[e];s&&((r=s.onProgress)==null||r.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){s.onError(r.status);return}const i=r.status||yw;if(!(i===yw&&s.expectedStatus===vw)&&i!==s.expectedStatus){s.onError(r.status);return}const l=u2(r);if(i===vw){const c=r.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:l}):(oe('Missing or invalid "Content-Range" header.'),s.onError(0))}else l?s.onDone({begin:0,chunk:l}):s.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class d2{constructor(e){this._source=e,this._manager=new h2(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return we(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new f2(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new p2(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class f2{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Ev(t.responseURL);const s=t.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...u]=l.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:o}=MT({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=FT(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Ag(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class p2{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Ev((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Ag(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const g2=/^[a-z][a-z0-9\-+.]+:/i;function m2(n){if(g2.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class y2{constructor(e){this.source=e,this.url=m2(e.url),we(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return we(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new v2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new w2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class v2{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=Ag(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new fa("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class w2{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const nd=Symbol("INITIAL_DATA");var qn,pp,c_;class $T{constructor(){b(this,pp);b(this,qn,Object.create(null))}get(e,t=null){if(t){const r=A(this,pp,c_).call(this,e);return r.promise.then(()=>t(r.data)),null}const s=a(this,qn)[e];if(!s||s.data===nd)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=a(this,qn)[e];return!!t&&t.data!==nd}delete(e){const t=a(this,qn)[e];return!t||t.data===nd?!1:(delete a(this,qn)[e],!0)}resolve(e,t=null){const s=A(this,pp,c_).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in a(this,qn)){const{data:s}=a(this,qn)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}g(this,qn,Object.create(null))}*[Symbol.iterator](){for(const e in a(this,qn)){const{data:t}=a(this,qn)[e];t!==nd&&(yield[e,t])}}}qn=new WeakMap,pp=new WeakSet,c_=function(e){var t;return(t=a(this,qn))[e]||(t[e]={...Promise.withResolvers(),data:nd})};const _2=1e5,BE=30;var $E,Oo,Kn,gp,mp,gl,Si,yp,vp,ml,wp,qu,Io,Ku,_p,Xu,yl,bp,Sp,Yu,vl,Ap,Ju,Qu,Ji,zT,HT,u_,ms,km,h_,VT,WT;const Ht=class Ht{constructor({textContentSource:e,container:t,viewport:s}){b(this,Ji);b(this,Oo,Promise.withResolvers());b(this,Kn,null);b(this,gp,!1);b(this,mp,!!(($E=globalThis.FontInspector)!=null&&$E.enabled));b(this,gl,null);b(this,Si,null);b(this,yp,0);b(this,vp,0);b(this,ml,null);b(this,wp,null);b(this,qu,0);b(this,Io,0);b(this,Ku,Object.create(null));b(this,_p,[]);b(this,Xu,null);b(this,yl,[]);b(this,bp,new WeakMap);b(this,Sp,null);var c;if(e instanceof ReadableStream)g(this,Xu,e);else if(typeof e=="object")g(this,Xu,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');g(this,Kn,g(this,wp,t)),g(this,Io,s.scale*Xr.pixelRatio),g(this,qu,s.rotation),g(this,Si,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:i,pageX:o,pageY:l}=s.rawDims;g(this,Sp,[1,0,0,-1,-o,l+i]),g(this,vp,r),g(this,yp,i),A(c=Ht,ms,VT).call(c),t.style.setProperty("--min-font-size",a(Ht,Ju)),ac(t,s),a(this,Oo).promise.finally(()=>{a(Ht,Qu).delete(this),g(this,Si,null),g(this,Ku,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Rt.platform;return ae(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{a(this,ml).read().then(({value:t,done:s})=>{if(s){a(this,Oo).resolve();return}a(this,gl)??g(this,gl,t.lang),Object.assign(a(this,Ku),t.styles),A(this,Ji,zT).call(this,t.items),e()},a(this,Oo).reject)};return g(this,ml,a(this,Xu).getReader()),a(Ht,Qu).add(this),e(),a(this,Oo).promise}update({viewport:e,onBefore:t=null}){var i;const s=e.scale*Xr.pixelRatio,r=e.rotation;if(r!==a(this,qu)&&(t==null||t(),g(this,qu,r),ac(a(this,wp),{rotation:r})),s!==a(this,Io)){t==null||t(),g(this,Io,s);const o={div:null,properties:null,ctx:A(i=Ht,ms,km).call(i,a(this,gl))};for(const l of a(this,yl))o.properties=a(this,bp).get(l),o.div=l,A(this,Ji,u_).call(this,o)}}cancel(){var t;const e=new fa("TextLayer task cancelled.");(t=a(this,ml))==null||t.cancel(e).catch(()=>{}),g(this,ml,null),a(this,Oo).reject(e)}get textDivs(){return a(this,yl)}get textContentItemsStr(){return a(this,_p)}static cleanup(){if(!(a(this,Qu).size>0)){a(this,Yu).clear();for(const{canvas:e}of a(this,vl).values())e.remove();a(this,vl).clear()}}};Oo=new WeakMap,Kn=new WeakMap,gp=new WeakMap,mp=new WeakMap,gl=new WeakMap,Si=new WeakMap,yp=new WeakMap,vp=new WeakMap,ml=new WeakMap,wp=new WeakMap,qu=new WeakMap,Io=new WeakMap,Ku=new WeakMap,_p=new WeakMap,Xu=new WeakMap,yl=new WeakMap,bp=new WeakMap,Sp=new WeakMap,Yu=new WeakMap,vl=new WeakMap,Ap=new WeakMap,Ju=new WeakMap,Qu=new WeakMap,Ji=new WeakSet,zT=function(e){var r,i;if(a(this,gp))return;(i=a(this,Si)).ctx??(i.ctx=A(r=Ht,ms,km).call(r,a(this,gl)));const t=a(this,yl),s=a(this,_p);for(const o of e){if(t.length>_2){oe("Ignoring additional textDivs for performance reasons."),g(this,gp,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const l=a(this,Kn);g(this,Kn,document.createElement("span")),a(this,Kn).classList.add("markedContent"),o.id&&a(this,Kn).setAttribute("id",`${o.id}`),l.append(a(this,Kn))}else o.type==="endMarkedContent"&&g(this,Kn,a(this,Kn).parentNode);continue}s.push(o.str),A(this,Ji,HT).call(this,o)}},HT=function(e){var y;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};a(this,yl).push(t);const r=V.transform(a(this,Sp),e.transform);let i=Math.atan2(r[1],r[0]);const o=a(this,Ku)[e.fontName];o.vertical&&(i+=Math.PI/2);let l=a(this,mp)&&o.fontSubstitution||o.fontFamily;l=Ht.fontFamilyMap.get(l)||l;const c=Math.hypot(r[2],r[3]),u=c*A(y=Ht,ms,WT).call(y,l,o,a(this,gl));let h,d;i===0?(h=r[4],d=r[5]-u):(h=r[4]+u*Math.sin(i),d=r[5]-u*Math.cos(i));const f=t.style;f.left=`${(100*h/a(this,vp)).toFixed(2)}%`,f.top=`${(100*d/a(this,yp)).toFixed(2)}%`,f.setProperty("--font-height",`${c.toFixed(2)}px`),f.fontFamily=l,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,a(this,mp)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),i!==0&&(s.angle=i*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const v=Math.abs(e.transform[0]),S=Math.abs(e.transform[3]);v!==S&&Math.max(v,S)/Math.min(v,S)>1.5&&(p=!0)}if(p&&(s.canvasWidth=o.vertical?e.height:e.width),a(this,bp).set(t,s),a(this,Si).div=t,a(this,Si).properties=s,A(this,Ji,u_).call(this,a(this,Si)),s.hasText&&a(this,Kn).append(t),s.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),a(this,Kn).append(v)}},u_=function(e){var o;const{div:t,properties:s,ctx:r}=e,{style:i}=t;if(s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=i,{canvasWidth:c,fontSize:u}=s;A(o=Ht,ms,h_).call(o,r,u*a(this,Io),l);const{width:h}=r.measureText(t.textContent);h>0&&i.setProperty("--scale-x",c*a(this,Io)/h)}s.angle!==0&&i.setProperty("--rotate",`${s.angle}deg`)},ms=new WeakSet,km=function(e=null){let t=a(this,vl).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),a(this,vl).set(e,t),a(this,Ap).set(t,{size:0,family:""})}return t},h_=function(e,t,s){const r=a(this,Ap).get(e);t===r.size&&s===r.family||(e.font=`${t}px ${s}`,r.size=t,r.family=s)},VT=function(){if(a(this,Ju)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),g(this,Ju,e.getBoundingClientRect().height),e.remove()},WT=function(e,t,s){const r=a(this,Yu).get(e);if(r)return r;const i=A(this,ms,km).call(this,s);i.canvas.width=i.canvas.height=BE,A(this,ms,h_).call(this,i,BE,e);const o=i.measureText(""),l=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let u=.8;return l?u=l/(l+c):(Rt.platform.isFirefox&&oe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),a(this,Yu).set(e,u),u},b(Ht,ms),b(Ht,Yu,new Map),b(Ht,vl,new Map),b(Ht,Ap,new WeakMap),b(Ht,Ju,null),b(Ht,Qu,new Set);let vf=Ht;const b2=100;function GT(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new d_,{docId:t}=e,s=n.url?TM(n.url):null,r=n.data?PM(n.data):null,i=n.httpHeaders||null,o=n.withCredentials===!0,l=n.password??null,c=n.range instanceof qT?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let h=n.worker instanceof wf?n.worker:null;const d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Av(n.docBaseUrl)?n.docBaseUrl:null,p=Kg(n.cMapUrl),y=n.cMapPacked!==!1,v=n.CMapReaderFactory||(wn?FM:EE),S=Kg(n.iccUrl),m=Kg(n.standardFontDataUrl),w=n.StandardFontDataFactory||(wn?BM:kE),_=Kg(n.wasmUrl),E=n.WasmFactory||(wn?jM:CE),k=n.stopAtErrors!==!0,C=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,x=n.isEvalSupported!==!1,P=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!wn,I=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!wn&&(Rt.platform.isFirefox||!globalThis.chrome),N=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,j=typeof n.disableFontFace=="boolean"?n.disableFontFace:wn,ee=n.fontExtraProperties===!0,se=n.enableXfa===!0,Q=n.ownerDocument||globalThis.document,re=n.disableRange===!0,K=n.disableStream===!0,M=n.disableAutoFetch===!0,O=n.pdfBug===!0,R=n.CanvasFactory||(wn?MM:LM),T=n.FilterFactory||(wn?NM:DM),L=n.enableHWA===!0,F=n.useWasm!==!1,$=c?c.length:n.length??NaN,J=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!wn&&!j,ie=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(v===EE&&w===kE&&E===CE&&p&&m&&_&&hd(p,document.baseURI)&&hd(m,document.baseURI)&&hd(_,document.baseURI)),pe=null;tM(d);const fe={canvasFactory:new R({ownerDocument:Q,enableHWA:L}),filterFactory:new T({docId:t,ownerDocument:Q}),cMapReaderFactory:ie?null:new v({baseUrl:p,isCompressed:y}),standardFontDataFactory:ie?null:new w({baseUrl:m}),wasmFactory:ie?null:new E({baseUrl:_})};h||(h=wf.create({verbosity:d,port:Gr.workerPort}),e._worker=h);const Ot={docId:t,apiVersion:"5.4.530",data:r,password:l,disableAutoFetch:M,rangeChunkSize:u,length:$,docBaseUrl:f,enableXfa:se,evaluatorOptions:{maxImageSize:C,disableFontFace:j,ignoreErrors:k,isEvalSupported:x,isOffscreenCanvasSupported:P,isImageDecoderSupported:I,canvasMaxAreaInBytes:N,fontExtraProperties:ee,useSystemFonts:J,useWasm:F,useWorkerFetch:ie,cMapUrl:p,iccUrl:S,standardFontDataUrl:m,wasmUrl:_}},wa={ownerDocument:Q,pdfBug:O,styleElement:pe,loadingParams:{disableAutoFetch:M,enableXfa:se}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Hs=h.messageHandler.sendWithPromise("GetDocRequest",Ot,r?[r.buffer]:null);let fn;if(c)fn=new s2(c,{disableRange:re,disableStream:K});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Cv=hd(s)?a2:wn?y2:d2;fn=new Cv({url:s,length:$,httpHeaders:i,withCredentials:o,rangeChunkSize:u,disableRange:re,disableStream:K})}return Hs.then(Cv=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const bS=new wd(t,Cv,h.port),Y1=new E2(bS,e,fn,wa,fe,L);e._transport=Y1,bS.send("Ready",null)})}).catch(e._capability.reject),e}var Hy;const Vy=class Vy{constructor(){B(this,"_capability",Promise.withResolvers());B(this,"_transport",null);B(this,"_worker",null);B(this,"docId",`d${bt(Vy,Hy)._++}`);B(this,"destroyed",!1);B(this,"onPassword",null);B(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,r;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,i}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Hy=new WeakMap,b(Vy,Hy,0);let d_=Vy;var wl,Ep,kp,Cp,xp;class qT{constructor(e,t,s=!1,r=null){b(this,wl,Promise.withResolvers());b(this,Ep,[]);b(this,kp,[]);b(this,Cp,[]);b(this,xp,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=r}addRangeListener(e){a(this,xp).push(e)}addProgressListener(e){a(this,Cp).push(e)}addProgressiveReadListener(e){a(this,kp).push(e)}addProgressiveDoneListener(e){a(this,Ep).push(e)}onDataRange(e,t){for(const s of a(this,xp))s(e,t)}onDataProgress(e,t){a(this,wl).promise.then(()=>{for(const s of a(this,Cp))s(e,t)})}onDataProgressiveRead(e){a(this,wl).promise.then(()=>{for(const t of a(this,kp))t(e)})}onDataProgressiveDone(){a(this,wl).promise.then(()=>{for(const e of a(this,Ep))e()})}transportReady(){a(this,wl).resolve()}requestDataRange(e,t){Fe("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}wl=new WeakMap,Ep=new WeakMap,kp=new WeakMap,Cp=new WeakMap,xp=new WeakMap;class S2{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ae(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Ai,_l,Ed;class A2{constructor(e,t,s,r=!1){b(this,_l);b(this,Ai,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=r?new yE:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new $T,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:i=!1}={}){return new _g({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:r,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ae(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:r="display",annotationMode:i=lo.ENABLE,transform:o=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:d=null,isEditing:f=!1,recordOperations:p=!1,operationsFilter:y=null}){var I,N,j;(I=this._stats)==null||I.time("Overall");const v=this._transport.getRenderingIntent(r,i,d,f),{renderingIntent:S,cacheKey:m}=v;g(this,Ai,!1),c||(c=this._transport.getOptionalContentConfig(S));let w=this._intentStates.get(m);w||(w=Object.create(null),this._intentStates.set(m,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const _=!!(S&ls.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(N=this._stats)==null||N.time("Page Request"),this._pumpOperatorList(v));const E=!!(this._pdfBug&&((j=globalThis.StepperManager)!=null&&j.enabled)),k=!this.recordedBBoxes&&(p||E),C=ee=>{var se,Q;if(w.renderTasks.delete(x),k){const re=(se=x.gfx)==null?void 0:se.dependencyTracker.take();re&&(x.stepper&&x.stepper.setOperatorBBoxes(re,x.gfx.dependencyTracker.takeDebugMetadata()),p&&(this.recordedBBoxes=re))}_&&g(this,Ai,!0),A(this,_l,Ed).call(this),ee?(x.capability.reject(ee),this._abortOperatorList({intentState:w,reason:ee instanceof Error?ee:new Error(ee)})):x.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(Q=globalThis.Stats)!=null&&Q.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},x=new f_({callback:C,params:{canvas:t,canvasContext:e,dependencyTracker:k?new $M(t,w.operatorList.length,E):null,viewport:s,transform:o,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:h,enableHWA:this._transport.enableHWA,operationsFilter:y});(w.renderTasks||(w.renderTasks=new Set)).add(x);const P=x.task;return Promise.all([w.displayReadyCapability.promise,c]).then(([ee,se])=>{var Q;if(this.destroyed){C();return}if((Q=this._stats)==null||Q.time("Rendering"),!(se.renderingIntent&S))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");x.initializeGraphics({transparency:ee,optionalContentConfig:se}),x.operatorListChanged()}).catch(C),P}getOperatorList({intent:e="display",annotationMode:t=lo.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){var u;function i(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(e,t,s,r,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let c;return l.opListReadCapability||(c=Object.create(null),c.operatorListChanged=i,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||(l.renderTasks=new Set)).add(c),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>yf.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,r){function i(){o.read().then(function({value:c,done:u}){if(u){s(l);return}l.lang??(l.lang=c.lang),Object.assign(l.styles,c.styles),l.items.push(...c.items),i()},r)}const o=t.getReader(),l={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),g(this,Ai,!1),Promise.all(e)}cleanup(e=!1){g(this,Ai,!0);const t=A(this,_l,Ed).call(this);return e&&t&&this._stats&&(this._stats=new yE),t}_startRenderPage(e,t){var r,i;const s=this._intentStates.get(t);s&&((r=this._stats)==null||r.timeEnd("Page Request"),(i=s.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let s=0,r=e.length;s<r;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&A(this,_l,Ed).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:r}){const{map:i,transfer:o}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:r},o).getReader(),u=this._intentStates.get(t);u.streamReader=c;const h=()=>{c.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();A(this,_l,Ed).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof oS){let r=b2;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new fa(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}Ai=new WeakMap,_l=new WeakSet,Ed=function(){if(!a(this,Ai)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),g(this,Ai,!1),!0};var Lo,tr,Ei,bl,Wy,Sl,Al,Sn,Cm,KT,XT,kd,Zu,xm;const Ge=class Ge{constructor({name:e=null,port:t=null,verbosity:s=nM()}={}){b(this,Sn);b(this,Lo,Promise.withResolvers());b(this,tr,null);b(this,Ei,null);b(this,bl,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(a(Ge,Al).has(t))throw new Error("Cannot use more than one PDFWorker per port.");a(Ge,Al).set(t,this),A(this,Sn,KT).call(this,t)}else A(this,Sn,XT).call(this)}get promise(){return a(this,Lo).promise}get port(){return a(this,Ei)}get messageHandler(){return a(this,tr)}destroy(){var e,t;this.destroyed=!0,(e=a(this,bl))==null||e.terminate(),g(this,bl,null),a(Ge,Al).delete(a(this,Ei)),g(this,Ei,null),(t=a(this,tr))==null||t.destroy(),g(this,tr,null)}static create(e){const t=a(this,Al).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ge(e)}static get workerSrc(){if(Gr.workerSrc)return Gr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ae(this,"_setupFakeWorkerGlobal",(async()=>a(this,Zu,xm)?a(this,Zu,xm):(await import(this.workerSrc)).WorkerMessageHandler)())}};Lo=new WeakMap,tr=new WeakMap,Ei=new WeakMap,bl=new WeakMap,Wy=new WeakMap,Sl=new WeakMap,Al=new WeakMap,Sn=new WeakSet,Cm=function(){a(this,Lo).resolve(),a(this,tr).send("configure",{verbosity:this.verbosity})},KT=function(e){g(this,Ei,e),g(this,tr,new wd("main","worker",e)),a(this,tr).on("ready",()=>{}),A(this,Sn,Cm).call(this)},XT=function(){if(a(Ge,Sl)||a(Ge,Zu,xm)){A(this,Sn,kd).call(this);return}let{workerSrc:e}=Ge;try{Ge._isSameOrigin(window.location,e)||(e=Ge._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new wd("main","worker",t),r=()=>{i.abort(),s.destroy(),t.terminate(),this.destroyed?a(this,Lo).reject(new Error("Worker was destroyed")):A(this,Sn,kd).call(this)},i=new AbortController;t.addEventListener("error",()=>{a(this,bl)||r()},{signal:i.signal}),s.on("test",l=>{if(i.abort(),this.destroyed||!l){r();return}g(this,tr,s),g(this,Ei,t),g(this,bl,t),A(this,Sn,Cm).call(this)}),s.on("ready",l=>{if(i.abort(),this.destroyed){r();return}try{o()}catch{A(this,Sn,kd).call(this)}});const o=()=>{const l=new Uint8Array;s.send("test",l,[l.buffer])};o();return}catch{Sv("The worker has been disabled.")}A(this,Sn,kd).call(this)},kd=function(){a(Ge,Sl)||(oe("Setting up fake worker."),g(Ge,Sl,!0)),Ge._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){a(this,Lo).reject(new Error("Worker was destroyed"));return}const t=new IM;g(this,Ei,t);const s=`fake${bt(Ge,Wy)._++}`,r=new wd(s+"_worker",s,t);e.setup(r,t),g(this,tr,new wd(s,s+"_worker",t)),A(this,Sn,Cm).call(this)}).catch(e=>{a(this,Lo).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Zu=new WeakSet,xm=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},b(Ge,Zu),b(Ge,Wy,0),b(Ge,Sl,!1),b(Ge,Al,new WeakMap),wn&&(g(Ge,Sl,!0),Gr.workerSrc||(Gr.workerSrc="./pdf.worker.mjs")),Ge._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const r=new URL(t,s);return s.origin===r.origin},Ge._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Ge.fromPort=e=>{if(pM("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Ge.create(e)};let wf=Ge;var ki,Dr,eh,th,Ci,El,Cd;class E2{constructor(e,t,s,r,i,o){b(this,El);b(this,ki,new Map);b(this,Dr,new Map);b(this,eh,new Map);b(this,th,new Map);b(this,Ci,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new $T,this.fontLoader=new kM({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}get annotationStorage(){return ae(this,"annotationStorage",new lS)}getRenderingIntent(e,t=lo.ENABLE,s=null,r=!1,i=!1){let o=ls.DISPLAY,l=X0;switch(e){case"any":o=ls.ANY;break;case"display":break;case"print":o=ls.PRINT;break;default:oe(`getRenderingIntent - invalid intent: ${e}`)}const c=o&ls.PRINT&&s instanceof kT?s:this.annotationStorage;switch(t){case lo.DISABLE:o+=ls.ANNOTATIONS_DISABLE;break;case lo.ENABLE:break;case lo.ENABLE_FORMS:o+=ls.ANNOTATIONS_FORMS;break;case lo.ENABLE_STORAGE:o+=ls.ANNOTATIONS_STORAGE,l=c.serializable;break;default:oe(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(o+=ls.IS_EDITING),i&&(o+=ls.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[o,l.hash,h];return{renderingIntent:o,cacheKey:d.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=a(this,Ci))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of a(this,Dr).values())e.push(r._destroy());a(this,Dr).clear(),a(this,eh).clear(),a(this,th).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var r,i;this.commonObjs.clear(),this.fontLoader.clear(),a(this,ki).clear(),this.filterFactory.destroy(),vf.cleanup(),(r=this._networkStream)==null||r.cancelAllRequests(new fa("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,r)=>{we(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},r.onPull=()=>{this._fullReader.read().then(function({value:i,done:o}){if(o){r.close();return}we(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{r.error(i)})},r.onCancel=i=>{this._fullReader.cancel(i),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{var l;await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:i,contentLength:o}=this._fullReader;return(!r||!i)&&(this._lastProgress&&((l=t.onProgress)==null||l.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:r,isRangeSupported:i,contentLength:o}}),e.on("GetRangeReader",(s,r)=>{we(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(s.begin,s.end);if(!i){r.close();return}r.onPull=()=>{i.read().then(function({value:o,done:l}){if(l){r.close();return}we(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{i.cancel(o),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new S2(s,this))}),e.on("DocException",s=>{t._capability.reject(xn(s))}),e.on("PasswordRequest",s=>{g(this,Ci,Promise.withResolvers());try{if(!t.onPassword)throw xn(s);const r=i=>{i instanceof Error?a(this,Ci).reject(i):a(this,Ci).resolve({password:i})};t.onPassword(r,s.code)}catch(r){a(this,Ci).reject(r)}return a(this,Ci).promise}),e.on("DataLoaded",s=>{var r;(r=t.onProgress)==null||r.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;a(this,Dr).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,r,i])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":if("error"in i){const f=i.error;oe(`Error during font loading: ${f}`),this.commonObjs.resolve(s,f);break}const l=new Y0(i),c=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,u=new CM(l,c,i.extra,i.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(s,u)});break;case"CopyLocalImage":const{imageRef:h}=i;we(h,"The imageRef must be defined.");for(const f of a(this,Dr).values())for(const[,p]of f.objs)if((p==null?void 0:p.ref)===h)return p.dataLen?(this.commonObjs.resolve(s,structuredClone(p)),p.dataLen):null;break;case"FontPath":this.commonObjs.resolve(s,new xM(i));break;case"Image":this.commonObjs.resolve(s,i);break;case"Pattern":const d=new J0(i);this.commonObjs.resolve(s,d.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([s,r,i,o])=>{var c;if(this.destroyed)return;const l=a(this,Dr).get(r);if(!l.objs.has(s)){if(l._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(i){case"Image":case"Pattern":l.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",s=>{var r;this.destroyed||(r=t.onProgress)==null||r.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[s.type];if(!r)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&oe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=a(this,eh).get(t);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&a(this,th).set(i.refStr,e);const o=new A2(t,i,this,this._params.pdfBug);return a(this,Dr).set(t,o),o});return a(this,eh).set(t,r),r}getPageIndex(e){return Q0(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return A(this,El,Cd).call(this,"GetFieldObjects")}hasJSActions(){return A(this,El,Cd).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return A(this,El,Cd).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return A(this,El,Cd).call(this,"GetOptionalContentConfig").then(t=>new n2(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=a(this,ki).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(r=>{var i,o;return{info:r[0],metadata:r[1]?new e2(r[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null,hasStructTree:r[2]}});return a(this,ki).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of a(this,Dr).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),a(this,ki).clear(),this.filterFactory.destroy(!0),vf.cleanup()}}cachedPageNumber(e){if(!Q0(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return a(this,th).get(t)??null}}ki=new WeakMap,Dr=new WeakMap,eh=new WeakMap,th=new WeakMap,Ci=new WeakMap,El=new WeakSet,Cd=function(e,t=null){const s=a(this,ki).get(e);if(s)return s;const r=this.messageHandler.sendWithPromise(e,t);return a(this,ki).set(e,r),r};var Do;class k2{constructor(e){b(this,Do,null);B(this,"onContinue",null);B(this,"onError",null);g(this,Do,e)}get promise(){return a(this,Do).capability.promise}cancel(e=0){a(this,Do).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=a(this,Do).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=a(this,Do);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Do=new WeakMap;var No,kl;const Ia=class Ia{constructor({callback:e,params:t,objs:s,commonObjs:r,annotationCanvasMap:i,operatorList:o,pageIndex:l,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null,enableHWA:p=!1,operationsFilter:y=null}){b(this,No,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new k2(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=p,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=y}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var c,u;if(this.cancelled)return;if(this._canvas){if(a(Ia,kl).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");a(Ia,kl).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:r,background:i,dependencyTracker:o}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ou(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var s,r,i;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),a(this,No)&&(window.cancelAnimationFrame(a(this,No)),g(this,No,null)),a(Ia,kl).delete(this._canvas),e||(e=new oS(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(i=(r=this.task).onError)==null||i.call(r,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?g(this,No,window.requestAnimationFrame(()=>{g(this,No,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),a(Ia,kl).delete(this._canvas),this.callback())))}};No=new WeakMap,kl=new WeakMap,b(Ia,kl,new WeakSet);let f_=Ia;const YT="5.4.530",C2="50cc4adac";var Xn,Cl,nh,Ct,Tp,sh,xi,Pp,Mo,nr,Rp,Le,p_,g_,m_,Ca,JT,to;const Tn=class Tn{constructor({editor:e=null,uiManager:t=null}){b(this,Le);b(this,Xn,null);b(this,Cl,null);b(this,nh);b(this,Ct,null);b(this,Tp,!1);b(this,sh,!1);b(this,xi,null);b(this,Pp);b(this,Mo,null);b(this,nr,null);var s,r;e?(g(this,sh,!1),g(this,xi,e)):g(this,sh,!0),g(this,nr,(e==null?void 0:e._uiManager)||t),g(this,Pp,a(this,nr)._eventBus),g(this,nh,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((r=a(this,nr))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),a(Tn,Rp)||g(Tn,Rp,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ae(this,"_keyboardManager",new Sg([[["Escape","mac+Escape"],Tn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Tn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Tn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Tn.prototype._moveToPrevious],[["Home","mac+Home"],Tn.prototype._moveToBeginning],[["End","mac+End"],Tn.prototype._moveToEnd]]))}renderButton(){const e=g(this,Xn,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",a(this,xi)&&(e.ariaControls=`${a(this,xi).id}_colorpicker_dropdown`);const t=a(this,nr)._signal;e.addEventListener("click",A(this,Le,Ca).bind(this),{signal:t}),e.addEventListener("keydown",A(this,Le,m_).bind(this),{signal:t});const s=g(this,Cl,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=a(this,nh),e.append(s),e}renderMainDropdown(){const e=g(this,Ct,A(this,Le,p_).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===a(this,Xn)){A(this,Le,Ca).call(this,e);return}const t=e.target.getAttribute("data-color");t&&A(this,Le,g_).call(this,t,e)}_moveToNext(e){var t,s;if(!a(this,Le,to)){A(this,Le,Ca).call(this,e);return}if(e.target===a(this,Xn)){(t=a(this,Ct).firstElementChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=a(this,Ct))==null?void 0:t.firstElementChild)||e.target===a(this,Xn)){a(this,Le,to)&&this._hideDropdownFromKeyboard();return}a(this,Le,to)||A(this,Le,Ca).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!a(this,Le,to)){A(this,Le,Ca).call(this,e);return}(t=a(this,Ct).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!a(this,Le,to)){A(this,Le,Ca).call(this,e);return}(t=a(this,Ct).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=a(this,Ct))==null||e.classList.add("hidden"),a(this,Xn).ariaExpanded="false",(t=a(this,Mo))==null||t.abort(),g(this,Mo,null)}_hideDropdownFromKeyboard(){var e;if(!a(this,sh)){if(!a(this,Le,to)){(e=a(this,xi))==null||e.unselect();return}this.hideDropdown(),a(this,Xn).focus({preventScroll:!0,focusVisible:a(this,Tp)})}}updateColor(e){if(a(this,Cl)&&(a(this,Cl).style.backgroundColor=e),!a(this,Ct))return;const t=a(this,nr).highlightColors.values();for(const s of a(this,Ct).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=a(this,Xn))==null||e.remove(),g(this,Xn,null),g(this,Cl,null),(t=a(this,Ct))==null||t.remove(),g(this,Ct,null)}};Xn=new WeakMap,Cl=new WeakMap,nh=new WeakMap,Ct=new WeakMap,Tp=new WeakMap,sh=new WeakMap,xi=new WeakMap,Pp=new WeakMap,Mo=new WeakMap,nr=new WeakMap,Rp=new WeakMap,Le=new WeakSet,p_=function(){const e=document.createElement("div"),t=a(this,nr)._signal;e.addEventListener("contextmenu",zs,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),a(this,xi)&&(e.id=`${a(this,xi).id}_colorpicker_dropdown`);for(const[s,r]of a(this,nr).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",r),i.title=s,i.setAttribute("data-l10n-id",a(Tn,Rp)[s]);const o=document.createElement("span");i.append(o),o.className="swatch",o.style.backgroundColor=r,i.ariaSelected=r===a(this,nh),i.addEventListener("click",A(this,Le,g_).bind(this,r),{signal:t}),e.append(i)}return e.addEventListener("keydown",A(this,Le,m_).bind(this),{signal:t}),e},g_=function(e,t){t.stopPropagation(),a(this,Pp).dispatch("switchannotationeditorparams",{source:this,type:ve.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},m_=function(e){Tn._keyboardManager.exec(this,e)},Ca=function(e){if(a(this,Le,to)){this.hideDropdown();return}if(g(this,Tp,e.detail===0),a(this,Mo)||(g(this,Mo,new AbortController),window.addEventListener("pointerdown",A(this,Le,JT).bind(this),{signal:a(this,nr).combinedSignal(a(this,Mo))})),a(this,Xn).ariaExpanded="true",a(this,Ct)){a(this,Ct).classList.remove("hidden");return}const t=g(this,Ct,A(this,Le,p_).call(this));a(this,Xn).append(t)},JT=function(e){var t;(t=a(this,Ct))!=null&&t.contains(e.target)||this.hideDropdown()},to=function(){return a(this,Ct)&&!a(this,Ct).classList.contains("hidden")},b(Tn,Rp,null);let Ty=Tn;var Nr,Op,rh,Ip;const La=class La{constructor(e){b(this,Nr,null);b(this,Op,null);b(this,rh,null);g(this,Op,e),g(this,rh,e._uiManager),a(La,Ip)||g(La,Ip,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(a(this,Nr))return a(this,Nr);const{editorType:e,colorType:t,color:s}=a(this,Op),r=g(this,Nr,document.createElement("input"));return r.type="color",r.value=s||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",a(La,Ip)[e]),r.addEventListener("input",()=>{a(this,rh).updateParams(t,r.value)},{signal:a(this,rh)._signal}),r}update(e){a(this,Nr)&&(a(this,Nr).value=e)}destroy(){var e;(e=a(this,Nr))==null||e.remove(),g(this,Nr,null)}hideDropdown(){}};Nr=new WeakMap,Op=new WeakMap,rh=new WeakMap,Ip=new WeakMap,b(La,Ip,null);let Py=La;function jE(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function sd(n){return Math.max(0,Math.min(255,255*n))}class UE{static CMYK_G([e,t,s,r]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=sd(e),[e,e,e]}static G_HTML([e]){const t=jE(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(sd)}static RGB_HTML(e){return`#${e.map(jE).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,s+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,s,r]){return[sd(1-Math.min(1,e+r)),sd(1-Math.min(1,s+r)),sd(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const r=1-e,i=1-t,o=1-s,l=Math.min(r,i,o);return["CMYK",r,i,o,l]}}class x2{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Fe("Abstract method `_createSVG` called.")}}class Ry extends x2{_createSVG(e){return document.createElementNS(Jr,e)}}const T2=9,cc=new WeakSet,P2=new Date().getTimezoneOffset()*60*1e3;class ww{static create(e){switch(e.data.annotationType){case gt.LINK:return new hS(e);case gt.TEXT:return new O2(e);case gt.WIDGET:switch(e.data.fieldType){case"Tx":return new I2(e);case"Btn":return e.data.radioButton?new e1(e):e.data.checkBox?new D2(e):new N2(e);case"Ch":return new M2(e);case"Sig":return new L2(e)}return new pc(e);case gt.POPUP:return new v_(e);case gt.FREETEXT:return new i1(e);case gt.LINE:return new B2(e);case gt.SQUARE:return new j2(e);case gt.CIRCLE:return new U2(e);case gt.POLYLINE:return new o1(e);case gt.CARET:return new z2(e);case gt.INK:return new dS(e);case gt.POLYGON:return new $2(e);case gt.HIGHLIGHT:return new a1(e);case gt.UNDERLINE:return new H2(e);case gt.SQUIGGLY:return new V2(e);case gt.STRIKEOUT:return new W2(e);case gt.STAMP:return new l1(e);case gt.FILEATTACHMENT:return new G2(e);default:return new tt(e)}}}var xl,ih,Os,Lp,y_;const wS=class wS{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){b(this,Lp);b(this,xl,null);b(this,ih,!1);b(this,Os,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return wS._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var s;const{data:e}=this,t=(s=this.annotationStorage)==null?void 0:s.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var l;const e=(l=this.annotationStorage)==null?void 0:l.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:r}=this.data;let i=-1/0,o=-1/0;if((t==null?void 0:t.length)>=8){for(let c=0;c<t.length;c+=8)t[c+1]>o?(o=t[c+1],i=t[c+2]):t[c+1]===o&&(i=Math.max(i,t[c+2]));return[i,o]}if((s==null?void 0:s.length)>=1){for(const c of s)for(let u=0,h=c.length;u<h;u+=2)c[u+1]>o?(o=c[u+1],i=c[u]):c[u+1]===o&&(i=Math.max(i,c[u]));if(i!==1/0)return[i,o]}return r?[r[2],r[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:i,pageY:o}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/s,e[1]=100*(e[1]-o)/r,e}get commentText(){var t,s,r;const{data:e}=this;return((s=(t=this.annotationStorage.getRawValue(`${gf}${e.id}`))==null?void 0:t.popup)==null?void 0:s.contents)||((r=e.contentsObj)==null?void 0:r.str)||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${gf}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=a(this,Os))==null?void 0:e.popup)||this.popup)==null||t.remove(),g(this,Os,this.popup=null)}updateEdited(e){var i;if(!this.container)return;e.rect&&(a(this,xl)||g(this,xl,{rect:this.data.rect.slice(0)}));const{rect:t,popup:s}=e;t&&A(this,Lp,y_).call(this,t);let r=((i=a(this,Os))==null?void 0:i.popup)||this.popup;!r&&(s!=null&&s.text)&&(this._createPopup(s),r=a(this,Os).popup),r&&(r.updateEdited(e),s!=null&&s.deleted&&(r.remove(),g(this,Os,null),this.popup=null))}resetEdited(){var e;a(this,xl)&&(A(this,Lp,y_).call(this,a(this,xl).rect),(e=a(this,Os))==null||e.popup.resetEdited(),g(this,xl,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:r}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof pc)&&!(this instanceof hS)&&(i.tabIndex=0);const{style:o}=i;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof v_){const{rotation:v}=t;return!t.hasOwnCanvas&&v!==0&&this.setRotation(v,i),i}const{width:l,height:c}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const v=t.borderStyle.horizontalCornerRadius,S=t.borderStyle.verticalCornerRadius;if(v>0||S>0){const w=`calc(${v}px * var(--total-scale-factor)) / calc(${S}px * var(--total-scale-factor))`;o.borderRadius=w}else if(this instanceof e1){const w=`calc(${l}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;o.borderRadius=w}switch(t.borderStyle.style){case Cc.SOLID:o.borderStyle="solid";break;case Cc.DASHED:o.borderStyle="dashed";break;case Cc.BEVELED:oe("Unimplemented border style: beveled");break;case Cc.INSET:oe("Unimplemented border style: inset");break;case Cc.UNDERLINE:o.borderBottomStyle="solid";break}const m=t.borderColor||null;m?(g(this,ih,!0),o.borderColor=V.makeHexColor(m[0]|0,m[1]|0,m[2]|0)):o.borderWidth=0}const u=V.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:p}=r.rawDims;o.left=`${100*(u[0]-f)/h}%`,o.top=`${100*(u[1]-p)/d}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*l/h}%`,o.height=`${100*c/d}%`):this.setRotation(y,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims;let{width:i,height:o}=this;e%180!==0&&([i,o]=[o,i]),t.style.width=`${100*i/s}%`,t.style.height=`${100*o/r}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,r)=>{const i=r.detail[t],o=i[0],l=i.slice(1);r.target.style[s]=UE[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[s]:UE[`${o}_rgb`](l)})};return ae(this,"_commonActions",{display:t=>{const{display:s}=t.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const r of Object.keys(t.detail)){const i=e[r]||s[r];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[r,i]of Object.entries(t)){const o=s[r];if(o){const l={detail:{[r]:i},target:e};o(l),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,r,i]=this.data.rect.map(v=>Math.fround(v));if(e.length===8){const[v,S,m,w]=e.subarray(2,6);if(r===v&&i===S&&t===m&&s===w)return}const{style:o}=this.container;let l;if(a(this,ih)){const{borderColor:v,borderWidth:S}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const c=r-t,u=i-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0),d.role="none";const f=h.createElement("defs");d.append(f);const p=h.createElement("clipPath"),y=`clippath_${this.data.id}`;p.setAttribute("id",y),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let v=2,S=e.length;v<S;v+=8){const m=e[v],w=e[v+1],_=e[v+2],E=e[v+3],k=h.createElement("rect"),C=(_-t)/c,x=(i-w)/u,P=(m-_)/c,I=(w-E)/u;k.setAttribute("x",C),k.setAttribute("y",x),k.setAttribute("width",P),k.setAttribute("height",I),p.append(k),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${C}" y="${x}" width="${P}" height="${I}"/>`)}a(this,ih)&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(d),this.container.style.clipPath=`url(#${y})`}_createPopup(e=null){const{data:t}=this;let s,r;e?(s={str:e.text},r=e.date):(s=t.contentsObj,r=t.modificationDate),g(this,Os,new v_({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(a(this,Os)||this.popup||this.data.popupRef)}get extraPopupElement(){return a(this,Os)}render(){Fe("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:i,id:o,exportValues:l}of r){if(i===-1||o===t)continue;const c=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!cc.has(u)){oe(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:c,domElement:u})}return s}for(const r of document.getElementsByName(e)){const{exportValue:i}=r,o=r.getAttribute("data-element-id");o!==t&&cc.has(r)&&s.push({id:o,exportValue:i,domElement:r})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};xl=new WeakMap,ih=new WeakMap,Os=new WeakMap,Lp=new WeakSet,y_=function(e){const{container:{style:t},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:o,pageX:l,pageY:c}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-l)/i}%`,t.top=`${100*(o-e[3]+c)/o}%`,r===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(r)};let tt=wS;class R2 extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var hs,xa,QT,ZT;class hS extends tt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});b(this,hs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let i=!1;return t.url?(s.addLinkAttributes(r,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(r,t.action,t.overlaidText),i=!0):t.attachment?(A(this,hs,QT).call(this,r,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(A(this,hs,ZT).call(this,r,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(r,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),i=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&(this.contentElement=r,this.container.append(r)),this.container}_bindLink(t,s,r=""){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&A(this,hs,xa).call(this),r&&(t.title=r)}_bindNamedAction(t,s,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),r&&(t.title=r),A(this,hs,xa).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(s.actions)){const o=r.get(i);o&&(t[o]=()=>{var l;return(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:i}}),!1})}s.overlaidText&&(t.title=s.overlaidText),t.onclick||(t.onclick=()=>!1),A(this,hs,xa).call(this)}_bindResetFormAction(t,s){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),A(this,hs,xa).call(this),!this._fieldObjects){oe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var d;r==null||r();const{fields:i,refs:o,include:l}=s,c=[];if(i.length!==0||o.length!==0){const f=new Set(o);for(const p of i){const y=this._fieldObjects[p]||[];for(const{id:v}of y)f.add(v)}for(const p of Object.values(this._fieldObjects))for(const y of p)f.has(y.id)===l&&c.push(y)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,h=[];for(const f of c){const{id:p}=f;switch(h.push(p),f.type){case"text":{const v=f.defaultValue||"";u.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=f.defaultValue===f.exportValues;u.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=f.defaultValue||"";u.setValue(p,{value:v});break}default:continue}const y=document.querySelector(`[data-element-id="${p}"]`);if(y){if(!cc.has(y)){oe(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}hs=new WeakSet,xa=function(){this.container.setAttribute("data-internal-link","")},QT=function(t,s,r="",i=null){t.href=this.linkService.getAnchorUrl(""),s.description?t.title=s.description:r&&(t.title=r),t.onclick=()=>{var o;return(o=this.downloadManager)==null||o.openOrDownloadData(s.content,s.filename,i),!1},A(this,hs,xa).call(this)},ZT=function(t,s,r=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),r&&(t.title=r),A(this,hs,xa).call(this)};class O2 extends tt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class pc extends tt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Rt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,r,i){s.includes("mouse")?e.addEventListener(s,o=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{var l;if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}i&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(o)}}))})}_setEventListeners(e,t,s,r){var i,o,l;for(const[c,u]of s)(u==="Action"||(i=this.data.actions)!=null&&i[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,r),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":V.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||T2,i=e.style;let o;const l=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),h=Math.round(u/(hw*r))||1,d=u/h;o=Math.min(r,c(d/hw))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(r,c(u/hw))}i.fontSize=`calc(${o}px * var(--total-scale-factor))`,i.color=V.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class I2 extends pc{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,r){const i=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),i.setValue(o.id,{[r]:s})}render(){var r,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let l=o.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=o.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??l,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??l),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),cc.add(s),this.contentElement=s,s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:d,datetimeType:f,timeStep:p}=this.data,y=!!f&&this.enableScripting;d&&(s.title=d),this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",S=>{e.setValue(t,{value:S.target.value}),this.setPropertyOnSiblings(s,"value",S.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",S=>{const m=this.data.defaultFieldValue??"";s.value=h.userValue=m,h.formattedValue=null});let v=S=>{const{formattedValue:m}=h;m!=null&&(S.target.value=m),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",m=>{var _;if(h.focused)return;const{target:w}=m;if(y&&(w.type=f,p&&(w.step=p)),h.userValue){const E=h.userValue;if(y)if(f==="time"){const k=new Date(E),C=[k.getHours(),k.getMinutes(),k.getSeconds()];w.value=C.map(x=>x.toString().padStart(2,"0")).join(":")}else w.value=new Date(E-P2).toISOString().split(f==="date"?"T":".",1)[0];else w.value=E}h.lastCommittedValue=w.value,h.commitKey=1,(_=this.data.actions)!=null&&_.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const w={value(_){h.userValue=_.detail.value??"",y||e.setValue(t,{value:h.userValue.toString()}),_.target.value=h.userValue},formattedValue(_){const{formattedValue:E}=_.detail;h.formattedValue=E,E!=null&&_.target!==document.activeElement&&(_.target.value=E);const k={formattedValue:E};y&&(k.value=E),e.setValue(t,k)},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{var x;const{charLimit:E}=_.detail,{target:k}=_;if(E===0){k.removeAttribute("maxLength");return}k.setAttribute("maxLength",E);let C=h.userValue;!C||C.length<=E||(C=C.slice(0,E),k.value=h.userValue=C,e.setValue(t,{value:C}),(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:k.selectionStart,selEnd:k.selectionEnd}}))}};this._dispatchEventFromSandbox(w,m)}),s.addEventListener("keydown",m=>{var E;h.commitKey=1;let w=-1;if(m.key==="Escape"?w=0:m.key==="Enter"&&!this.data.multiLine?w=2:m.key==="Tab"&&(h.commitKey=3),w===-1)return;const{value:_}=m.target;h.lastCommittedValue!==_&&(h.lastCommittedValue=_,h.userValue=_,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:w,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const S=v;v=null,s.addEventListener("blur",m=>{var E,k;if(!h.focused||!m.relatedTarget)return;(E=this.data.actions)!=null&&E.Blur||(h.focused=!1);const{target:w}=m;let{value:_}=w;if(y){if(_&&f==="time"){const C=_.split(":").map(x=>parseInt(x,10));_=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),w.step=""}else _.includes("T")||(_=`${_}T00:00`),_=new Date(_).valueOf();w.type="text"}h.userValue=_,h.lastCommittedValue!==_&&((k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:h.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),S(m)}),(i=this.data.actions)!=null&&i.Keystroke&&s.addEventListener("beforeinput",m=>{var I;h.lastCommittedValue=null;const{data:w,target:_}=m,{value:E,selectionStart:k,selectionEnd:C}=_;let x=k,P=C;switch(m.inputType){case"deleteWordBackward":{const N=E.substring(0,k).match(/\w*[^\w]*$/);N&&(x-=N[0].length);break}case"deleteWordForward":{const N=E.substring(k).match(/^[^\w]*\w*/);N&&(P+=N[0].length);break}case"deleteContentBackward":k===C&&(x-=1);break;case"deleteContentForward":k===C&&(P+=1);break}m.preventDefault(),(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:w||"",willCommit:!1,selStart:x,selEnd:P}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(v&&s.addEventListener("blur",v),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${m}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class L2 extends pc{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class D2 extends pc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let r=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return cc.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",o=>{const{name:l,checked:c}=o.target;for(const u of this._getElementsByName(l,s)){const h=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(s,{value:c})}),i.addEventListener("resetform",o=>{const l=t.defaultFieldValue||"Off";o.target.checked=l===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",o=>{const l={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class e1 extends pc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let r=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(s,{value:r})),r)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const i=document.createElement("input");if(cc.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",o=>{const{name:l,checked:c}=o.target;for(const u of this._getElementsByName(l,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),i.addEventListener("resetform",o=>{const l=t.defaultFieldValue;o.target.checked=l!=null&&l===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;i.addEventListener("updatefromsandbox",l=>{const c={value:u=>{const h=o===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===s;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class N2 extends hS{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class M2 extends pc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");cc.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of r.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),i=!1),r.append(d)}let o=null;if(i){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),r.prepend(h),o=()=>{h.remove(),r.removeEventListener("input",o),o=null},r.addEventListener("input",o)}const l=h=>{const d=h?"value":"textContent",{options:f,multiple:p}=r;return p?Array.prototype.filter.call(f,y=>y.selected).map(y=>y[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=l(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",h=>{const d={value(f){o==null||o();const p=f.detail.value,y=new Set(Array.isArray(p)?p:[p]);for(const v of r.options)v.selected=y.has(v.value);e.setValue(t,{value:l(!0)}),c=l(!1)},multipleSelection(f){r.multiple=!0},remove(f){const p=r.options,y=f.detail.remove;p[y].selected=!1,r.remove(y),p.length>0&&Array.prototype.findIndex.call(p,S=>S.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},clear(f){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),c=l(!1)},insert(f){const{index:p,displayValue:y,exportValue:v}=f.detail.insert,S=r.children[p],m=document.createElement("option");m.textContent=y,m.value=v,S?S.before(m):r.append(m),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},items(f){const{items:p}=f.detail;for(;r.length!==0;)r.remove(0);for(const y of p){const{displayValue:v,exportValue:S}=y,m=document.createElement("option");m.textContent=v,m.value=S,r.append(m)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:l(!0),items:u(f)}),c=l(!1)},indices(f){const p=new Set(f.detail.indices);for(const y of f.target.options)y.selected=p.has(y.index);e.setValue(t,{value:l(!0)}),c=l(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),r.addEventListener("input",h=>{var p;const d=l(!0),f=l(!1);e.setValue(t,{value:d}),h.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):r.addEventListener("input",function(h){e.setValue(t,{value:l(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}var Dp,w_;class v_ extends tt{constructor(t){const{data:s,elements:r,parent:i}=t,o=!!i._commentManager;super(t,{isRenderable:!o&&tt._hasPopupData(s)});b(this,Dp);if(this.elements=r,o&&tt._hasPopupData(s)){const l=this.popup=A(this,Dp,w_).call(this);for(const c of r)c.popup=l}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const s=this.popup=A(this,Dp,w_).call(this),r=[];for(const i of this.elements)i.popup=s,i.container.ariaHasPopup="dialog",r.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",r.map(i=>`${qc}${i}`).join(",")),this.container}}Dp=new WeakSet,w_=function(){return new F2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Yn,Fo,Gy,qy,oh,ah,it,Mr,Bo,Tl,lh,ch,Fr,Jn,Ti,Pi,ot,Ri,jo,Np,Oi,uh,Pl,Uo,Lt,$o,de,Tm,__,b_,S_,Pm,A_,t1,n1,s1,r1,Rm,Om,E_;class F2{constructor({container:e,color:t,elements:s,titleObj:r,modificationDate:i,contentsObj:o,richText:l,parent:c,rect:u,parentRect:h,open:d,commentManager:f=null}){b(this,de);b(this,Yn,null);b(this,Fo,A(this,de,s1).bind(this));b(this,Gy,A(this,de,E_).bind(this));b(this,qy,A(this,de,Om).bind(this));b(this,oh,A(this,de,Rm).bind(this));b(this,ah,null);b(this,it,null);b(this,Mr,null);b(this,Bo,null);b(this,Tl,null);b(this,lh,null);b(this,ch,null);b(this,Fr,!1);b(this,Jn,null);b(this,Ti,null);b(this,Pi,null);b(this,ot,null);b(this,Ri,null);b(this,jo,null);b(this,Np,null);b(this,Oi,null);b(this,uh,null);b(this,Pl,null);b(this,Uo,!1);b(this,Lt,null);b(this,$o,null);g(this,it,e),g(this,uh,r),g(this,Mr,o),g(this,Oi,l),g(this,lh,c),g(this,ah,t),g(this,Np,u),g(this,ch,h),g(this,Tl,s),g(this,Yn,f),g(this,Lt,s[0]),g(this,Bo,Sy.toDateObject(i)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup()),f||(A(this,de,Tm).call(this),a(this,it).hidden=!0,d&&A(this,de,Rm).call(this))}renderCommentButton(){if(a(this,ot)){a(this,ot).parentNode||a(this,Lt).container.after(a(this,ot));return}if(a(this,Ri)||A(this,de,__).call(this),!a(this,Ri))return;const{signal:e}=g(this,Ti,new AbortController),t=a(this,Lt).hasOwnCommentButton,s=()=>{a(this,Yn).toggleCommentPopup(this,!0,void 0,!t)},r=()=>{a(this,Yn).toggleCommentPopup(this,!1,!0,!t)},i=()=>{a(this,Yn).toggleCommentPopup(this,!1,!1)};if(t){g(this,ot,a(this,Lt).container);for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",a(this,Fo),{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),o.classList.add("popupTriggerArea")}else{const o=g(this,ot,document.createElement("button"));o.className="annotationCommentButton";const l=a(this,Lt).container;o.style.zIndex=l.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),A(this,de,S_).call(this),A(this,de,b_).call(this),o.addEventListener("keydown",a(this,Fo),{signal:e}),o.addEventListener("click",s,{signal:e}),o.addEventListener("pointerenter",r,{signal:e}),o.addEventListener("pointerleave",i,{signal:e}),l.after(o)}}get commentButtonColor(){const{color:e,opacity:t}=a(this,Lt).commentData;return e?a(this,lh)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=a(this,ot))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:r,modificationDate:i}=a(this,Lt).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:r,modificationDate:i}}get elementBeforePopup(){return a(this,ot)}get comment(){return a(this,$o)||g(this,$o,a(this,Lt).commentText),a(this,$o)}set comment(e){e!==this.comment&&(a(this,Lt).commentText=g(this,$o,e))}focus(){var e;(e=a(this,Lt).container)==null||e.focus()}get parentBoundingClientRect(){return a(this,Lt).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){a(this,ot)&&(a(this,ot).classList.toggle("selected",e),a(this,ot).ariaExpanded=t)}setSelectedCommentButton(e){a(this,ot).classList.toggle("selected",e)}get commentPopupPosition(){if(a(this,jo))return a(this,jo);const{x:e,y:t,height:s}=a(this,ot).getBoundingClientRect(),{x:r,y:i,width:o,height:l}=a(this,Lt).layer.getBoundingClientRect();return[(e-r)/o,(t+s-i)/l]}set commentPopupPosition(e){g(this,jo,e)}hasDefaultPopupPosition(){return a(this,jo)===null}get commentButtonPosition(){return a(this,Ri)}get commentButtonWidth(){return a(this,ot).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=a(this,jo)||this.commentButtonPosition.map(u=>u/100),r=this.parentBoundingClientRect,{x:i,y:o,width:l,height:c}=r;a(this,Yn).showDialog(null,this,i+t*l,o+s*c,{...e,parentDimensions:r})}render(){var s,r;if(a(this,Jn))return;const e=g(this,Jn,document.createElement("div"));if(e.className="popup",a(this,ah)){const i=e.style.outlineColor=V.makeHexColor(...a(this,ah));e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");if(t.className="header",(s=a(this,uh))!=null&&s.str){const i=document.createElement("span");i.className="title",t.append(i),{dir:i.dir,str:i.textContent}=a(this,uh)}if(e.append(t),a(this,Bo)){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:a(this,Bo).valueOf()})),i.dateTime=a(this,Bo).toISOString(),t.append(i)}Vx({html:a(this,de,Pm)||a(this,Mr).str,dir:(r=a(this,Mr))==null?void 0:r.dir,className:"popupContent"},e),a(this,it).append(e)}updateEdited({rect:e,popup:t,deleted:s}){var r;if(a(this,Yn)){s?(this.remove(),g(this,$o,null)):t&&(t.deleted?this.remove():(A(this,de,S_).call(this),g(this,$o,t.text))),e&&(g(this,Ri,null),A(this,de,__).call(this),A(this,de,b_).call(this));return}if(s||t!=null&&t.deleted){this.remove();return}A(this,de,Tm).call(this),a(this,Pl)||g(this,Pl,{contentsObj:a(this,Mr),richText:a(this,Oi)}),e&&g(this,Pi,null),t&&t.text&&(g(this,Oi,A(this,de,n1).call(this,t.text)),g(this,Bo,Sy.toDateObject(t.date)),g(this,Mr,null)),(r=a(this,Jn))==null||r.remove(),g(this,Jn,null)}resetEdited(){var e;a(this,Pl)&&({contentsObj:bt(this,Mr)._,richText:bt(this,Oi)._}=a(this,Pl),g(this,Pl,null),(e=a(this,Jn))==null||e.remove(),g(this,Jn,null),g(this,Pi,null))}remove(){var e,t,s;if((e=a(this,Ti))==null||e.abort(),g(this,Ti,null),(t=a(this,Jn))==null||t.remove(),g(this,Jn,null),g(this,Uo,!1),g(this,Fr,!1),(s=a(this,ot))==null||s.remove(),g(this,ot,null),this.trigger)for(const r of this.trigger)r.classList.remove("popupTriggerArea")}forceHide(){g(this,Uo,this.isVisible),a(this,Uo)&&(a(this,it).hidden=!0)}maybeShow(){a(this,Yn)||(A(this,de,Tm).call(this),a(this,Uo)&&(a(this,Jn)||A(this,de,Om).call(this),g(this,Uo,!1),a(this,it).hidden=!1))}get isVisible(){return a(this,Yn)?!1:a(this,it).hidden===!1}}Yn=new WeakMap,Fo=new WeakMap,Gy=new WeakMap,qy=new WeakMap,oh=new WeakMap,ah=new WeakMap,it=new WeakMap,Mr=new WeakMap,Bo=new WeakMap,Tl=new WeakMap,lh=new WeakMap,ch=new WeakMap,Fr=new WeakMap,Jn=new WeakMap,Ti=new WeakMap,Pi=new WeakMap,ot=new WeakMap,Ri=new WeakMap,jo=new WeakMap,Np=new WeakMap,Oi=new WeakMap,uh=new WeakMap,Pl=new WeakMap,Uo=new WeakMap,Lt=new WeakMap,$o=new WeakMap,de=new WeakSet,Tm=function(){var t;if(a(this,Ti))return;g(this,Ti,new AbortController);const{signal:e}=a(this,Ti);for(const s of this.trigger)s.addEventListener("click",a(this,oh),{signal:e}),s.addEventListener("pointerenter",a(this,qy),{signal:e}),s.addEventListener("pointerleave",a(this,Gy),{signal:e}),s.classList.add("popupTriggerArea");for(const s of a(this,Tl))(t=s.container)==null||t.addEventListener("keydown",a(this,Fo),{signal:e})},__=function(){const e=a(this,Tl).find(t=>t.hasCommentButton);e&&g(this,Ri,e._normalizePoint(e.commentButtonPosition))},b_=function(){if(a(this,Lt).extraPopupElement&&!a(this,Lt).editor)return;a(this,ot)||this.renderCommentButton();const[e,t]=a(this,Ri),{style:s}=a(this,ot);s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`},S_=function(){a(this,Lt).extraPopupElement||(a(this,ot)||this.renderCommentButton(),a(this,ot).style.backgroundColor=this.commentButtonColor||"")},Pm=function(){const e=a(this,Oi),t=a(this,Mr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&a(this,Oi).html||null},A_=function(){var e,t,s;return((s=(t=(e=a(this,de,Pm))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},t1=function(){var e,t,s;return((s=(t=(e=a(this,de,Pm))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},n1=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:a(this,de,t1),fontSize:a(this,de,A_)?`calc(${a(this,de,A_)}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:r});return s},s1=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&a(this,Fr))&&A(this,de,Rm).call(this)},r1=function(){if(a(this,Pi)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:r,pageY:i}}}=a(this,lh);let o=!!a(this,ch),l=o?a(this,ch):a(this,Np);for(const y of a(this,Tl))if(!l||V.intersect(y.data.rect,l)!==null){l=y.data.rect,o=!0;break}const c=V.normalizeRect([l[0],e[3]-l[1]+e[1],l[2],e[3]-l[3]+e[1]]),h=o?l[2]-l[0]+5:0,d=c[0]+h,f=c[1];g(this,Pi,[100*(d-r)/t,100*(f-i)/s]);const{style:p}=a(this,it);p.left=`${a(this,Pi)[0]}%`,p.top=`${a(this,Pi)[1]}%`},Rm=function(){if(a(this,Yn)){a(this,Yn).toggleCommentPopup(this,!1);return}g(this,Fr,!a(this,Fr)),a(this,Fr)?(A(this,de,Om).call(this),a(this,it).addEventListener("click",a(this,oh)),a(this,it).addEventListener("keydown",a(this,Fo))):(A(this,de,E_).call(this),a(this,it).removeEventListener("click",a(this,oh)),a(this,it).removeEventListener("keydown",a(this,Fo)))},Om=function(){a(this,Jn)||this.render(),this.isVisible?a(this,Fr)&&a(this,it).classList.add("focused"):(A(this,de,r1).call(this),a(this,it).hidden=!1,a(this,it).style.zIndex=parseInt(a(this,it).style.zIndex)+1e3)},E_=function(){a(this,it).classList.remove("focused"),!(a(this,Fr)||!this.isVisible)&&(a(this,it).hidden=!0,a(this,it).style.zIndex=parseInt(a(this,it).style.zIndex)-1e3)};class i1 extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ce.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Mp;class B2 extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Mp,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),o=g(this,Mp,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return a(this,Mp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Mp=new WeakMap;var Fp;class j2 extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Fp,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),o=t.borderStyle.width,l=g(this,Fp,this.svgFactory.createElement("svg:rect"));return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",s-o),l.setAttribute("height",r-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return a(this,Fp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fp=new WeakMap;var Bp;class U2 extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Bp,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:r}=this,i=this.svgFactory.create(s,r,!0),o=t.borderStyle.width,l=g(this,Bp,this.svgFactory.createElement("svg:ellipse"));return l.setAttribute("cx",s/2),l.setAttribute("cy",r/2),l.setAttribute("rx",s/2-o/2),l.setAttribute("ry",r/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return a(this,Bp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bp=new WeakMap;var jp;class o1 extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,jp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:r,popupRef:i},width:o,height:l}=this;if(!s)return this.container;const c=this.svgFactory.create(o,l,!0);let u=[];for(let d=0,f=s.length;d<f;d+=2){const p=s[d]-t[0],y=t[3]-s[d+1];u.push(`${p},${y}`)}u=u.join(" ");const h=g(this,jp,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return a(this,jp)}addHighlightArea(){this.container.classList.add("highlightArea")}}jp=new WeakMap;class $2 extends o1{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class z2 extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var Up,Rl,$p,k_;class dS extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,$p);b(this,Up,null);b(this,Rl,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ce.HIGHLIGHT:ce.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:r,borderStyle:i,popupRef:o}}=this,{transform:l,width:c,height:u}=A(this,$p,k_).call(this,s,t),h=this.svgFactory.create(c,u,!0),d=g(this,Up,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",l);for(let f=0,p=r.length;f<p;f++){const y=this.svgFactory.createElement(this.svgElementName);a(this,Rl).push(y),y.setAttribute("points",r[f].join(",")),d.append(y)}return!o&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:r,rect:i}=t,o=a(this,Up);if(s>=0&&o.setAttribute("stroke-width",s||1),r)for(let l=0,c=a(this,Rl).length;l<c;l++)a(this,Rl)[l].setAttribute("points",r[l].join(","));if(i){const{transform:l,width:c,height:u}=A(this,$p,k_).call(this,this.data.rotation,i);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return a(this,Rl)}addHighlightArea(){this.container.classList.add("highlightArea")}}Up=new WeakMap,Rl=new WeakMap,$p=new WeakSet,k_=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class a1 extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ce.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class H2 extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class V2 extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class W2 extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class l1 extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ce.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var zp,Hp,C_;class G2 extends tt{constructor(t){var r;super(t,{isRenderable:!0});b(this,Hp);b(this,zp,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let r;s.hasAppearance||s.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),r.addEventListener("dblclick",A(this,Hp,C_).bind(this)),g(this,zp,r);const{isMac:i}=Rt.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(i?o.metaKey:o.ctrlKey)&&A(this,Hp,C_).call(this)}),!s.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return a(this,zp)}addHighlightArea(){this.container.classList.add("highlightArea")}}zp=new WeakMap,Hp=new WeakSet,C_=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Ol,Il,hh,zo,Vp,Ll,Qn,Wp,Vi,Im,T_;const _S=class _S{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:r,page:i,viewport:o,structTreeLayer:l,commentManager:c,linkService:u,annotationStorage:h}){b(this,Vi);b(this,Ol,null);b(this,Il,null);b(this,hh,null);b(this,zo,new Map);b(this,Vp,null);b(this,Ll,null);b(this,Qn,[]);b(this,Wp,!1);this.div=e,g(this,Ol,t),g(this,Il,s),g(this,Vp,l||null),g(this,Ll,u||null),g(this,hh,h||new lS),this.page=i,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=c||null}hasEditableAnnotations(){return a(this,zo).size>0}async render(e){var l;const{annotations:t}=e,s=this.div;ac(s,this.viewport);const r=new Map,i=[],o={data:null,layer:s,linkService:a(this,Ll),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Ry,annotationStorage:a(this,hh),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const u=c.annotationType===gt.POPUP;if(u){const f=r.get(c.id);if(!f)continue;if(!this._commentManager){i.push(c);continue}o.elements=f}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;o.data=c;const h=ww.create(o);if(!h.isRenderable)continue;if(!u&&(a(this,Qn).push(h),c.popupRef)){const f=r.get(c.popupRef);f?f.push(h):r.set(c.popupRef,[h])}const d=h.render();c.hidden&&(d.style.visibility="hidden"),h._isEditable&&(a(this,zo).set(h.data.id,h),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(h))}await A(this,Vi,Im).call(this);for(const c of i){const u=o.elements=r.get(c.id);o.data=c;const h=ww.create(o);if(!h.isRenderable)continue;const d=h.render();h.contentElement.id=`${qc}${c.id}`,c.hidden&&(d.style.visibility="hidden"),u.at(-1).container.after(d)}A(this,Vi,T_).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:a(this,Ll),svgFactory:new Ry,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=_S._defaultBorderStyle),t.data=s;const r=ww.create(t);r.isRenderable&&(r.render(),r.contentElement.id=`${qc}${s.id}`,a(this,Qn).push(r))}await A(this,Vi,Im).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,ac(t,{rotation:e.rotation}),A(this,Vi,T_).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(a(this,zo).values())}getEditableAnnotation(e){return a(this,zo).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:s,rotation:r}=e,i=new R2({data:{id:s,rect:e.getPDFRect(),rotation:r},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:a(this,Ll),annotationStorage:a(this,hh)});return i.render(),i.contentElement.id=`${qc}${s}`,i.createOrUpdatePopup(),a(this,Qn).push(i),i}removeAnnotation(e){var r;const t=a(this,Qn).findIndex(i=>i.data.id===e);if(t<0)return;const[s]=a(this,Qn).splice(t,1);(r=a(this,Ol))==null||r.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);A(this,Vi,Im).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return ae(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Cc.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Ol=new WeakMap,Il=new WeakMap,hh=new WeakMap,zo=new WeakMap,Vp=new WeakMap,Ll=new WeakMap,Qn=new WeakMap,Wp=new WeakMap,Vi=new WeakSet,Im=async function(){var s,r,i;if(a(this,Qn).length===0)return;this.div.replaceChildren();const e=[];if(!a(this,Wp)){g(this,Wp,!0);for(const{contentElement:o,data:{id:l}}of a(this,Qn)){const c=o.id=`${qc}${l}`;e.push((s=a(this,Vp))==null?void 0:s.getAriaAttributes(c).then(u=>{if(u)for(const[h,d]of u)o.setAttribute(h,d)}))}}a(this,Qn).sort(({data:{rect:[o,l,c,u]}},{data:{rect:[h,d,f,p]}})=>{if(o===c&&l===u)return 1;if(h===f&&d===p)return-1;const y=u,v=l,S=(l+u)/2,m=p,w=d,_=(d+p)/2;if(S>=m&&_<=v)return-1;if(_>=y&&S<=w)return 1;const E=(o+c)/2,k=(h+f)/2;return E-k});const t=document.createDocumentFragment();for(const o of a(this,Qn))t.append(o.container),this._commentManager?(i=((r=o.extraPopupElement)==null?void 0:r.popup)||o.popup)==null||i.renderCommentButton():o.extraPopupElement&&t.append(o.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),a(this,Ol))for(const o of a(this,Qn))a(this,Ol).addPointerInTextLayer(o.contentElement,!1)},T_=function(){var t;if(!a(this,Il))return;const e=this.div;for(const[s,r]of a(this,Il)){const i=e.querySelector(`[data-annotation-id="${s}"]`);if(!i)continue;r.className="annotationContent";const{firstChild:o}=i;o?o.nodeName==="CANVAS"?o.replaceWith(r):o.classList.contains("annotationContent")?o.after(r):o.before(r):i.append(r);const l=a(this,zo).get(s);l&&(l._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,i.id,r),l._hasNoCanvas=!1):l.canvas=r)}a(this,Il).clear()};let x_=_S;const em=/\r\n?|\n/g;var Zn,Gp,Dl,es,_t,c1,u1,h1,Lm,Wi,Dm,Nm,d1,R_,f1;const Ve=class Ve extends ze{constructor(t){super({...t,name:"freeTextEditor"});b(this,_t);b(this,Zn,"");b(this,Gp,`${this.id}-editor`);b(this,Dl,null);b(this,es);B(this,"_colorPicker",null);this.color=t.color||Ve._defaultColor||ze._defaultLineColor,g(this,es,t.fontSize||Ve._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=Ve.prototype,s=o=>o.isEmpty(),r=lc.TRANSLATE_SMALL,i=lc.TRANSLATE_BIG;return ae(this,"_keyboardManager",new Sg([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}]]))}static initialize(t,s){ze.initialize(t,s);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case ve.FREETEXT_SIZE:Ve._defaultFontSize=s;break;case ve.FREETEXT_COLOR:Ve._defaultColor=s;break}}updateParams(t,s){switch(t){case ve.FREETEXT_SIZE:A(this,_t,c1).call(this,s);break;case ve.FREETEXT_COLOR:A(this,_t,u1).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[ve.FREETEXT_SIZE,Ve._defaultFontSize],[ve.FREETEXT_COLOR,Ve._defaultColor||ze._defaultLineColor]]}get propertiesToUpdate(){return[[ve.FREETEXT_SIZE,a(this,es)],[ve.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Py(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ve.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ve._internalPadding*t,-(Ve._internalPadding+a(this,es))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),g(this,Dl,new AbortController);const t=this._uiManager.combinedSignal(a(this,Dl));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",a(this,Gp)),this._isDraggable=!0,(t=a(this,Dl))==null||t.abort(),g(this,Dl,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=a(this,Zn),s=g(this,Zn,A(this,_t,h1).call(this).trimEnd());if(t===s)return;const r=i=>{if(g(this,Zn,i),!i){this.remove();return}A(this,_t,Nm).call(this),this._uiManager.rebuild(this),A(this,_t,Lm).call(this)};this.addCommands({cmd:()=>{r(s)},undo:()=>{r(t)},mustExec:!1}),A(this,_t,Lm).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ve._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",a(this,Gp)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${a(this,es)}px * var(--total-scale-factor))`,r.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,d]=this.pageDimensions,[f,p]=this.pageTranslation;let y,v;switch(this.rotation){case 0:y=t+(l[0]-f)/h,v=s+this.height-(l[1]-p)/d;break;case 90:y=t+(l[0]-f)/h,v=s-(l[1]-p)/d,[c,u]=[u,-c];break;case 180:y=t-this.width+(l[0]-f)/h,v=s-(l[1]-p)/d,[c,u]=[-c,-u];break;case 270:y=t+(l[0]-f-this.height*d)/h,v=s+(l[1]-p-this.width*h)/d,[c,u]=[-u,c];break}this.setAt(y*i,v*o,c,u)}else this._moveAfterPaste(t,s);A(this,_t,Nm).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,v,S;const s=t.clipboardData||window.clipboardData,{types:r}=s;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const i=A(y=Ve,Wi,R_).call(y,s.getData("text")||"").replaceAll(em,`
`);if(!i)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!i.includes(`
`)){l.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:u}=l,h=[],d=[];if(c.nodeType===Node.TEXT_NODE){const m=c.parentElement;if(d.push(c.nodeValue.slice(u).replaceAll(em,"")),m!==this.editorDiv){let w=h;for(const _ of this.editorDiv.childNodes){if(_===m){w=d;continue}w.push(A(v=Ve,Wi,Dm).call(v,_))}}h.push(c.nodeValue.slice(0,u).replaceAll(em,""))}else if(c===this.editorDiv){let m=h,w=0;for(const _ of this.editorDiv.childNodes)w++===u&&(m=d),m.push(A(S=Ve,Wi,Dm).call(S,_))}g(this,Zn,`${h.join(`
`)}${i}${d.join(`
`)}`),A(this,_t,Nm).call(this);const f=new Range;let p=Math.sumPrecise(h.map(m=>m.length));for(const{firstChild:m}of this.editorDiv.childNodes)if(m.nodeType===Node.TEXT_NODE){const w=m.nodeValue.length;if(p<=w){f.setStart(m,p),f.setEnd(m,p);break}p-=w}o.removeAllRanges(),o.addRange(f)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ve._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,s,r){var l;let i=null;if(t instanceof i1){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:d,id:f,popupRef:p,richText:y,contentsObj:v,creationDate:S,modificationDate:m},textContent:w,textPosition:_,parent:{page:{pageNumber:E}}}=t;if(!w||w.length===0)return null;i=t={annotationType:ce.FREETEXT,color:Array.from(u),fontSize:c,value:w.join(`
`),position:_,pageIndex:E-1,rect:h.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:(v==null?void 0:v.str)||null,richText:y,creationDate:S,modificationDate:m}}const o=await super.deserialize(t,s,r);return g(o,es,t.fontSize),o.color=V.makeHexColor(...t.color),g(o,Zn,A(l=Ve,Wi,R_).call(l,t.value)),o._initialData=i,t.comment&&o.setCommentData(t),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=ze._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),r=Object.assign(super.serialize(t),{color:s,fontSize:a(this,es),value:A(this,_t,d1).call(this)});return this.addComment(r),t?(r.isCopy=!0,r):this.annotationElementId&&!A(this,_t,f1).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(!s)return null;const{style:r}=s;r.fontSize=`calc(${a(this,es)}px * var(--total-scale-factor))`,r.color=this.color,s.replaceChildren();for(const i of a(this,Zn).split(`
`)){const o=document.createElement("div");o.append(i?document.createTextNode(i):document.createElement("br")),s.append(o)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:a(this,Zn)}}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Zn=new WeakMap,Gp=new WeakMap,Dl=new WeakMap,es=new WeakMap,_t=new WeakSet,c1=function(t){const s=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-a(this,es))*this.parentScale),g(this,es,i),A(this,_t,Lm).call(this)},r=a(this,es);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},u1=function(t){const s=i=>{this.color=i,this.onUpdatedColor()},r=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},h1=function(){var r;const t=[];this.editorDiv.normalize();let s=null;for(const i of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(A(r=Ve,Wi,Dm).call(r,i)),s=i);return t.join(`
`)},Lm=function(){const[t,s]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:i,div:o}=this,l=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",i.div.append(this.div),r=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/s):(this.width=r.height/t,this.height=r.width/s),this.fixAndSetPosition()},Wi=new WeakSet,Dm=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(em,"")},Nm=function(){if(this.editorDiv.replaceChildren(),!!a(this,Zn))for(const t of a(this,Zn).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},d1=function(){return a(this,Zn).replaceAll(""," ")},R_=function(t){return t.replaceAll(" ","")},f1=function(t){const{value:s,fontSize:r,color:i,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==s||t.fontSize!==r||t.color.some((l,c)=>l!==i[c])||t.pageIndex!==o},b(Ve,Wi),B(Ve,"_freeTextDefaultContent",""),B(Ve,"_internalPadding",0),B(Ve,"_defaultColor",null),B(Ve,"_defaultFontSize",10),B(Ve,"_type","freetext"),B(Ve,"_editorType",ce.FREETEXT);let P_=Ve;class G{toSVGPath(){Fe("Abstract method `toSVGPath` must be implemented.")}get box(){Fe("Abstract getter `box` must be implemented.")}serialize(e,t){Fe("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,r,i,o){o||(o=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)o[l]=t+e[l]*r,o[l+1]=s+e[l+1]*i;return o}static _rescaleAndSwap(e,t,s,r,i,o){o||(o=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)o[l]=t+e[l+1]*r,o[l+1]=s+e[l]*i;return o}static _translate(e,t,s,r){r||(r=new Float32Array(e.length));for(let i=0,o=e.length;i<o;i+=2)r[i]=t+e[i],r[i+1]=s+e[i+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,r,i){switch(i){case 90:return[1-t/s,e/r];case 180:return[1-e/s,1-t/r];case 270:return[t/s,1-e/r];default:return[e/s,t/r]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,r,i,o){return[(e+5*s)/6,(t+5*r)/6,(5*s+i)/6,(5*r+o)/6,(s+i)/2,(r+o)/2]}}B(G,"PRECISION",1e-4);var ts,sr,dh,fh,Br,ge,Nl,Ml,qp,Kp,ph,gh,Ho,Xp,Ky,Xy,Pt,xd,p1,g1,m1,y1,v1,w1;const si=class si{constructor({x:e,y:t},s,r,i,o,l=0){b(this,Pt);b(this,ts);b(this,sr,[]);b(this,dh);b(this,fh);b(this,Br,[]);b(this,ge,new Float32Array(18));b(this,Nl);b(this,Ml);b(this,qp);b(this,Kp);b(this,ph);b(this,gh);b(this,Ho,[]);g(this,ts,s),g(this,gh,i*r),g(this,fh,o),a(this,ge).set([NaN,NaN,NaN,NaN,e,t],6),g(this,dh,l),g(this,Kp,a(si,Xp)*r),g(this,qp,a(si,Xy)*r),g(this,ph,r),a(this,Ho).push(e,t)}isEmpty(){return isNaN(a(this,ge)[8])}add({x:e,y:t}){var I;g(this,Nl,e),g(this,Ml,t);const[s,r,i,o]=a(this,ts);let[l,c,u,h]=a(this,ge).subarray(8,12);const d=e-u,f=t-h,p=Math.hypot(d,f);if(p<a(this,qp))return!1;const y=p-a(this,Kp),v=y/p,S=v*d,m=v*f;let w=l,_=c;l=u,c=h,u+=S,h+=m,(I=a(this,Ho))==null||I.push(e,t);const E=-m/y,k=S/y,C=E*a(this,gh),x=k*a(this,gh);return a(this,ge).set(a(this,ge).subarray(2,8),0),a(this,ge).set([u+C,h+x],4),a(this,ge).set(a(this,ge).subarray(14,18),12),a(this,ge).set([u-C,h-x],16),isNaN(a(this,ge)[6])?(a(this,Br).length===0&&(a(this,ge).set([l+C,c+x],2),a(this,Br).push(NaN,NaN,NaN,NaN,(l+C-s)/i,(c+x-r)/o),a(this,ge).set([l-C,c-x],14),a(this,sr).push(NaN,NaN,NaN,NaN,(l-C-s)/i,(c-x-r)/o)),a(this,ge).set([w,_,l,c,u,h],6),!this.isEmpty()):(a(this,ge).set([w,_,l,c,u,h],6),Math.abs(Math.atan2(_-c,w-l)-Math.atan2(m,S))<Math.PI/2?([l,c,u,h]=a(this,ge).subarray(2,6),a(this,Br).push(NaN,NaN,NaN,NaN,((l+u)/2-s)/i,((c+h)/2-r)/o),[l,c,w,_]=a(this,ge).subarray(14,18),a(this,sr).push(NaN,NaN,NaN,NaN,((w+l)/2-s)/i,((_+c)/2-r)/o),!0):([w,_,l,c,u,h]=a(this,ge).subarray(0,6),a(this,Br).push(((w+5*l)/6-s)/i,((_+5*c)/6-r)/o,((5*l+u)/6-s)/i,((5*c+h)/6-r)/o,((l+u)/2-s)/i,((c+h)/2-r)/o),[u,h,l,c,w,_]=a(this,ge).subarray(12,18),a(this,sr).push(((w+5*l)/6-s)/i,((_+5*c)/6-r)/o,((5*l+u)/6-s)/i,((5*c+h)/6-r)/o,((l+u)/2-s)/i,((c+h)/2-r)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=a(this,Br),t=a(this,sr);if(isNaN(a(this,ge)[6])&&!this.isEmpty())return A(this,Pt,p1).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?s.push(`L${e[r+4]} ${e[r+5]}`):s.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);A(this,Pt,m1).call(this,s);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return A(this,Pt,g1).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,r,i,o){return new _1(e,t,s,r,i,o)}getOutlines(){var d;const e=a(this,Br),t=a(this,sr),s=a(this,ge),[r,i,o,l]=a(this,ts),c=new Float32Array((((d=a(this,Ho))==null?void 0:d.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(a(this,Ho)[f]-r)/o,c[f+1]=(a(this,Ho)[f+1]-i)/l;if(c[c.length-2]=(a(this,Nl)-r)/o,c[c.length-1]=(a(this,Ml)-i)/l,isNaN(s[6])&&!this.isEmpty())return A(this,Pt,y1).call(this,c);const u=new Float32Array(a(this,Br).length+24+a(this,sr).length);let h=e.length;for(let f=0;f<h;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}h=A(this,Pt,w1).call(this,u,h);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[f+p],u[h+1]=t[f+p+1],h+=2}return A(this,Pt,v1).call(this,u,h),this.newFreeDrawOutline(u,c,a(this,ts),a(this,ph),a(this,dh),a(this,fh))}};ts=new WeakMap,sr=new WeakMap,dh=new WeakMap,fh=new WeakMap,Br=new WeakMap,ge=new WeakMap,Nl=new WeakMap,Ml=new WeakMap,qp=new WeakMap,Kp=new WeakMap,ph=new WeakMap,gh=new WeakMap,Ho=new WeakMap,Xp=new WeakMap,Ky=new WeakMap,Xy=new WeakMap,Pt=new WeakSet,xd=function(){const e=a(this,ge).subarray(4,6),t=a(this,ge).subarray(16,18),[s,r,i,o]=a(this,ts);return[(a(this,Nl)+(e[0]-t[0])/2-s)/i,(a(this,Ml)+(e[1]-t[1])/2-r)/o,(a(this,Nl)+(t[0]-e[0])/2-s)/i,(a(this,Ml)+(t[1]-e[1])/2-r)/o]},p1=function(){const[e,t,s,r]=a(this,ts),[i,o,l,c]=A(this,Pt,xd).call(this);return`M${(a(this,ge)[2]-e)/s} ${(a(this,ge)[3]-t)/r} L${(a(this,ge)[4]-e)/s} ${(a(this,ge)[5]-t)/r} L${i} ${o} L${l} ${c} L${(a(this,ge)[16]-e)/s} ${(a(this,ge)[17]-t)/r} L${(a(this,ge)[14]-e)/s} ${(a(this,ge)[15]-t)/r} Z`},g1=function(e){const t=a(this,sr);e.push(`L${t[4]} ${t[5]} Z`)},m1=function(e){const[t,s,r,i]=a(this,ts),o=a(this,ge).subarray(4,6),l=a(this,ge).subarray(16,18),[c,u,h,d]=A(this,Pt,xd).call(this);e.push(`L${(o[0]-t)/r} ${(o[1]-s)/i} L${c} ${u} L${h} ${d} L${(l[0]-t)/r} ${(l[1]-s)/i}`)},y1=function(e){const t=a(this,ge),[s,r,i,o]=a(this,ts),[l,c,u,h]=A(this,Pt,xd).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-r)/o,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-r)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-r)/o,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-r)/o],0),this.newFreeDrawOutline(d,e,a(this,ts),a(this,ph),a(this,dh),a(this,fh))},v1=function(e,t){const s=a(this,sr);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},w1=function(e,t){const s=a(this,ge).subarray(4,6),r=a(this,ge).subarray(16,18),[i,o,l,c]=a(this,ts),[u,h,d,f]=A(this,Pt,xd).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/l,(s[1]-o)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(r[0]-i)/l,(r[1]-o)/c],t),t+=24},b(si,Xp,8),b(si,Ky,2),b(si,Xy,a(si,Xp)+a(si,Ky));let Oy=si;var mh,Fl,Ii,Yp,ns,Jp,dt,Yy,b1;class _1 extends G{constructor(t,s,r,i,o,l){super();b(this,Yy);b(this,mh);b(this,Fl,new Float32Array(4));b(this,Ii);b(this,Yp);b(this,ns);b(this,Jp);b(this,dt);g(this,dt,t),g(this,ns,s),g(this,mh,r),g(this,Jp,i),g(this,Ii,o),g(this,Yp,l),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],A(this,Yy,b1).call(this,l);const[c,u,h,d]=a(this,Fl);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-c)/h,t[f+1]=(t[f+1]-u)/d;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-c)/h,s[f+1]=(s[f+1]-u)/d}toSVGPath(){const t=[`M${a(this,dt)[4]} ${a(this,dt)[5]}`];for(let s=6,r=a(this,dt).length;s<r;s+=6){if(isNaN(a(this,dt)[s])){t.push(`L${a(this,dt)[s+4]} ${a(this,dt)[s+5]}`);continue}t.push(`C${a(this,dt)[s]} ${a(this,dt)[s+1]} ${a(this,dt)[s+2]} ${a(this,dt)[s+3]} ${a(this,dt)[s+4]} ${a(this,dt)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,r,i],o){const l=r-t,c=i-s;let u,h;switch(o){case 0:u=G._rescale(a(this,dt),t,i,l,-c),h=G._rescale(a(this,ns),t,i,l,-c);break;case 90:u=G._rescaleAndSwap(a(this,dt),t,s,l,c),h=G._rescaleAndSwap(a(this,ns),t,s,l,c);break;case 180:u=G._rescale(a(this,dt),r,s,-l,c),h=G._rescale(a(this,ns),r,s,-l,c);break;case 270:u=G._rescaleAndSwap(a(this,dt),r,i,-l,-c),h=G._rescaleAndSwap(a(this,ns),r,i,-l,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return a(this,Fl)}newOutliner(t,s,r,i,o,l=0){return new Oy(t,s,r,i,o,l)}getNewOutline(t,s){const[r,i,o,l]=a(this,Fl),[c,u,h,d]=a(this,mh),f=o*h,p=l*d,y=r*h+c,v=i*d+u,S=this.newOutliner({x:a(this,ns)[0]*f+y,y:a(this,ns)[1]*p+v},a(this,mh),a(this,Jp),t,a(this,Yp),s??a(this,Ii));for(let m=2;m<a(this,ns).length;m+=2)S.add({x:a(this,ns)[m]*f+y,y:a(this,ns)[m+1]*p+v});return S.getOutlines()}}mh=new WeakMap,Fl=new WeakMap,Ii=new WeakMap,Yp=new WeakMap,ns=new WeakMap,Jp=new WeakMap,dt=new WeakMap,Yy=new WeakSet,b1=function(t){const s=a(this,dt);let r=s[4],i=s[5];const o=[r,i,r,i];let l=r,c=i,u=r,h=i;const d=t?Math.max:Math.min,f=new Float32Array(4);for(let y=6,v=s.length;y<v;y+=6){const S=s[y+4],m=s[y+5];isNaN(s[y])?(V.pointBoundingBox(S,m,o),c>m?(l=S,c=m):c===m&&(l=d(l,S)),h<m?(u=S,h=m):h===m&&(u=d(u,S))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,V.bezierBoundingBox(r,i,...s.slice(y,y+6),f),V.rectBoundingBox(f[0],f[1],f[2],f[3],o),c>f[1]?(l=f[0],c=f[1]):c===f[1]&&(l=d(l,f[0])),h<f[3]?(u=f[2],h=f[3]):h===f[3]&&(u=d(u,f[2]))),r=S,i=m}const p=a(this,Fl);p[0]=o[0]-a(this,Ii),p[1]=o[1]-a(this,Ii),p[2]=o[2]-o[0]+2*a(this,Ii),p[3]=o[3]-o[1]+2*a(this,Ii),this.firstPoint=[l,c],this.lastPoint=[u,h]};var Qp,Zp,eg,Vo,rr,En,S1,Mm,A1,E1,I_;class O_{constructor(e,t=0,s=0,r=!0){b(this,En);b(this,Qp);b(this,Zp);b(this,eg);b(this,Vo,[]);b(this,rr,[]);const i=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:v,y:S,width:m,height:w}of e){const _=Math.floor((v-t)/o)*o,E=Math.ceil((v+m+t)/o)*o,k=Math.floor((S-t)/o)*o,C=Math.ceil((S+w+t)/o)*o,x=[_,k,C,!0],P=[E,k,C,!1];a(this,Vo).push(x,P),V.rectBoundingBox(_,k,E,C,i)}const l=i[2]-i[0]+2*s,c=i[3]-i[1]+2*s,u=i[0]-s,h=i[1]-s;let d=r?-1/0:1/0,f=1/0;const p=a(this,Vo).at(r?-1:-2),y=[p[0],p[2]];for(const v of a(this,Vo)){const[S,m,w,_]=v;!_&&r?m<f?(f=m,d=S):m===f&&(d=Math.max(d,S)):_&&!r&&(m<f?(f=m,d=S):m===f&&(d=Math.min(d,S))),v[0]=(S-u)/l,v[1]=(m-h)/c,v[2]=(w-h)/c}g(this,Qp,new Float32Array([u,h,l,c])),g(this,Zp,[d,f]),g(this,eg,y)}getOutlines(){a(this,Vo).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of a(this,Vo))t[3]?(e.push(...A(this,En,I_).call(this,t)),A(this,En,A1).call(this,t)):(A(this,En,E1).call(this,t),e.push(...A(this,En,I_).call(this,t)));return A(this,En,S1).call(this,e)}}Qp=new WeakMap,Zp=new WeakMap,eg=new WeakMap,Vo=new WeakMap,rr=new WeakMap,En=new WeakSet,S1=function(e){const t=[],s=new Set;for(const o of e){const[l,c,u]=o;t.push([l,c,o],[l,u,o])}t.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=t.length;o<l;o+=2){const c=t[o][2],u=t[o+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const r=[];let i;for(;s.size>0;){const o=s.values().next().value;let[l,c,u,h,d]=o;s.delete(o);let f=l,p=c;for(i=[l,u],r.push(i);;){let y;if(s.has(h))y=h;else if(s.has(d))y=d;else break;s.delete(y),[l,c,u,h,d]=y,f!==l&&(i.push(f,p,l,p===c?c:u),f=l),p=p===c?u:c}i.push(f,p)}return new q2(r,a(this,Qp),a(this,Zp),a(this,eg))},Mm=function(e){const t=a(this,rr);let s=0,r=t.length-1;for(;s<=r;){const i=s+r>>1,o=t[i][0];if(o===e)return i;o<e?s=i+1:r=i-1}return r+1},A1=function([,e,t]){const s=A(this,En,Mm).call(this,e);a(this,rr).splice(s,0,[e,t])},E1=function([,e,t]){const s=A(this,En,Mm).call(this,e);for(let r=s;r<a(this,rr).length;r++){const[i,o]=a(this,rr)[r];if(i!==e)break;if(i===e&&o===t){a(this,rr).splice(r,1);return}}for(let r=s-1;r>=0;r--){const[i,o]=a(this,rr)[r];if(i!==e)break;if(i===e&&o===t){a(this,rr).splice(r,1);return}}},I_=function(e){const[t,s,r]=e,i=[[t,s,r]],o=A(this,En,Mm).call(this,r);for(let l=0;l<o;l++){const[c,u]=a(this,rr)[l];for(let h=0,d=i.length;h<d;h++){const[,f,p]=i[h];if(!(u<=f||p<=c)){if(f>=c){if(p>u)i[h][1]=u;else{if(d===1)return[];i.splice(h,1),h--,d--}continue}i[h][2]=c,p>u&&i.push([t,u,p])}}}return i};var tg,yh;class q2 extends G{constructor(t,s,r,i){super();b(this,tg);b(this,yh);g(this,yh,t),g(this,tg,s),this.firstPoint=r,this.lastPoint=i}toSVGPath(){const t=[];for(const s of a(this,yh)){let[r,i]=s;t.push(`M${r} ${i}`);for(let o=2;o<s.length;o+=2){const l=s[o],c=s[o+1];l===r?(t.push(`V${c}`),i=c):c===i&&(t.push(`H${l}`),r=l)}t.push("Z")}return t.join(" ")}serialize([t,s,r,i],o){const l=[],c=r-t,u=i-s;for(const h of a(this,yh)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=t+h[f]*c,d[f+1]=i-h[f+1]*u;l.push(d)}return l}get box(){return a(this,tg)}get classNamesForOutlining(){return["highlightOutline"]}}tg=new WeakMap,yh=new WeakMap;class L_ extends Oy{newFreeDrawOutline(e,t,s,r,i,o){return new K2(e,t,s,r,i,o)}}class K2 extends _1{newOutliner(e,t,s,r,i,o=0){return new L_(e,t,s,r,i,o)}}var vh,ng,Li,Bl,sg,Ln,rg,ig,jl,ss,rs,qt,wh,_h,un,bh,Is,og,he,D_,Fm,k1,C1,x1,N_,Ta,Ms,Ic,T1,Bm,jm,P1,R1,O1,I1,L1;const Ae=class Ae extends ze{constructor(t){super({...t,name:"highlightEditor"});b(this,he);b(this,vh,null);b(this,ng,0);b(this,Li);b(this,Bl,null);b(this,sg,null);b(this,Ln,null);b(this,rg,null);b(this,ig,0);b(this,jl,null);b(this,ss,null);b(this,rs,null);b(this,qt,!1);b(this,wh,null);b(this,_h,null);b(this,un,null);b(this,bh,"");b(this,Is);b(this,og,"");this.color=t.color||Ae._defaultColor,g(this,Is,t.thickness||Ae._defaultThickness),this.opacity=t.opacity||Ae._defaultOpacity,g(this,Li,t.boxes||null),g(this,og,t.methodOfCreation||""),g(this,bh,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(g(this,qt,!0),A(this,he,Fm).call(this,t),A(this,he,Ta).call(this)):a(this,Li)&&(g(this,vh,t.anchorNode),g(this,ng,t.anchorOffset),g(this,rg,t.focusNode),g(this,ig,t.focusOffset),A(this,he,D_).call(this),A(this,he,Ta).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Ae.prototype;return ae(this,"_keyboardManager",new Sg([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:a(this,qt)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:a(this,Is),methodOfCreation:a(this,og)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var r;ze.initialize(t,s),Ae._defaultColor||(Ae._defaultColor=((r=s.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case ve.HIGHLIGHT_COLOR:Ae._defaultColor=s;break;case ve.HIGHLIGHT_THICKNESS:Ae._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return a(this,_h)}get commentButtonPosition(){return a(this,wh)}updateParams(t,s){switch(t){case ve.HIGHLIGHT_COLOR:A(this,he,k1).call(this,s);break;case ve.HIGHLIGHT_THICKNESS:A(this,he,C1).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[ve.HIGHLIGHT_COLOR,Ae._defaultColor],[ve.HIGHLIGHT_THICKNESS,Ae._defaultThickness]]}get propertiesToUpdate(){return[[ve.HIGHLIGHT_COLOR,this.color||Ae._defaultColor],[ve.HIGHLIGHT_THICKNESS,a(this,Is)||Ae._defaultThickness],[ve.HIGHLIGHT_FREE,a(this,qt)]]}onUpdatedColor(){var t,s;(t=this.parent)==null||t.drawLayer.updateProperties(a(this,rs),{root:{fill:this.color,"fill-opacity":this.opacity}}),(s=a(this,sg))==null||s.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",g(this,sg,new Ty({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,he,jm).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,A(this,he,jm).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){A(this,he,N_).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,he,Ta).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let s=!1;this.parent&&!t?A(this,he,N_).call(this):t&&(A(this,he,Ta).call(this,t),s=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var i,o,l;const{drawLayer:s}=this.parent;let r;a(this,qt)?(t=(t-this.rotation+360)%360,r=A(i=Ae,Ms,Ic).call(i,a(this,ss).box,t)):r=A(o=Ae,Ms,Ic).call(o,[this.x,this.y,this.width,this.height],t),s.updateProperties(a(this,rs),{bbox:r,root:{"data-main-rotation":t}}),s.updateProperties(a(this,un),{bbox:A(l=Ae,Ms,Ic).call(l,a(this,Ln).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();a(this,bh)&&(t.setAttribute("aria-label",a(this,bh)),t.setAttribute("role","mark")),a(this,qt)?t.classList.add("free"):this.div.addEventListener("keydown",A(this,he,T1).bind(this),{signal:this._uiManager._signal});const s=g(this,jl,document.createElement("div"));return t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=a(this,Bl),this.setDims(),Jx(this,a(this,jl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(a(this,un),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(a(this,un),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:A(this,he,Bm).call(this,!0);break;case 1:case 3:A(this,he,Bm).call(this,!1);break}}select(){var t;super.select(),a(this,un)&&((t=this.parent)==null||t.drawLayer.updateProperties(a(this,un),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),a(this,un)&&((t=this.parent)==null||t.drawLayer.updateProperties(a(this,un),{rootClass:{selected:!1}}),a(this,qt)||A(this,he,Bm).call(this,!1))}get _mustFixPosition(){return!a(this,qt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(a(this,rs),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(a(this,un),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:r,x:i,y:o}){const{x:l,y:c,width:u,height:h}=r.getBoundingClientRect(),d=new AbortController,f=t.combinedSignal(d),p=y=>{d.abort(),A(this,Ms,I1).call(this,t,y)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",ut,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",zs,{signal:f}),r.addEventListener("pointermove",A(this,Ms,O1).bind(this,t),{signal:f}),this._freeHighlight=new L_({x:i,y:o},[l,c,u,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,r){var v,S,m,w;let i=null;if(t instanceof a1){const{data:{quadPoints:_,rect:E,rotation:k,id:C,color:x,opacity:P,popupRef:I,richText:N,contentsObj:j,creationDate:ee,modificationDate:se},parent:{page:{pageNumber:Q}}}=t;i=t={annotationType:ce.HIGHLIGHT,color:Array.from(x),opacity:P,quadPoints:_,boxes:null,pageIndex:Q-1,rect:E.slice(0),rotation:k,annotationElementId:C,id:C,deleted:!1,popupRef:I,richText:N,comment:(j==null?void 0:j.str)||null,creationDate:ee,modificationDate:se}}else if(t instanceof dS){const{data:{inkLists:_,rect:E,rotation:k,id:C,color:x,borderStyle:{rawWidth:P},popupRef:I,richText:N,contentsObj:j,creationDate:ee,modificationDate:se},parent:{page:{pageNumber:Q}}}=t;i=t={annotationType:ce.HIGHLIGHT,color:Array.from(x),thickness:P,inkLists:_,boxes:null,pageIndex:Q-1,rect:E.slice(0),rotation:k,annotationElementId:C,id:C,deleted:!1,popupRef:I,richText:N,comment:(j==null?void 0:j.str)||null,creationDate:ee,modificationDate:se}}const{color:o,quadPoints:l,inkLists:c,opacity:u}=t,h=await super.deserialize(t,s,r);h.color=V.makeHexColor(...o),h.opacity=u||1,c&&g(h,Is,t.thickness),h._initialData=i,t.comment&&h.setCommentData(t);const[d,f]=h.pageDimensions,[p,y]=h.pageTranslation;if(l){const _=g(h,Li,[]);for(let E=0;E<l.length;E+=8)_.push({x:(l[E]-p)/d,y:1-(l[E+1]-y)/f,width:(l[E+2]-l[E])/d,height:(l[E+1]-l[E+5])/f});A(v=h,he,D_).call(v),A(S=h,he,Ta).call(S),h.rotate(h.rotation)}else if(c){g(h,qt,!0);const _=c[0],E={x:_[0]-p,y:f-(_[1]-y)},k=new L_(E,[0,0,d,f],1,a(h,Is)/2,!0,.001);for(let P=0,I=_.length;P<I;P+=2)E.x=_[P]-p,E.y=f-(_[P+1]-y),k.add(E);const{id:C,clipPathId:x}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:k.toSVGPath()}},!0,!0);A(m=h,he,Fm).call(m,{highlightOutlines:k.getOutlines(),highlightId:C,clipPathId:x}),A(w=h,he,Ta).call(w),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=ze._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),r=super.serialize(t);return Object.assign(r,{color:s,opacity:this.opacity,thickness:a(this,Is),quadPoints:A(this,he,P1).call(this),outlines:A(this,he,R1).call(this,r.rect)}),this.addComment(r),this.annotationElementId&&!A(this,he,L1).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};vh=new WeakMap,ng=new WeakMap,Li=new WeakMap,Bl=new WeakMap,sg=new WeakMap,Ln=new WeakMap,rg=new WeakMap,ig=new WeakMap,jl=new WeakMap,ss=new WeakMap,rs=new WeakMap,qt=new WeakMap,wh=new WeakMap,_h=new WeakMap,un=new WeakMap,bh=new WeakMap,Is=new WeakMap,og=new WeakMap,he=new WeakSet,D_=function(){const t=new O_(a(this,Li),.001);g(this,ss,t.getOutlines()),[this.x,this.y,this.width,this.height]=a(this,ss).box;const s=new O_(a(this,Li),.0025,.001,this._uiManager.direction==="ltr");g(this,Ln,s.getOutlines());const{firstPoint:r}=a(this,ss);g(this,wh,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]);const{lastPoint:i}=a(this,Ln);g(this,_h,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Fm=function({highlightOutlines:t,highlightId:s,clipPathId:r}){var f,p;if(g(this,ss,t),g(this,Ln,t.getNewOutline(a(this,Is)/2+1.5,.0025)),s>=0)g(this,rs,s),g(this,Bl,r),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),g(this,un,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:a(this,Ln).box,path:{d:a(this,Ln).toSVGPath()}},!0));else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(a(this,rs),{bbox:A(f=Ae,Ms,Ic).call(f,a(this,ss).box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(a(this,un),{bbox:A(p=Ae,Ms,Ic).call(p,a(this,Ln).box,y),path:{d:a(this,Ln).toSVGPath()}})}const[o,l,c,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=c,this.height=u;break;case 90:{const[y,v]=this.parentDimensions;this.x=l,this.y=1-o,this.width=c*v/y,this.height=u*y/v;break}case 180:this.x=1-o,this.y=1-l,this.width=c,this.height=u;break;case 270:{const[y,v]=this.parentDimensions;this.x=1-l,this.y=o,this.width=c*v/y,this.height=u*y/v;break}}const{firstPoint:h}=t;g(this,wh,[(h[0]-o)/c,(h[1]-l)/u]);const{lastPoint:d}=a(this,Ln);g(this,_h,[(d[0]-o)/c,(d[1]-l)/u])},k1=function(t){const s=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},r=this.color,i=this.opacity;this.addCommands({cmd:s.bind(this,t,Ae._defaultOpacity),undo:s.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},C1=function(t){const s=a(this,Is),r=i=>{g(this,Is,i),A(this,he,x1).call(this,i)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},x1=function(t){a(this,qt)&&(A(this,he,Fm).call(this,{highlightOutlines:a(this,ss).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},N_=function(){a(this,rs)===null||!this.parent||(this.parent.drawLayer.remove(a(this,rs)),g(this,rs,null),this.parent.drawLayer.remove(a(this,un)),g(this,un,null))},Ta=function(t=this.parent){a(this,rs)===null&&({id:bt(this,rs)._,clipPathId:bt(this,Bl)._}=t.drawLayer.draw({bbox:a(this,ss).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:a(this,qt)},path:{d:a(this,ss).toSVGPath()}},!1,!0),g(this,un,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:a(this,qt)},bbox:a(this,Ln).box,path:{d:a(this,Ln).toSVGPath()}},a(this,qt))),a(this,jl)&&(a(this,jl).style.clipPath=a(this,Bl)))},Ms=new WeakSet,Ic=function([t,s,r,i],o){switch(o){case 90:return[1-s-i,t,i,r];case 180:return[1-t-r,1-s-i,r,i];case 270:return[s,1-t-r,i,r]}return[t,s,r,i]},T1=function(t){Ae._keyboardManager.exec(this,t)},Bm=function(t){if(!a(this,vh))return;const s=window.getSelection();t?s.setPosition(a(this,vh),a(this,ng)):s.setPosition(a(this,rg),a(this,ig))},jm=function(){return a(this,qt)?this.rotation:0},P1=function(){if(a(this,qt))return null;const[t,s]=this.pageDimensions,[r,i]=this.pageTranslation,o=a(this,Li),l=new Float32Array(o.length*8);let c=0;for(const{x:u,y:h,width:d,height:f}of o){const p=u*t+r,y=(1-h)*s+i;l[c]=l[c+4]=p,l[c+1]=l[c+3]=y,l[c+2]=l[c+6]=p+d*t,l[c+5]=l[c+7]=y-f*s,c+=8}return l},R1=function(t){return a(this,ss).serialize(t,A(this,he,jm).call(this))},O1=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},I1=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},L1=function(t){const{color:s}=this._initialData;return this.hasEditedComment||t.color.some((r,i)=>r!==s[i])},b(Ae,Ms),B(Ae,"_defaultColor",null),B(Ae,"_defaultOpacity",1),B(Ae,"_defaultThickness",12),B(Ae,"_type","highlight"),B(Ae,"_editorType",ce.HIGHLIGHT),B(Ae,"_freeHighlightId",-1),B(Ae,"_freeHighlight",null),B(Ae,"_freeHighlightClipId","");let Iy=Ae;var Ul;class D1{constructor(){b(this,Ul,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){a(this,Ul)[e]=t}toSVGProperties(){const e=a(this,Ul);return g(this,Ul,Object.create(null)),{root:e}}reset(){g(this,Ul,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Fe("Not implemented")}}Ul=new WeakMap;var is,Sh,Dt,$l,zl,be,M_,F_,B_,Td,N1,Um,Pd,Lc;const ye=class ye extends ze{constructor(t){super(t);b(this,be);b(this,is,null);b(this,Sh);B(this,"_colorPicker",null);B(this,"_drawId",null);g(this,Sh,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(A(this,be,M_).call(this,t),A(this,be,Td).call(this))}static _mergeSVGProperties(t,s){const r=new Set(Object.keys(t));for(const[i,o]of Object.entries(s))r.has(i)?Object.assign(t[i],o):t[i]=o;return t}static getDefaultDrawingOptions(t){Fe("Not implemented")}static get typesMap(){Fe("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,s),this._currentParent&&(a(ye,Dt).updateProperty(r,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[r,i]of this.typesMap)t.push([r,s[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[r,i]of this.constructor.typesMap)t.push([r,s[i]]);return t}_updateProperty(t,s,r){const i=this._drawingOptions,o=i[s],l=c=>{var h;i.updateProperty(s,c);const u=a(this,is).updateProperty(s,c);u&&A(this,be,Pd).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,r),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ye._mergeSVGProperties(a(this,is).getPathResizingSVGProperties(A(this,be,Um).call(this)),{bbox:A(this,be,Lc).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ye._mergeSVGProperties(a(this,is).getPathResizedSVGProperties(A(this,be,Um).call(this)),{bbox:A(this,be,Lc).call(this)}))}_onTranslating(t,s){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:A(this,be,Lc).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,ye._mergeSVGProperties(a(this,is).getPathTranslatedSVGProperties(A(this,be,Um).call(this),this.parentDimensions),{bbox:A(this,be,Lc).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,a(this,Sh)&&(g(this,Sh,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){A(this,be,B_).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,be,Td).call(this),A(this,be,Pd).call(this,a(this,is).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),A(this,be,B_).call(this)):t&&(this._uiManager.addShouldRescale(this),A(this,be,Td).call(this,t),s=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ye._mergeSVGProperties({bbox:A(this,be,Lc).call(this)},a(this,is).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,be,Pd).call(this,a(this,is).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const r=super.render();r.classList.add("draw");const i=document.createElement("div");return r.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),r}static createDrawerInstance(t,s,r,i,o){Fe("Not implemented")}static startDrawing(t,s,r,i){var S;const{target:o,offsetX:l,offsetY:c,pointerId:u,pointerType:h}=i;if(rn.isInitializedAndDifferentPointerType(h))return;const{viewport:{rotation:d}}=t,{width:f,height:p}=o.getBoundingClientRect(),y=g(ye,$l,new AbortController),v=t.combinedSignal(y);if(rn.setPointer(h,u),window.addEventListener("pointerup",m=>{rn.isSamePointerIdOrRemove(m.pointerId)&&this._endDraw(m)},{signal:v}),window.addEventListener("pointercancel",m=>{rn.isSamePointerIdOrRemove(m.pointerId)&&this._currentParent.endDrawingSession()},{signal:v}),window.addEventListener("pointerdown",m=>{rn.isSamePointerType(m.pointerType)&&(rn.initializeAndAddPointerId(m.pointerId),a(ye,Dt).isCancellable()&&(a(ye,Dt).removeLastElement(),a(ye,Dt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",zs,{signal:v}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:v}),o.addEventListener("touchmove",m=>{rn.isSameTimeStamp(m.timeStamp)&&ut(m)},{signal:v}),t.toggleDrawing(),(S=s._editorUndoBar)==null||S.hide(),a(ye,Dt)){t.drawLayer.updateProperties(this._currentDrawId,a(ye,Dt).startNew(l,c,f,p,d));return}s.updateUIForDefaultProperties(this),g(ye,Dt,this.createDrawerInstance(l,c,f,p,d)),g(ye,zl,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(a(ye,zl).toSVGProperties(),a(ye,Dt).defaultSVGProperties),!0,!1)}static _drawMove(t){if(rn.isSameTimeStamp(t.timeStamp),!a(ye,Dt))return;const{offsetX:s,offsetY:r,pointerId:i}=t;if(rn.isSamePointerId(i)){if(rn.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,a(ye,Dt).add(s,r)),rn.setTimeStamp(t.timeStamp),ut(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,g(ye,Dt,null),g(ye,zl,null),rn.clearTimeStamp()),a(ye,$l)&&(a(ye,$l).abort(),g(ye,$l,null),rn.clearPointerIds())}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,a(ye,Dt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=a(ye,Dt),i=this._currentDrawId,o=r.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(i,r.setLastElement(o))},undo:()=>{s.drawLayer.updateProperties(i,r.removeLastElement())},mustExec:!1,type:ve.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(ve.DRAW_STEP),!a(ye,Dt).isEmpty()){const{pageDimensions:[r,i],scale:o}=s,l=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:a(ye,Dt).getOutlines(r*o,i*o,o,this._INNER_MARGIN),drawingOptions:a(ye,zl),mustBeCommitted:!t});return this._cleanup(!0),l}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,r,i,o,l){Fe("Not implemented")}static async deserialize(t,s,r){var d,f;const{rawDims:{pageWidth:i,pageHeight:o,pageX:l,pageY:c}}=s.viewport,u=this.deserializeDraw(l,c,i,o,this._INNER_MARGIN,t),h=await super.deserialize(t,s,r);return h.createDrawingOptions(t),A(d=h,be,M_).call(d,{drawOutlines:u}),A(f=h,be,Td).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,r]=this.pageTranslation,[i,o]=this.pageDimensions;return a(this,is).serialize([s,r,i,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};is=new WeakMap,Sh=new WeakMap,Dt=new WeakMap,$l=new WeakMap,zl=new WeakMap,be=new WeakSet,M_=function({drawOutlines:t,drawId:s,drawingOptions:r}){g(this,is,t),this._drawingOptions||(this._drawingOptions=r),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=A(this,be,F_).call(this,t,this.parent),A(this,be,Pd).call(this,t.box)},F_=function(t,s){const{id:r}=s.drawLayer.draw(ye._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},B_=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Td=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,be,F_).call(this,a(this,is),t)}},N1=function([t,s,r,i]){const{parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[s,1-t,r*(l/o),i*(o/l)];case 180:return[1-t,1-s,r,i];case 270:return[1-s,t,r*(l/o),i*(o/l)];default:return[t,s,r,i]}},Um=function(){const{x:t,y:s,width:r,height:i,parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[1-s,t,r*(o/l),i*(l/o)];case 180:return[1-t,1-s,r,i];case 270:return[s,1-t,r*(o/l),i*(l/o)];default:return[t,s,r,i]}},Pd=function(t){[this.x,this.y,this.width,this.height]=A(this,be,N1).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Lc=function(){const{x:t,y:s,width:r,height:i,rotation:o,parentRotation:l,parentDimensions:[c,u]}=this;switch((o*4+l)/90){case 1:return[1-s-i,t,i,r];case 2:return[1-t-r,1-s-i,r,i];case 3:return[s,1-t-r,i,r];case 4:return[t,s-r*(c/u),i*(u/c),r*(c/u)];case 5:return[1-s,t,r*(c/u),i*(u/c)];case 6:return[1-t-i*(u/c),1-s,i*(u/c),r*(c/u)];case 7:return[s-r*(c/u),1-t-i*(u/c),r*(c/u),i*(u/c)];case 8:return[t-r,s-i,r,i];case 9:return[1-s,t-r,i,r];case 10:return[1-t,1-s,r,i];case 11:return[s-i,1-t,i,r];case 12:return[t-i*(u/c),s,i*(u/c),r*(c/u)];case 13:return[1-s-r*(c/u),t-i*(u/c),r*(c/u),i*(u/c)];case 14:return[1-t,1-s-r*(c/u),i*(u/c),r*(c/u)];case 15:return[s,1-t,r*(c/u),i*(u/c)];default:return[t,s,r,i]}},B(ye,"_currentDrawId",-1),B(ye,"_currentParent",null),b(ye,Dt,null),b(ye,$l,null),b(ye,zl,null),B(ye,"_INNER_MARGIN",3);let Ly=ye;var jr,Nt,Mt,Hl,Ah,mn,Kt,Ls,Vl,Wl,Gl,Eh,$m;class X2{constructor(e,t,s,r,i,o){b(this,Eh);b(this,jr,new Float64Array(6));b(this,Nt);b(this,Mt);b(this,Hl);b(this,Ah);b(this,mn);b(this,Kt,"");b(this,Ls,0);b(this,Vl,new Eg);b(this,Wl);b(this,Gl);g(this,Wl,s),g(this,Gl,r),g(this,Hl,i),g(this,Ah,o),[e,t]=A(this,Eh,$m).call(this,e,t);const l=g(this,Nt,[NaN,NaN,NaN,NaN,e,t]);g(this,mn,[e,t]),g(this,Mt,[{line:l,points:a(this,mn)}]),a(this,jr).set(l,0)}updateProperty(e,t){e==="stroke-width"&&g(this,Ah,t)}isEmpty(){return!a(this,Mt)||a(this,Mt).length===0}isCancellable(){return a(this,mn).length<=10}add(e,t){[e,t]=A(this,Eh,$m).call(this,e,t);const[s,r,i,o]=a(this,jr).subarray(2,6),l=e-i,c=t-o;return Math.hypot(a(this,Wl)*l,a(this,Gl)*c)<=2?null:(a(this,mn).push(e,t),isNaN(s)?(a(this,jr).set([i,o,e,t],2),a(this,Nt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(a(this,jr)[0])&&a(this,Nt).splice(6,6),a(this,jr).set([s,r,i,o,e,t],0),a(this,Nt).push(...G.createBezierPoints(s,r,i,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(a(this,mn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,r,i){g(this,Wl,s),g(this,Gl,r),g(this,Hl,i),[e,t]=A(this,Eh,$m).call(this,e,t);const o=g(this,Nt,[NaN,NaN,NaN,NaN,e,t]);g(this,mn,[e,t]);const l=a(this,Mt).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),a(this,Mt).push({line:o,points:a(this,mn)}),a(this,jr).set(o,0),g(this,Ls,0),this.toSVGPath(),null}getLastElement(){return a(this,Mt).at(-1)}setLastElement(e){return a(this,Mt)?(a(this,Mt).push(e),g(this,Nt,e.line),g(this,mn,e.points),g(this,Ls,0),{path:{d:this.toSVGPath()}}):a(this,Vl).setLastElement(e)}removeLastElement(){if(!a(this,Mt))return a(this,Vl).removeLastElement();a(this,Mt).pop(),g(this,Kt,"");for(let e=0,t=a(this,Mt).length;e<t;e++){const{line:s,points:r}=a(this,Mt)[e];g(this,Nt,s),g(this,mn,r),g(this,Ls,0),this.toSVGPath()}return{path:{d:a(this,Kt)}}}toSVGPath(){const e=G.svgRound(a(this,Nt)[4]),t=G.svgRound(a(this,Nt)[5]);if(a(this,mn).length===2)return g(this,Kt,`${a(this,Kt)} M ${e} ${t} Z`),a(this,Kt);if(a(this,mn).length<=6){const r=a(this,Kt).lastIndexOf("M");g(this,Kt,`${a(this,Kt).slice(0,r)} M ${e} ${t}`),g(this,Ls,6)}if(a(this,mn).length===4){const r=G.svgRound(a(this,Nt)[10]),i=G.svgRound(a(this,Nt)[11]);return g(this,Kt,`${a(this,Kt)} L ${r} ${i}`),g(this,Ls,12),a(this,Kt)}const s=[];a(this,Ls)===0&&(s.push(`M ${e} ${t}`),g(this,Ls,6));for(let r=a(this,Ls),i=a(this,Nt).length;r<i;r+=6){const[o,l,c,u,h,d]=a(this,Nt).slice(r,r+6).map(G.svgRound);s.push(`C${o} ${l} ${c} ${u} ${h} ${d}`)}return g(this,Kt,a(this,Kt)+s.join(" ")),g(this,Ls,a(this,Nt).length),a(this,Kt)}getOutlines(e,t,s,r){const i=a(this,Mt).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),a(this,Vl).build(a(this,Mt),e,t,s,a(this,Hl),a(this,Ah),r),g(this,jr,null),g(this,Nt,null),g(this,Mt,null),g(this,Kt,null),a(this,Vl)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}jr=new WeakMap,Nt=new WeakMap,Mt=new WeakMap,Hl=new WeakMap,Ah=new WeakMap,mn=new WeakMap,Kt=new WeakMap,Ls=new WeakMap,Vl=new WeakMap,Wl=new WeakMap,Gl=new WeakMap,Eh=new WeakSet,$m=function(e,t){return G._normalizePoint(e,t,a(this,Wl),a(this,Gl),a(this,Hl))};var yn,ag,lg,os,Ur,$r,kh,Ch,ql,Jt,Zr,M1,F1,B1;class Eg extends G{constructor(){super(...arguments);b(this,Jt);b(this,yn);b(this,ag,0);b(this,lg);b(this,os);b(this,Ur);b(this,$r);b(this,kh);b(this,Ch);b(this,ql)}build(t,s,r,i,o,l,c){g(this,Ur,s),g(this,$r,r),g(this,kh,i),g(this,Ch,o),g(this,ql,l),g(this,lg,c??0),g(this,os,t),A(this,Jt,F1).call(this)}get thickness(){return a(this,ql)}setLastElement(t){return a(this,os).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return a(this,os).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of a(this,os)){if(t.push(`M${G.svgRound(s[4])} ${G.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${G.svgRound(s[10])} ${G.svgRound(s[11])}`);continue}for(let r=6,i=s.length;r<i;r+=6){const[o,l,c,u,h,d]=s.subarray(r,r+6).map(G.svgRound);t.push(`C${o} ${l} ${c} ${u} ${h} ${d}`)}}return t.join("")}serialize([t,s,r,i],o){const l=[],c=[],[u,h,d,f]=A(this,Jt,M1).call(this);let p,y,v,S,m,w,_,E,k;switch(a(this,Ch)){case 0:k=G._rescale,p=t,y=s+i,v=r,S=-i,m=t+u*r,w=s+(1-h-f)*i,_=t+(u+d)*r,E=s+(1-h)*i;break;case 90:k=G._rescaleAndSwap,p=t,y=s,v=r,S=i,m=t+h*r,w=s+u*i,_=t+(h+f)*r,E=s+(u+d)*i;break;case 180:k=G._rescale,p=t+r,y=s,v=-r,S=i,m=t+(1-u-d)*r,w=s+h*i,_=t+(1-u)*r,E=s+(h+f)*i;break;case 270:k=G._rescaleAndSwap,p=t+r,y=s+i,v=-r,S=-i,m=t+(1-h-f)*r,w=s+(1-u-d)*i,_=t+(1-h)*r,E=s+(1-u)*i;break}for(const{line:C,points:x}of a(this,os))l.push(k(C,p,y,v,S,o?new Array(C.length):null)),c.push(k(x,p,y,v,S,o?new Array(x.length):null));return{lines:l,points:c,rect:[m,w,_,E]}}static deserialize(t,s,r,i,o,{paths:{lines:l,points:c},rotation:u,thickness:h}){const d=[];let f,p,y,v,S;switch(u){case 0:S=G._rescale,f=-t/r,p=s/i+1,y=1/r,v=-1/i;break;case 90:S=G._rescaleAndSwap,f=-s/i,p=-t/r,y=1/i,v=1/r;break;case 180:S=G._rescale,f=t/r+1,p=-s/i,y=-1/r,v=1/i;break;case 270:S=G._rescaleAndSwap,f=s/i+1,p=t/r+1,y=-1/i,v=-1/r;break}if(!l){l=[];for(const w of c){const _=w.length;if(_===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(_===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const E=new Float32Array(3*(_-2));l.push(E);let[k,C,x,P]=w.subarray(0,4);E.set([NaN,NaN,NaN,NaN,k,C],0);for(let I=4;I<_;I+=2){const N=w[I],j=w[I+1];E.set(G.createBezierPoints(k,C,x,P,N,j),(I-2)*3),[k,C,x,P]=[x,P,N,j]}}}for(let w=0,_=l.length;w<_;w++)d.push({line:S(l[w].map(E=>E??NaN),f,p,y,v),points:S(c[w].map(E=>E??NaN),f,p,y,v)});const m=new this.prototype.constructor;return m.build(d,r,i,1,u,h,o),m}get box(){return a(this,yn)}updateProperty(t,s){return t==="stroke-width"?A(this,Jt,B1).call(this,s):null}updateParentDimensions([t,s],r){const[i,o]=A(this,Jt,Zr).call(this);g(this,Ur,t),g(this,$r,s),g(this,kh,r);const[l,c]=A(this,Jt,Zr).call(this),u=l-i,h=c-o,d=a(this,yn);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(t){return g(this,ag,t),{path:{transform:this.rotationTransform}}}get viewBox(){return a(this,yn).map(G.svgRound).join(" ")}get defaultProperties(){const[t,s]=a(this,yn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=a(this,yn);let r=0,i=0,o=0,l=0,c=0,u=0;switch(a(this,ag)){case 90:i=s/t,o=-t/s,c=t;break;case 180:r=-1,l=-1,c=t,u=s;break;case 270:i=-s/t,o=t/s,u=s;break;default:return""}return`matrix(${r} ${i} ${o} ${l} ${G.svgRound(c)} ${G.svgRound(u)})`}getPathResizingSVGProperties([t,s,r,i]){const[o,l]=A(this,Jt,Zr).call(this),[c,u,h,d]=a(this,yn);if(Math.abs(h-o)<=G.PRECISION||Math.abs(d-l)<=G.PRECISION){const S=t+r/2-(c+h/2),m=s+i/2-(u+d/2);return{path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:`${this.rotationTransform} translate(${S} ${m})`}}}const f=(r-2*o)/(h-2*o),p=(i-2*l)/(d-2*l),y=h/r,v=d/i;return{path:{"transform-origin":`${G.svgRound(c)} ${G.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${v}) translate(${G.svgRound(o)} ${G.svgRound(l)}) scale(${f} ${p}) translate(${G.svgRound(-o)} ${G.svgRound(-l)})`}}}getPathResizedSVGProperties([t,s,r,i]){const[o,l]=A(this,Jt,Zr).call(this),c=a(this,yn),[u,h,d,f]=c;if(c[0]=t,c[1]=s,c[2]=r,c[3]=i,Math.abs(d-o)<=G.PRECISION||Math.abs(f-l)<=G.PRECISION){const m=t+r/2-(u+d/2),w=s+i/2-(h+f/2);for(const{line:_,points:E}of a(this,os))G._translate(_,m,w,_),G._translate(E,m,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(r-2*o)/(d-2*o),y=(i-2*l)/(f-2*l),v=-p*(u+o)+t+o,S=-y*(h+l)+s+l;if(p!==1||y!==1||v!==0||S!==0)for(const{line:m,points:w}of a(this,os))G._rescale(m,v,S,p,y,m),G._rescale(w,v,S,p,y,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],r){const[i,o]=r,l=a(this,yn),c=t-l[0],u=s-l[1];if(a(this,Ur)===i&&a(this,$r)===o)for(const{line:h,points:d}of a(this,os))G._translate(h,c,u,h),G._translate(d,c,u,d);else{const h=a(this,Ur)/i,d=a(this,$r)/o;g(this,Ur,i),g(this,$r,o);for(const{line:f,points:p}of a(this,os))G._rescale(f,c,u,h,d,f),G._rescale(p,c,u,h,d,p);l[2]*=h,l[3]*=d}return l[0]=t,l[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`}}}get defaultSVGProperties(){const t=a(this,yn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${G.svgRound(t[0])} ${G.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}yn=new WeakMap,ag=new WeakMap,lg=new WeakMap,os=new WeakMap,Ur=new WeakMap,$r=new WeakMap,kh=new WeakMap,Ch=new WeakMap,ql=new WeakMap,Jt=new WeakSet,Zr=function(t=a(this,ql)){const s=a(this,lg)+t/2*a(this,kh);return a(this,Ch)%180===0?[s/a(this,Ur),s/a(this,$r)]:[s/a(this,$r),s/a(this,Ur)]},M1=function(){const[t,s,r,i]=a(this,yn),[o,l]=A(this,Jt,Zr).call(this,0);return[t+o,s+l,r-2*o,i-2*l]},F1=function(){const t=g(this,yn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of a(this,os)){if(i.length<=12){for(let c=4,u=i.length;c<u;c+=6)V.pointBoundingBox(i[c],i[c+1],t);continue}let o=i[4],l=i[5];for(let c=6,u=i.length;c<u;c+=6){const[h,d,f,p,y,v]=i.subarray(c,c+6);V.bezierBoundingBox(o,l,h,d,f,p,y,v,t),o=y,l=v}}const[s,r]=A(this,Jt,Zr).call(this);t[0]=_n(t[0]-s,0,1),t[1]=_n(t[1]-r,0,1),t[2]=_n(t[2]+s,0,1),t[3]=_n(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]},B1=function(t){const[s,r]=A(this,Jt,Zr).call(this);g(this,ql,t);const[i,o]=A(this,Jt,Zr).call(this),[l,c]=[i-s,o-r],u=a(this,yn);return u[0]-=l,u[1]-=c,u[2]+=2*l,u[3]+=2*c,u};class kv extends D1{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:ze._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new kv(this._viewParameters);return e.updateAll(this),e}}var Jy,j1;const Qc=class Qc extends Ly{constructor(t){super({...t,name:"inkEditor"});b(this,Jy);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){ze.initialize(t,s),this._defaultDrawingOptions=new kv(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ae(this,"typesMap",new Map([[ve.INK_THICKNESS,"stroke-width"],[ve.INK_COLOR,"stroke"],[ve.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,r,i,o){return new X2(t,s,r,i,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,r,i,o,l){return Eg.deserialize(t,s,r,i,o,l)}static async deserialize(t,s,r){let i=null;if(t instanceof dS){const{data:{inkLists:l,rect:c,rotation:u,id:h,color:d,opacity:f,borderStyle:{rawWidth:p},popupRef:y,richText:v,contentsObj:S,creationDate:m,modificationDate:w},parent:{page:{pageNumber:_}}}=t;i=t={annotationType:ce.INK,color:Array.from(d),thickness:p,opacity:f,paths:{points:l},boxes:null,pageIndex:_-1,rect:c.slice(0),rotation:u,annotationElementId:h,id:h,deleted:!1,popupRef:y,richText:v,comment:(S==null?void 0:S.str)||null,creationDate:m,modificationDate:w}}const o=await super.deserialize(t,s,r);return o._initialData=i,t.comment&&o.setCommentData(t),o}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Py(this)),[["colorPicker",this._colorPicker]]}get colorType(){return ve.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:r}=this;s.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:r}){this._drawingOptions=Qc.getDefaultDrawingOptions({stroke:V.makeHexColor(...t),"stroke-width":s,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:r}=this.serializeDraw(t),{_drawingOptions:{stroke:i,"stroke-opacity":o,"stroke-width":l}}=this,c=Object.assign(super.serialize(t),{color:ze._colorManager.convert(i),opacity:o,thickness:l,paths:{lines:s,points:r}});return this.addComment(c),t?(c.isCopy=!0,c):this.annotationElementId&&!A(this,Jy,j1).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:s,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:s,popup:this.comment}),null}};Jy=new WeakSet,j1=function(t){const{color:s,thickness:r,opacity:i,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==s[c])||t.thickness!==r||t.opacity!==i||t.pageIndex!==o},B(Qc,"_type","ink"),B(Qc,"_editorType",ce.INK),B(Qc,"_defaultDrawingOptions",null);let j_=Qc;class U_ extends Eg{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const tm=8,rd=3;var Kl,Ee,$_,ir,U1,$1,z_,zm,z1,H1,V1,H_,V_,W1;class ji{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:r},i,o,l,c){let u=new OffscreenCanvas(1,1),h=u.getContext("2d",{alpha:!1});const d=200,f=h.font=`${s} ${r} ${d}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:y,actualBoundingBoxAscent:v,actualBoundingBoxDescent:S,fontBoundingBoxAscent:m,fontBoundingBoxDescent:w,width:_}=h.measureText(e),E=1.5,k=Math.ceil(Math.max(Math.abs(p)+Math.abs(y)||0,_)*E),C=Math.ceil(Math.max(Math.abs(v)+Math.abs(S)||d,Math.abs(m)+Math.abs(w)||d)*E);u=new OffscreenCanvas(k,C),h=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=f,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,k,C),h.fillStyle="black",h.fillText(e,k*(E-1)/2,C*(3-E)/2);const x=A(this,Ee,H_).call(this,h.getImageData(0,0,k,C).data),P=A(this,Ee,V1).call(this,x),I=A(this,Ee,V_).call(this,P),N=A(this,Ee,z_).call(this,x,k,C,I);return this.processDrawnLines({lines:{curves:N,width:k,height:C},pageWidth:i,pageHeight:o,rotation:l,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,s,r,i){const[o,l,c]=A(this,Ee,W1).call(this,e),[u,h]=A(this,Ee,H1).call(this,o,l,c,Math.hypot(l,c)*a(this,Kl).sigmaSFactor,a(this,Kl).sigmaR,a(this,Kl).kernelSize),d=A(this,Ee,V_).call(this,h),f=A(this,Ee,z_).call(this,u,l,c,d);return this.processDrawnLines({lines:{curves:f,width:l,height:c},pageWidth:t,pageHeight:s,rotation:r,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:r,innerMargin:i,mustSmooth:o,areContours:l}){r%180!==0&&([t,s]=[s,t]);const{curves:c,width:u,height:h}=e,d=e.thickness??0,f=[],p=Math.min(t/u,s/h),y=p/t,v=p/s,S=[];for(const{points:w}of c){const _=o?A(this,Ee,z1).call(this,w):w;if(!_)continue;S.push(_);const E=_.length,k=new Float32Array(E),C=new Float32Array(3*(E===2?2:E-2));if(f.push({line:C,points:k}),E===2){k[0]=_[0]*y,k[1]=_[1]*v,C.set([NaN,NaN,NaN,NaN,k[0],k[1]],0);continue}let[x,P,I,N]=_;x*=y,P*=v,I*=y,N*=v,k.set([x,P,I,N],0),C.set([NaN,NaN,NaN,NaN,x,P],0);for(let j=4;j<E;j+=2){const ee=k[j]=_[j]*y,se=k[j+1]=_[j+1]*v;C.set(G.createBezierPoints(x,P,I,N,ee,se),(j-2)*3),[x,P,I,N]=[I,N,ee,se]}}if(f.length===0)return null;const m=l?new U_:new Eg;return m.build(f,t,s,1,r,l?0:d,i),{outline:m,newCurves:S,areContours:l,thickness:d,width:u,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:r,height:i}){let o=1/0,l=-1/0,c=0;for(const _ of e){c+=_.length;for(let E=2,k=_.length;E<k;E++){const C=_[E]-_[E-2];o=Math.min(o,C),l=Math.max(l,C)}}let u;o>=-128&&l<=127?u=Int8Array:o>=-32768&&l<=32767?u=Int16Array:u=Int32Array;const h=e.length,d=tm+rd*h,f=new Uint32Array(d);let p=0;f[p++]=d*Uint32Array.BYTES_PER_ELEMENT+(c-2*h)*u.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=r,f[p++]=i,f[p++]=t?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=h,f[p++]=u.BYTES_PER_ELEMENT;for(const _ of e)f[p++]=_.length-2,f[p++]=_[0],f[p++]=_[1];const y=new CompressionStream("deflate-raw"),v=y.writable.getWriter();await v.ready,v.write(f);const S=u.prototype.constructor;for(const _ of e){const E=new S(_.length-2);for(let k=2,C=_.length;k<C;k++)E[k-2]=_[k]-_[k-2];v.write(E)}v.close();const m=await new Response(y.readable).arrayBuffer(),w=new Uint8Array(m);return zx(w)}static async decompressSignature(e){try{const t=hM(e),{readable:s,writable:r}=new DecompressionStream("deflate-raw"),i=r.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let o=null,l=0;for await(const _ of s)o||(o=new Uint8Array(new Uint32Array(_.buffer,0,4)[0])),o.set(_,l),l+=_.length;const c=new Uint32Array(o.buffer,0,o.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const h=c[2],d=c[3],f=c[4]===0,p=c[5],y=c[6],v=c[7],S=[],m=(tm+rd*y)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(v){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(o.buffer,m);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(o.buffer,m);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(o.buffer,m);break}l=0;for(let _=0;_<y;_++){const E=c[rd*_+tm],k=new Float32Array(E+2);S.push(k);for(let C=0;C<rd-1;C++)k[C]=c[rd*_+tm+C+1];for(let C=0;C<E;C++)k[C+2]=k[C]+w[l++]}return{areContours:f,thickness:p,outlines:S,width:h,height:d}}catch(t){return oe(`decompressSignature: ${t}`),null}}}Kl=new WeakMap,Ee=new WeakSet,$_=function(e,t,s,r){return s-=e,r-=t,s===0?r>0?0:4:s===1?r+6:2-r},ir=new WeakMap,U1=function(e,t,s,r,i,o,l){const c=A(this,Ee,$_).call(this,s,r,i,o);for(let u=0;u<8;u++){const h=(-u+c-l+16)%8,d=a(this,ir)[2*h],f=a(this,ir)[2*h+1];if(e[(s+d)*t+(r+f)]!==0)return h}return-1},$1=function(e,t,s,r,i,o,l){const c=A(this,Ee,$_).call(this,s,r,i,o);for(let u=0;u<8;u++){const h=(u+c+l+16)%8,d=a(this,ir)[2*h],f=a(this,ir)[2*h+1];if(e[(s+d)*t+(r+f)]!==0)return h}return-1},z_=function(e,t,s,r){const i=e.length,o=new Int32Array(i);for(let h=0;h<i;h++)o[h]=e[h]<=r?1:0;for(let h=1;h<s-1;h++)o[h*t]=o[h*t+t-1]=0;for(let h=0;h<t;h++)o[h]=o[t*s-1-h]=0;let l=1,c;const u=[];for(let h=1;h<s-1;h++){c=1;for(let d=1;d<t-1;d++){const f=h*t+d,p=o[f];if(p===0)continue;let y=h,v=d;if(p===1&&o[f-1]===0)l+=1,v-=1;else if(p>=1&&o[f+1]===0)l+=1,v+=1,p>1&&(c=p);else{p!==1&&(c=Math.abs(p));continue}const S=[d,h],m=v===d+1,w={isHole:m,points:S,id:l,parent:0};u.push(w);let _;for(const j of u)if(j.id===c){_=j;break}_?_.isHole?w.parent=m?_.parent:c:w.parent=m?c:_.parent:w.parent=m?c:0;const E=A(this,Ee,U1).call(this,o,t,h,d,y,v,0);if(E===-1){o[f]=-l,o[f]!==1&&(c=Math.abs(o[f]));continue}let k=a(this,ir)[2*E],C=a(this,ir)[2*E+1];const x=h+k,P=d+C;y=x,v=P;let I=h,N=d;for(;;){const j=A(this,Ee,$1).call(this,o,t,I,N,y,v,1);k=a(this,ir)[2*j],C=a(this,ir)[2*j+1];const ee=I+k,se=N+C;S.push(se,ee);const Q=I*t+N;if(o[Q+1]===0?o[Q]=-l:o[Q]===1&&(o[Q]=l),ee===h&&se===d&&I===x&&N===P){o[f]!==1&&(c=Math.abs(o[f]));break}else y=I,v=N,I=ee,N=se}}}return u},zm=function(e,t,s,r){if(s-t<=4){for(let x=t;x<s-2;x+=2)r.push(e[x],e[x+1]);return}const i=e[t],o=e[t+1],l=e[s-4]-i,c=e[s-3]-o,u=Math.hypot(l,c),h=l/u,d=c/u,f=h*o-d*i,p=c/l,y=1/u,v=Math.atan(p),S=Math.cos(v),m=Math.sin(v),w=y*(Math.abs(S)+Math.abs(m)),_=y*(1-w+w**2),E=Math.max(Math.atan(Math.abs(m+S)*_),Math.atan(Math.abs(m-S)*_));let k=0,C=t;for(let x=t+2;x<s-2;x+=2){const P=Math.abs(f-h*e[x+1]+d*e[x]);P>k&&(C=x,k=P)}k>(u*E)**2?(A(this,Ee,zm).call(this,e,t,C+2,r),A(this,Ee,zm).call(this,e,C,s,r)):r.push(i,o)},z1=function(e){const t=[],s=e.length;return A(this,Ee,zm).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},H1=function(e,t,s,r,i,o){const l=new Float32Array(o**2),c=-2*r**2,u=o>>1;for(let v=0;v<o;v++){const S=(v-u)**2;for(let m=0;m<o;m++)l[v*o+m]=Math.exp((S+(m-u)**2)/c)}const h=new Float32Array(256),d=-2*i**2;for(let v=0;v<256;v++)h[v]=Math.exp(v**2/d);const f=e.length,p=new Uint8Array(f),y=new Uint32Array(256);for(let v=0;v<s;v++)for(let S=0;S<t;S++){const m=v*t+S,w=e[m];let _=0,E=0;for(let C=0;C<o;C++){const x=v+C-u;if(!(x<0||x>=s))for(let P=0;P<o;P++){const I=S+P-u;if(I<0||I>=t)continue;const N=e[x*t+I],j=l[C*o+P]*h[Math.abs(N-w)];_+=N*j,E+=j}}const k=p[m]=Math.round(_/E);y[k]++}return[p,y]},V1=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},H_=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let r=-1/0,i=1/0;for(let l=0,c=s.length;l<c;l++){const u=s[l]=e[l<<2];r=Math.max(r,u),i=Math.min(i,u)}const o=255/(r-i);for(let l=0,c=s.length;l<c;l++)s[l]=(s[l]-i)*o;return s},V_=function(e){let t,s=-1/0,r=-1/0;const i=e.findIndex(c=>c!==0);let o=i,l=i;for(t=i;t<256;t++){const c=e[t];c>s&&(t-o>r&&(r=t-o,l=t-1),s=c,o=t)}for(t=l-1;t>=0&&!(e[t]>e[t+1]);t--);return t},W1=function(e){const t=e,{width:s,height:r}=e,{maxDim:i}=a(this,Kl);let o=s,l=r;if(s>i||r>i){let f=s,p=r,y=Math.log2(Math.max(s,r)/i);const v=Math.floor(y);y=y===v?v-1:v;for(let m=0;m<y;m++){o=Math.ceil(f/2),l=Math.ceil(p/2);const w=new OffscreenCanvas(o,l);w.getContext("2d").drawImage(e,0,0,f,p,0,0,o,l),f=o,p=l,e!==t&&e.close(),e=w.transferToImageBitmap()}const S=Math.min(i/o,i/l);o=Math.round(o*S),l=Math.round(l*S)}const u=new OffscreenCanvas(o,l).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,o,l),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,o,l);const h=u.getImageData(0,0,o,l).data;return[A(this,Ee,H_).call(this,h),o,l]},b(ji,Ee),b(ji,Kl,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),b(ji,ir,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class fS extends D1{constructor(){super(),super.updateProperties({fill:ze._defaultLineColor,"stroke-width":0})}clone(){const e=new fS;return e.updateAll(this),e}}class pS extends kv{constructor(e){super(e),super.updateProperties({stroke:ze._defaultLineColor,"stroke-width":1})}clone(){const e=new pS(this._viewParameters);return e.updateAll(this),e}}var Wo,zr,Go,Xl;const zn=class zn extends Ly{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});b(this,Wo,!1);b(this,zr,null);b(this,Go,null);b(this,Xl,null);this._willKeepAspectRatio=!0,g(this,Go,t.signatureData||null),g(this,zr,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){ze.initialize(t,s),this._defaultDrawingOptions=new fS,this._defaultDrawnSignatureOptions=new pS(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return ae(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!a(this,zr)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(a(this,Go)){const{lines:i,mustSmooth:o,areContours:l,description:c,uuid:u,heightInPage:h}=a(this,Go),{rawDims:{pageWidth:d,pageHeight:f},rotation:p}=this.parent.viewport,y=ji.processDrawnLines({lines:i,pageWidth:d,pageHeight:f,rotation:p,innerMargin:zn._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(y,h,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:a(this,zr)||""}));return r&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){g(this,Xl,t),this.addEditToolbar()}getUuid(){return a(this,Xl)}get description(){return a(this,zr)}set description(t){g(this,zr,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:r,width:i,height:o}=a(this,Go),l=Math.max(i,o),c=ji.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:r,width:i,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,r,i){const{x:o,y:l}=this,{outline:c}=g(this,Go,t);g(this,Wo,c instanceof U_),this.description=r;let u;a(this,Wo)?u=zn.getDefaultDrawingOptions():(u=zn._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[,h]=this.pageDimensions;let d=s/h;d=d>=1?.5:d,this.width*=d/this.height,this.width>=1&&(d*=.9/this.width,this.width=.9),this.height=d,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:r},rotation:i}=this.parent.viewport;return ji.process(t,s,r,i,zn._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:r,pageHeight:i},rotation:o}=this.parent.viewport;return ji.extractContoursFromText(t,s,r,i,o,zn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:r},rotation:i}=this.parent.viewport;return ji.processDrawnLines({lines:t,pageWidth:s,pageHeight:r,rotation:i,innerMargin:zn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=zn.getDefaultDrawingOptions():(this._drawingOptions=zn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":i}}=this,o=Object.assign(super.serialize(t),{isSignature:!0,areContours:a(this,Wo),color:[0,0,0],thickness:a(this,Wo)?0:i});return this.addComment(o),t?(o.paths={lines:s,points:r},o.uuid=a(this,Xl),o.isCopy=!0):o.lines=s,a(this,zr)&&(o.accessibilityData={type:"Figure",alt:a(this,zr)}),o}static deserializeDraw(t,s,r,i,o,l){return l.areContours?U_.deserialize(t,s,r,i,o,l):Eg.deserialize(t,s,r,i,o,l)}static async deserialize(t,s,r){var o;const i=await super.deserialize(t,s,r);return g(i,Wo,t.areContours),i.description=((o=t.accessibilityData)==null?void 0:o.alt)||"",g(i,Xl,t.uuid),i}};Wo=new WeakMap,zr=new WeakMap,Go=new WeakMap,Xl=new WeakMap,B(zn,"_type","signature"),B(zn,"_editorType",ce.SIGNATURE),B(zn,"_defaultDrawingOptions",null);let W_=zn;var Ke,Ft,qo,Di,Ko,xh,Ni,Yl,Hr,as,Th,Se,Rd,Od,Hm,Vm,Wm,q_,Gm,G1;class G_ extends ze{constructor(t){super({...t,name:"stampEditor"});b(this,Se);b(this,Ke,null);b(this,Ft,null);b(this,qo,null);b(this,Di,null);b(this,Ko,null);b(this,xh,"");b(this,Ni,null);b(this,Yl,!1);b(this,Hr,null);b(this,as,!1);b(this,Th,!1);g(this,Di,t.bitmapUrl),g(this,Ko,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){ze.initialize(t,s)}static isHandlingMimeForPasting(t){return O0.includes(t)}static paste(t,s){s.pasteEditor({mode:ce.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await r.guess({name:"altText",request:{data:i,width:o,height:l,channels:i.length/(o*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;a(this,Ft)&&(g(this,Ke,null),this._uiManager.imageManager.deleteId(a(this,Ft)),(t=a(this,Ni))==null||t.remove(),g(this,Ni,null),a(this,Hr)&&(clearTimeout(a(this,Hr)),g(this,Hr,null))),super.remove()}rebuild(){if(!this.parent){a(this,Ft)&&A(this,Se,Hm).call(this);return}super.rebuild(),this.div!==null&&(a(this,Ft)&&a(this,Ni)===null&&A(this,Se,Hm).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(a(this,qo)||a(this,Ke)||a(this,Di)||a(this,Ko)||a(this,Ft)||a(this,Yl))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),a(this,Yl)||(a(this,Ke)?A(this,Se,Vm).call(this):A(this,Se,Hm).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:r,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(g(this,Ft,r),i&&g(this,Ke,i),g(this,Yl,!1),A(this,Se,Vm).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;a(this,Hr)!==null&&clearTimeout(a(this,Hr)),g(this,Hr,setTimeout(()=>{g(this,Hr,null),A(this,Se,q_).call(this)},200))}copyCanvas(t,s,r=!1){t||(t=224);const{width:i,height:o}=a(this,Ke),l=new Xr;let c=a(this,Ke),u=i,h=o,d=null;if(s){if(i>s||o>s){const x=Math.min(s/i,s/o);u=Math.floor(i*x),h=Math.floor(o*x)}d=document.createElement("canvas");const p=d.width=Math.ceil(u*l.sx),y=d.height=Math.ceil(h*l.sy);a(this,as)||(c=A(this,Se,Wm).call(this,p,y));const v=d.getContext("2d");v.filter=this._uiManager.hcmFilter;let S="white",m="#cfcfd8";this._uiManager.hcmFilter!=="none"?m="black":yM.isDarkMode&&(S="#8f8f9d",m="#42414d");const w=15,_=w*l.sx,E=w*l.sy,k=new OffscreenCanvas(_*2,E*2),C=k.getContext("2d");C.fillStyle=S,C.fillRect(0,0,_*2,E*2),C.fillStyle=m,C.fillRect(0,0,_,E),C.fillRect(_,E,_,E),v.fillStyle=v.createPattern(k,"repeat"),v.fillRect(0,0,p,y),v.drawImage(c,0,0,c.width,c.height,0,0,p,y)}let f=null;if(r){let p,y;if(l.symmetric&&c.width<t&&c.height<t)p=c.width,y=c.height;else if(c=a(this,Ke),i>t||o>t){const m=Math.min(t/i,t/o);p=Math.floor(i*m),y=Math.floor(o*m),a(this,as)||(c=A(this,Se,Wm).call(this,p,y))}const S=new OffscreenCanvas(p,y).getContext("2d",{willReadFrequently:!0});S.drawImage(c,0,0,c.width,c.height,0,0,p,y),f={width:p,height:y,data:S.getImageData(0,0,p,y).data}}return{canvas:d,width:u,height:h,imageData:f}}static async deserialize(t,s,r){var S;let i=null,o=!1;if(t instanceof l1){const{data:{rect:m,rotation:w,id:_,structParent:E,popupRef:k,richText:C,contentsObj:x,creationDate:P,modificationDate:I},container:N,parent:{page:{pageNumber:j}},canvas:ee}=t;let se,Q;ee?(delete t.canvas,{id:se,bitmap:Q}=r.imageManager.getFromCanvas(N.id,ee),ee.remove()):(o=!0,t._hasNoCanvas=!0);const re=((S=await s._structTree.getAriaAttributes(`${qc}${_}`))==null?void 0:S.get("aria-label"))||"";i=t={annotationType:ce.STAMP,bitmapId:se,bitmap:Q,pageIndex:j-1,rect:m.slice(0),rotation:w,annotationElementId:_,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:re},isSvg:!1,structParent:E,popupRef:k,richText:C,comment:(x==null?void 0:x.str)||null,creationDate:P,modificationDate:I}}const l=await super.deserialize(t,s,r),{rect:c,bitmap:u,bitmapUrl:h,bitmapId:d,isSvg:f,accessibilityData:p}=t;o?(r.addMissingCanvas(t.id,l),g(l,Yl,!0)):d&&r.imageManager.isValidId(d)?(g(l,Ft,d),u&&g(l,Ke,u)):g(l,Di,h),g(l,as,f);const[y,v]=l.pageDimensions;return l.width=(c[2]-c[0])/y,l.height=(c[3]-c[1])/v,p&&(l.altTextData=p),l._initialData=i,t.comment&&l.setCommentData(t),g(l,Th,!!i),l}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Object.assign(super.serialize(t),{bitmapId:a(this,Ft),isSvg:a(this,as)});if(this.addComment(r),t)return r.bitmapUrl=A(this,Se,Gm).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:i,altText:o}=this.serializeAltText(!1);if(!i&&o&&(r.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=A(this,Se,G1).call(this,r);return c.isSame?null:(c.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1,r.id=this.annotationElementId,delete r.bitmapId,r)}if(s===null)return r;s.stamps||(s.stamps=new Map);const l=a(this,as)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!s.stamps.has(a(this,Ft)))s.stamps.set(a(this,Ft),{area:l,serialized:r}),r.bitmap=A(this,Se,Gm).call(this,!1);else if(a(this,as)){const c=s.stamps.get(a(this,Ft));l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=A(this,Se,Gm).call(this,!1))}return r}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Ke=new WeakMap,Ft=new WeakMap,qo=new WeakMap,Di=new WeakMap,Ko=new WeakMap,xh=new WeakMap,Ni=new WeakMap,Yl=new WeakMap,Hr=new WeakMap,as=new WeakMap,Th=new WeakMap,Se=new WeakSet,Rd=function(t,s=!1){if(!t){this.remove();return}g(this,Ke,t.bitmap),s||(g(this,Ft,t.id),g(this,as,t.isSvg)),t.file&&g(this,xh,t.file.name),A(this,Se,Vm).call(this)},Od=function(){if(g(this,qo,null),this._uiManager.enableWaiting(!1),!!a(this,Ni)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&a(this,Ke)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&a(this,Ke)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Hm=function(){if(a(this,Ft)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(a(this,Ft)).then(r=>A(this,Se,Rd).call(this,r,!0)).finally(()=>A(this,Se,Od).call(this));return}if(a(this,Di)){const r=a(this,Di);g(this,Di,null),this._uiManager.enableWaiting(!0),g(this,qo,this._uiManager.imageManager.getFromUrl(r).then(i=>A(this,Se,Rd).call(this,i)).finally(()=>A(this,Se,Od).call(this)));return}if(a(this,Ko)){const r=a(this,Ko);g(this,Ko,null),this._uiManager.enableWaiting(!0),g(this,qo,this._uiManager.imageManager.getFromFile(r).then(i=>A(this,Se,Rd).call(this,i)).finally(()=>A(this,Se,Od).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=O0.join(",");const s=this._uiManager._signal;g(this,qo,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,Se,Rd).call(this,i)}r()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:s})}).finally(()=>A(this,Se,Od).call(this))),t.click()},Vm=function(){var u;const{div:t}=this;let{width:s,height:r}=a(this,Ke);const[i,o]=this.pageDimensions,l=.75;if(this.width)s=this.width*i,r=this.height*o;else if(s>l*i||r>l*o){const h=Math.min(l*i/s,l*o/r);s*=h,r*=h}this._uiManager.enableWaiting(!1);const c=g(this,Ni,document.createElement("canvas"));c.setAttribute("role","img"),this.addContainer(c),this.width=s/i,this.height=r/o,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),A(this,Se,q_).call(this),a(this,Th)||(this.parent.addUndoableEditor(this),g(this,Th,!0)),this._reportTelemetry({action:"inserted_image"}),a(this,xh)&&this.div.setAttribute("aria-description",a(this,xh)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Wm=function(t,s){const{width:r,height:i}=a(this,Ke);let o=r,l=i,c=a(this,Ke);for(;o>2*t||l>2*s;){const u=o,h=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*s&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const d=new OffscreenCanvas(o,l);d.getContext("2d").drawImage(c,0,0,u,h,0,0,o,l),c=d.transferToImageBitmap()}return c},q_=function(){const[t,s]=this.parentDimensions,{width:r,height:i}=this,o=new Xr,l=Math.ceil(r*t*o.sx),c=Math.ceil(i*s*o.sy),u=a(this,Ni);if(!u||u.width===l&&u.height===c)return;u.width=l,u.height=c;const h=a(this,as)?a(this,Ke):A(this,Se,Wm).call(this,l,c),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,l,c)},Gm=function(t){if(t){if(a(this,as)){const i=this._uiManager.imageManager.getSvgUrl(a(this,Ft));if(i)return i}const s=document.createElement("canvas");return{width:s.width,height:s.height}=a(this,Ke),s.getContext("2d").drawImage(a(this,Ke),0,0),s.toDataURL()}if(a(this,as)){const[s,r]=this.pageDimensions,i=Math.round(this.width*s*pa.PDF_TO_CSS_UNITS),o=Math.round(this.height*r*pa.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(i,o);return l.getContext("2d").drawImage(a(this,Ke),0,0,a(this,Ke).width,a(this,Ke).height,0,0,i,o),l.transferToImageBitmap()}return structuredClone(a(this,Ke))},G1=function(t){var l;const{pageIndex:s,accessibilityData:{altText:r}}=this._initialData,i=t.pageIndex===s,o=(((l=t.accessibilityData)==null?void 0:l.alt)||"")===r;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&o,isSameAltText:o}},B(G_,"_type","stamp"),B(G_,"_editorType",ce.STAMP);var Jl,Ph,Xo,Yo,Mi,Dn,Jo,Rh,Oh,or,Fi,Bt,Bi,Qo,Ih,X,Zo,Me,X_,q1,_r,Y_,J_,qm;const qs=class qs{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:r,accessibilityManager:i,annotationLayer:o,drawLayer:l,textLayer:c,viewport:u,l10n:h}){b(this,Me);b(this,Jl);b(this,Ph,!1);b(this,Xo,null);b(this,Yo,null);b(this,Mi,null);b(this,Dn,new Map);b(this,Jo,!1);b(this,Rh,!1);b(this,Oh,!1);b(this,or,null);b(this,Fi,null);b(this,Bt,null);b(this,Bi,null);b(this,Qo,null);b(this,Ih,-1);b(this,X);const d=[...a(qs,Zo).values()];if(!qs._initialized){qs._initialized=!0;for(const f of d)f.initialize(h,e)}e.registerEditorTypes(d),g(this,X,e),this.pageIndex=t,this.div=s,g(this,Jl,i),g(this,Xo,o),this.viewport=u,g(this,Bt,c),this.drawLayer=l,this._structTree=r,a(this,X).addLayer(this)}get isEmpty(){return a(this,Dn).size===0}get isInvisible(){return this.isEmpty&&a(this,X).getMode()===ce.NONE}updateToolbar(e){a(this,X).updateToolbar(e)}updateMode(e=a(this,X).getMode()){switch(A(this,Me,qm).call(this),e){case ce.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ce.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ce.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===ce.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of a(qs,Zo).values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=a(this,Bt))==null?void 0:t.div)}setEditingState(e){a(this,X).setEditingState(e)}addCommands(e){a(this,X).addCommands(e)}cleanUndoStack(e){a(this,X).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=a(this,Xo))==null||t.togglePointerEvents(e)}async enable(){var s;g(this,Oh,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(s=a(this,Qo))==null||s.abort(),g(this,Qo,null);const e=new Set;for(const r of a(this,Me,X_))r.enableEditing(),r.show(!0),r.annotationElementId&&(a(this,X).removeChangedExistingAnnotation(r),e.add(r.annotationElementId));const t=a(this,Xo);if(t)for(const r of t.getEditableAnnotations()){if(r.hide(),a(this,X).isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const i=await this.deserialize(r);i&&(this.addOrRebuild(i),i.enableEditing())}g(this,Oh,!1),a(this,X)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var r;if(g(this,Rh,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),a(this,Bt)&&!a(this,Qo)){g(this,Qo,new AbortController);const i=a(this,X).combinedSignal(a(this,Qo));a(this,Bt).div.addEventListener("pointerdown",o=>{const{clientX:c,clientY:u,timeStamp:h}=o,d=a(this,Ih);if(h-d>500){g(this,Ih,h);return}g(this,Ih,-1);const{classList:f}=this.div;f.toggle("getElements",!0);const p=document.elementsFromPoint(c,u);if(f.toggle("getElements",!1),!this.div.contains(p[0]))return;let y;const v=new RegExp(`^${gf}[0-9]+$`);for(const m of p)if(v.test(m.id)){y=m.id;break}if(!y)return;const S=a(this,Dn).get(y);(S==null?void 0:S.annotationElementId)===null&&(o.stopPropagation(),o.preventDefault(),S.dblclick(o))},{signal:i,capture:!0})}const e=a(this,Xo),t=[];if(e){const i=new Map,o=new Map;for(const c of a(this,Me,X_)){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){i.set(c.annotationElementId,c);continue}else o.set(c.annotationElementId,c);(r=this.getEditableAnnotation(c.annotationElementId))==null||r.show(),c.remove()}const l=e.getEditableAnnotations();for(const c of l){const{id:u}=c.data;if(a(this,X).isDeletedAnnotationElement(u)){c.updateEdited({deleted:!0});continue}let h=o.get(u);if(h){h.resetAnnotationElement(c),h.show(!1),c.show();continue}h=i.get(u),h&&(a(this,X).addChangedExistingAnnotation(h),h.renderAnnotationElement(c)&&h.show(!1)),c.show()}}A(this,Me,qm).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const i of a(qs,Zo).values())s.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),g(this,Rh,!1)}getEditableAnnotation(e){var t;return((t=a(this,Xo))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){a(this,X).getActive()!==e&&a(this,X).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=a(this,Bt))!=null&&e.div&&!a(this,Bi)){g(this,Bi,new AbortController);const t=a(this,X).combinedSignal(a(this,Bi));a(this,Bt).div.addEventListener("pointerdown",A(this,Me,q1).bind(this),{signal:t}),a(this,Bt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=a(this,Bt))!=null&&e.div&&a(this,Bi)&&(a(this,Bi).abort(),g(this,Bi,null),a(this,Bt).div.classList.remove("highlighting"))}enableClick(){if(a(this,Yo))return;g(this,Yo,new AbortController);const e=a(this,X).combinedSignal(a(this,Yo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=a(this,Yo))==null||e.abort(),g(this,Yo,null)}attach(e){a(this,Dn).set(e.id,e);const{annotationElementId:t}=e;t&&a(this,X).isDeletedAnnotationElement(t)&&a(this,X).removeDeletedAnnotationElement(e)}detach(e){var t;a(this,Dn).delete(e.id),(t=a(this,Jl))==null||t.removePointerInTextLayer(e.contentDiv),!a(this,Rh)&&e.annotationElementId&&a(this,X).addDeletedAnnotationElement(e)}remove(e){this.detach(e),a(this,X).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(a(this,X).addDeletedAnnotationElement(e),ze.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),a(this,X).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!a(this,Oh)),a(this,X).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!a(this,Mi)&&(e._focusEventsAllowed=!1,g(this,Mi,setTimeout(()=>{g(this,Mi,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:a(this,X)._signal}),t.focus())},0))),e._structTreeParentId=(s=a(this,Jl))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of a(this,Dn).values())if(t.uid===e)return t;return null}getNextId(){return a(this,X).getId()}combinedSignal(e){return a(this,X).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=a(this,Me,_r))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await a(this,X).updateMode(e.mode);const{offsetX:s,offsetY:r}=A(this,Me,J_).call(this),i=this.getNextId(),o=A(this,Me,Y_).call(this,{parent:this,id:i,x:s,y:r,uiManager:a(this,X),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=a(qs,Zo).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,a(this,X)))||null}createAndAddNewEditor(e,t,s={}){const r=this.getNextId(),i=A(this,Me,Y_).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:a(this,X),isCentered:t,...s});return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(A(this,Me,J_).call(this),!0,e)}setSelected(e){a(this,X).setSelected(e)}toggleSelected(e){a(this,X).toggleSelected(e)}unselect(e){a(this,X).unselect(e)}pointerup(e){var r;const{isMac:t}=Rt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!a(this,Jo)||(g(this,Jo,!1),(r=a(this,Me,_r))!=null&&r.isDrawer&&a(this,Me,_r).supportMultipleDrawings))return;if(!a(this,Ph)){g(this,Ph,!0);return}const s=a(this,X).getMode();if(s===ce.STAMP||s===ce.SIGNATURE){a(this,X).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var r;if(a(this,X).getMode()===ce.HIGHLIGHT&&this.enableTextSelection(),a(this,Jo)){g(this,Jo,!1);return}const{isMac:t}=Rt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(g(this,Jo,!0),(r=a(this,Me,_r))!=null&&r.isDrawer){this.startDrawingSession(e);return}const s=a(this,X).getActive();g(this,Ph,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),a(this,or)){a(this,Me,_r).startDrawing(this,a(this,X),!1,e);return}a(this,X).setCurrentDrawingSession(this),g(this,or,new AbortController);const t=a(this,X).combinedSignal(a(this,or));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(g(this,Fi,null),this.commitOrRemove())},{signal:t}),a(this,Me,_r).startDrawing(this,a(this,X),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&g(this,Fi,t);return}a(this,Fi)&&setTimeout(()=>{var t;(t=a(this,Fi))==null||t.focus(),g(this,Fi,null)},0)}endDrawingSession(e=!1){return a(this,or)?(a(this,X).setCurrentDrawingSession(null),a(this,or).abort(),g(this,or,null),g(this,Fi,null),a(this,Me,_r).endDrawing(e)):null}findNewParent(e,t,s){const r=a(this,X).findParent(t,s);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return a(this,or)?(this.endDrawingSession(),!0):!1}onScaleChanging(){a(this,or)&&a(this,Me,_r).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=a(this,X).getActive())==null?void 0:e.parent)===this&&(a(this,X).commitOrRemove(),a(this,X).setActiveEditor(null)),a(this,Mi)&&(clearTimeout(a(this,Mi)),g(this,Mi,null));for(const s of a(this,Dn).values())(t=a(this,Jl))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,a(this,Dn).clear(),a(this,X).removeLayer(this)}render({viewport:e}){this.viewport=e,ac(this.div,e);for(const t of a(this,X).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){a(this,X).commitOrRemove(),A(this,Me,qm).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,ac(this.div,{rotation:s}),t!==s)for(const r of a(this,Dn).values())r.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return a(this,X).viewParameters.realScale}};Jl=new WeakMap,Ph=new WeakMap,Xo=new WeakMap,Yo=new WeakMap,Mi=new WeakMap,Dn=new WeakMap,Jo=new WeakMap,Rh=new WeakMap,Oh=new WeakMap,or=new WeakMap,Fi=new WeakMap,Bt=new WeakMap,Bi=new WeakMap,Qo=new WeakMap,Ih=new WeakMap,X=new WeakMap,Zo=new WeakMap,Me=new WeakSet,X_=function(){return a(this,Dn).size!==0?a(this,Dn).values():a(this,X).getEditors(this.pageIndex)},q1=function(e){a(this,X).unselectAll();const{target:t}=e;if(t===a(this,Bt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&a(this,Bt).div.contains(t)){const{isMac:s}=Rt.platform;if(e.button!==0||e.ctrlKey&&s)return;a(this,X).showAllEditors("highlight",!0,!0),a(this,Bt).div.classList.add("free"),this.toggleDrawing(),Iy.startHighlighting(this,a(this,X).direction==="ltr",{target:a(this,Bt).div,x:e.x,y:e.y}),a(this,Bt).div.addEventListener("pointerup",()=>{a(this,Bt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:a(this,X)._signal}),e.preventDefault()}},_r=function(){return a(qs,Zo).get(a(this,X).getMode())},Y_=function(e){const t=a(this,Me,_r);return t?new t.prototype.constructor(e):null},J_=function(){const{x:e,y:t,width:s,height:r}=this.boundingClientRect,i=Math.max(0,e),o=Math.max(0,t),l=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+r),u=(i+l)/2-e,h=(o+c)/2-t,[d,f]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:f}},qm=function(){for(const e of a(this,Dn).values())e.isEmpty()&&e.remove()},B(qs,"_initialized",!1),b(qs,Zo,new Map([P_,j_,G_,Iy,W_].map(e=>[e._editorType,e])));let K_=qs;var ar,vn,Ql,cg,Qy,K1,Yr,Z_,X1,eb;const Et=class Et{constructor({pageIndex:e}){b(this,Yr);b(this,ar,null);b(this,vn,new Map);b(this,Ql,new Map);this.pageIndex=e}setParent(e){if(!a(this,ar)){g(this,ar,e);return}if(a(this,ar)!==e){if(a(this,vn).size>0)for(const t of a(this,vn).values())t.remove(),e.append(t);g(this,ar,e)}}static get _svgFactory(){return ae(this,"_svgFactory",new Ry)}draw(e,t=!1,s=!1){const r=bt(Et,cg)._++,i=A(this,Yr,Z_).call(this),o=Et._svgFactory.createElement("defs");i.append(o);const l=Et._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${r}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),t&&a(this,Ql).set(r,l);const u=s?A(this,Yr,X1).call(this,o,c):null,h=Et._svgFactory.createElement("use");return i.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(i,e),a(this,vn).set(r,i),{id:r,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=bt(Et,cg)._++,r=A(this,Yr,Z_).call(this),i=Et._svgFactory.createElement("defs");r.append(i);const o=Et._svgFactory.createElement("path");i.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const d=Et._svgFactory.createElement("mask");i.append(d),c=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=Et._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=Et._svgFactory.createElement("use");d.append(p),p.setAttribute("href",`#${l}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=Et._svgFactory.createElement("use");r.append(u),u.setAttribute("href",`#${l}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return r.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(r,e),a(this,vn).set(s,r),s}finalizeDraw(e,t){a(this,Ql).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:r,rootClass:i,path:o}=t,l=typeof e=="number"?a(this,vn).get(e):e;if(l){if(s&&A(this,Yr,eb).call(this,l,s),r&&A(c=Et,Qy,K1).call(c,l,r),i){const{classList:u}=l;for(const[h,d]of Object.entries(i))u.toggle(h,d)}if(o){const h=l.firstElementChild.firstElementChild;A(this,Yr,eb).call(this,h,o)}}}updateParent(e,t){if(t===this)return;const s=a(this,vn).get(e);s&&(a(t,ar).append(s),a(this,vn).delete(e),a(t,vn).set(e,s))}remove(e){a(this,Ql).delete(e),a(this,ar)!==null&&(a(this,vn).get(e).remove(),a(this,vn).delete(e))}destroy(){g(this,ar,null);for(const e of a(this,vn).values())e.remove();a(this,vn).clear(),a(this,Ql).clear()}};ar=new WeakMap,vn=new WeakMap,Ql=new WeakMap,cg=new WeakMap,Qy=new WeakSet,K1=function(e,[t,s,r,i]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*r}%`,o.height=`${100*i}%`},Yr=new WeakSet,Z_=function(){const e=Et._svgFactory.create(1,1,!0);return a(this,ar).append(e),e.setAttribute("aria-hidden",!0),e},X1=function(e,t){const s=Et._svgFactory.createElement("clipPath");e.append(s);const r=`clip_${t}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const i=Et._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),r},eb=function(e,t){for(const[s,r]of Object.entries(t))r===null?e.removeAttribute(s):e.setAttribute(s,r)},b(Et,Qy),b(Et,cg,0);let Q_=Et;globalThis._pdfjsTestingUtils={HighlightOutliner:O_};globalThis.pdfjsLib={AbortException:fa,AnnotationEditorLayer:K_,AnnotationEditorParamsType:ve,AnnotationEditorType:ce,AnnotationEditorUIManager:lc,AnnotationLayer:x_,AnnotationMode:lo,AnnotationType:gt,applyOpacity:wM,build:C2,ColorPicker:Ty,createValidAbsoluteUrl:Bx,CSSConstants:vM,DOMSVGFactory:Ry,DrawLayer:Q_,FeatureTest:Rt,fetchData:wg,findContrastColor:_M,getDocument:GT,getFilenameFromUrl:dM,getPdfFilenameFromUrl:fM,getRGB:bg,getUuid:$x,getXfaPageViewport:gM,GlobalWorkerOptions:Gr,ImageKind:pm,InvalidPDFException:P0,isDataScheme:Av,isPdfFile:aS,isValidExplicitDest:OM,MathClamp:_n,noContextMenu:zs,normalizeUnicode:cM,OPS:mf,OutputScale:Xr,PasswordResponses:eM,PDFDataRangeTransport:qT,PDFDateString:Sy,PDFWorker:wf,PermissionFlag:ZN,PixelsPerInch:pa,RenderingCancelledException:oS,renderRichText:Vx,ResponseException:by,setLayerDimensions:ac,shadow:ae,SignatureExtractor:ji,stopEvent:ut,SupportedImageMimeTypes:O0,TextLayer:vf,TouchManager:Ey,updateUrlHash:jx,Util:V,VerbosityLevel:_v,version:YT,XfaLayer:Hx};typeof window<"u"&&(Gr.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${YT}/pdf.worker.min.js`);async function tb(n,e){try{const{data:t}=await QN.recognize(n,"eng",{logger:s=>{e&&s.status==="recognizing text"&&e(s.progress)}});return{success:!0,text:t.text}}catch(t){return console.error("OCR Error:",t),{success:!1,text:"",error:t.message||"OCR failed"}}}async function Y2(n,e){try{const t=await n.arrayBuffer(),s=await GT({data:t}).promise;let r="";const i=s.numPages;for(let o=1;o<=i;o++){const u=(await(await s.getPage(o)).getTextContent()).items.map(h=>h.str).join(" ");r+=u+`
`,e&&e(o/i)}return r.trim().length<10?(console.log("PDF has no extractable text, falling back to OCR"),await tb(n,e)):{success:!0,text:r}}catch(t){return console.error("PDF extraction error:",t),await tb(n,e)}}async function J2(n,e){return n.type==="application/pdf"?await Y2(n,e):n.type.startsWith("image/")?await tb(n,e):{success:!1,text:"",error:"Unsupported file type"}}function Q2(n,e){const t={rawText:n};switch(e){case"driversLicense":return Z2(n);case"taxReturn":return eF(n);case"payStub":return tF(n);case"bankStatement":return nF(n);case"w2":case"1099":return sF(n);default:return t}}function Z2(n){const e={},t=n.match(/(?:DL|DRIVER\s+LICENSE|NAME)[\s:]*([A-Z][A-Z\s,]+)/i);if(t){const o=t[1].trim().split(/\s+/);e.firstName=o[0],e.lastName=o.slice(1).join(" "),e.name=t[1].trim()}const s=n.match(/(?:DOB|DATE\s+OF\s+BIRTH|BIRTH)[\s:]*(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4})/i);s&&(e.dateOfBirth=s[1]);const r=n.match(/(?:ADDRESS|ADDR)[\s:]*([0-9]+\s+[A-Z0-9\s,#\-]+(?:ST|STREET|AVE|AVENUE|RD|ROAD|DR|DRIVE|LN|LANE|BLVD|BOULEVARD)[A-Z0-9\s,#\-]*)/);r&&(e.address={street:r[1].trim()});const i=n.match(/(?:DLN|LICENSE\s+NO|LIC\s+#)[\s:]*([A-Z0-9]{8,12})/i);return i&&(e.driverLicenseNumber=i[1]),e}function eF(n){const e={},t=n.match(/(?:ADJUSTED\s+GROSS\s+INCOME|AGI)[\s:$]*\$?([\d,]+\.?\d*)/i);t&&(e.annualIncome=parseFloat(t[1].replace(/,/g,"")));const s=n.match(/(?:TOTAL\s+INCOME|INCOME)[\s:$]*\$?([\d,]+\.?\d*)/i);return s&&(e.totalIncome=parseFloat(s[1].replace(/,/g,""))),e}function tF(n){const e={},t=n.match(/(?:GROSS\s+PAY|GROSS)[\s:$]*\$?([\d,]+\.?\d*)/i);if(t){const s=parseFloat(t[1].replace(/,/g,""));e.monthlyIncome=s,e.annualIncome=s*12}return e}function nF(n){const e={},t=n.match(/(?:BALANCE|CURRENT\s+BALANCE)[\s:$]*\$?([\d,]+\.?\d*)/i);return t&&(e.balance=parseFloat(t[1].replace(/,/g,""))),e}function sF(n){const e={},t=n.match(/(?:WAGES|COMPENSATION)[\s:$]*\$?([\d,]+\.?\d*)/i);if(t){const s=parseFloat(t[1].replace(/,/g,""));e.annualIncome=s}return e}async function rF(n,e,t){try{const s=await J2(n,i=>{t&&t(i*.8)});if(!s.success)return{success:!1,documentType:e,extractedData:{},rawText:"",error:s.error};t&&t(.9);const r=Q2(s.text,e);return t&&t(1),{success:!0,documentType:e,extractedData:r,rawText:s.text}}catch(s){return console.error("Document processing error:",s),{success:!1,documentType:e,extractedData:{},rawText:"",error:s.message||"Processing failed"}}}const iF=[{value:"driversLicense",label:"Driver's License"},{value:"taxReturn",label:"Tax Return"},{value:"payStub",label:"Pay Stub"},{value:"bankStatement",label:"Bank Statement"},{value:"w2",label:"W-2 Form"},{value:"1099",label:"1099 Form"}];function oF(){const{user:n}=Vh(),[e,t]=z.useState(null),[s,r]=z.useState("driversLicense"),[i,o]=z.useState(!1),[l,c]=z.useState(!1),[u,h]=z.useState(0),[d,f]=z.useState(null),[p,y]=z.useState(null),v=m=>{m.target.files&&m.target.files[0]&&(t(m.target.files[0]),f(null),y(null))},S=async()=>{if(!n||!e){f("Please select a file and ensure you are logged in.");return}c(!0),o(!1),f(null),y(null),h(0);try{const m=await rF(e,s,x=>{h(Math.round(x*100))});if(!m.success)throw new Error(m.error||"Failed to process document");h(90),c(!1),o(!0);const w=`${n.id}/${s}/${Date.now()}_${e.name}`,{error:_}=await Wr.storage.from("documents").upload(w,e);_&&console.warn("File upload failed, but continuing with data upload:",_);const{data:E,error:k}=await Wr.from("documents").insert({user_id:n.id,file_name:e.name,file_path:_?null:w,document_type:s,status:"processed"}).select().single();if(k)throw new Error(`Failed to save document: ${k.message}`);const{error:C}=await Wr.from("extracted_data").insert({document_id:E.id,data:m.extractedData});if(C)throw new Error(`Failed to save extracted data: ${C.message}`);h(100),y("Document processed and uploaded successfully!"),t(null),setTimeout(()=>{y(null),h(0)},3e3)}catch(m){f(m.message),c(!1),o(!1)}finally{o(!1)}};return D.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg p-6",children:[D.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Upload New Document"}),D.jsxs("div",{className:"space-y-4",children:[D.jsxs("div",{children:[D.jsx("label",{htmlFor:"document-type",className:"block text-sm font-medium text-gray-700",children:"Document Type"}),D.jsx("select",{id:"document-type",name:"document-type",className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",value:s,onChange:m=>r(m.target.value),children:iF.map(m=>D.jsx("option",{value:m.value,children:m.label},m.value))})]}),D.jsxs("div",{children:[D.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File Upload"}),D.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:D.jsxs("div",{className:"space-y-1 text-center",children:[D.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:D.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-4V8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),D.jsxs("div",{className:"flex text-sm text-gray-600",children:[D.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500",children:[D.jsx("span",{children:"Upload a file"}),D.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",onChange:v,accept:".pdf,.jpg,.jpeg,.png"})]}),D.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),D.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, PDF up to 10MB"})]})}),e&&D.jsxs("p",{className:"mt-2 text-sm text-gray-900",children:["Selected: ",e.name]})]}),(l||i)&&D.jsxs("div",{children:[D.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[D.jsx("span",{children:l?"Processing document...":"Uploading..."}),D.jsxs("span",{children:[u,"%"]})]}),D.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:D.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${u}%`}})})]}),d&&D.jsx("p",{className:"text-sm text-red-600",children:d}),p&&D.jsx("p",{className:"text-sm text-green-600",children:p}),D.jsx("button",{type:"button",onClick:S,disabled:!e||i||l,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Processing...":i?"Uploading...":"Process & Upload Document"})]})]})}function aF({onComplete:n}){const{updateModule:e}=Lx();return D.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[D.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Document Upload"}),D.jsx("p",{className:"text-gray-600 mb-6",children:"Upload your financial documents and identification here. Documents will be processed using browser OCR."}),D.jsx(oF,{}),D.jsx("div",{className:"mt-6",children:D.jsx("button",{onClick:async()=>{await e("module_document_upload",!0),n==null||n()},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Mark as Complete"})})]})}function lF(){var d,f,p;const{user:n,signOut:e}=Vh(),{progress:t,loading:s,getOverallProgressPercentage:r}=Lx(),i=mv(),[o,l]=z.useState("overview"),c=async()=>{await e(),i("/login")},u=r(),h=[{id:"document",title:"Document Upload",description:"Upload your financial documents and identification",completed:((d=t.find(y=>y.module_name==="module_document_upload"))==null?void 0:d.status)==="completed"||!1},{id:"personal",title:"Personal Information",description:"Review and confirm your personal details",completed:((f=t.find(y=>y.module_name==="module_personal_info"))==null?void 0:f.status)==="completed"||!1},{id:"financial",title:"Financial Information",description:"Review your financial data from uploaded documents",completed:((p=t.find(y=>y.module_name==="module_financial_info"))==null?void 0:p.status)==="completed"||!1}];return s?D.jsx("div",{className:"min-h-screen flex items-center justify-center",children:D.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):D.jsxs("div",{className:"min-h-screen bg-gray-50",children:[D.jsx("nav",{className:"bg-white shadow",children:D.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:D.jsxs("div",{className:"flex justify-between h-16",children:[D.jsx("div",{className:"flex items-center",children:D.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Divorce EZ Platform"})}),D.jsxs("div",{className:"flex items-center space-x-4",children:[D.jsxs("div",{className:"text-sm text-gray-600",children:["Progress: ",D.jsxs("span",{className:"font-medium",children:[u,"%"]})]}),D.jsx("span",{className:"text-sm text-gray-700",children:n==null?void 0:n.email}),D.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Sign Out"})]})]})})}),D.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:o==="overview"?D.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[D.jsxs("div",{className:"mb-8",children:[D.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Your Divorce Filing Progress"}),D.jsx("p",{className:"text-gray-600",children:"Complete each module to prepare your divorce filing documents"})]}),D.jsxs("div",{className:"mb-8 bg-white rounded-lg shadow p-6",children:[D.jsxs("div",{className:"flex items-center justify-between mb-4",children:[D.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Overall Progress"}),D.jsxs("span",{className:"text-2xl font-bold text-indigo-600",children:[u,"%"]})]}),D.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:D.jsx("div",{className:"bg-indigo-600 h-4 rounded-full transition-all",style:{width:`${u}%`}})})]}),D.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:h.map(y=>D.jsxs("div",{onClick:()=>l(y.id),className:"bg-white rounded-lg shadow p-6 cursor-pointer hover:shadow-lg transition-shadow",children:[D.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:y.title}),D.jsx("p",{className:"text-sm text-gray-600 mb-4",children:y.description}),D.jsx("div",{className:"flex items-center",children:y.completed?D.jsx("span",{className:"text-sm text-green-600 font-medium",children:" Completed"}):D.jsx("span",{className:"text-sm text-gray-500",children:"Not started"})})]},y.id))})]}):D.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[D.jsxs("button",{onClick:()=>l("overview"),className:"mb-4 text-sm text-indigo-600 hover:text-indigo-500 flex items-center",children:[D.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:D.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Overview"]}),o==="document"&&D.jsx(aF,{onComplete:()=>l("overview")})]})})]})}function cF({children:n}){const{user:e,loading:t}=Vh();return t?D.jsx("div",{className:"min-h-screen flex items-center justify-center",children:D.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e?n:D.jsx(px,{to:"/login"})}function uF(){return D.jsx(tN,{children:D.jsx(_I,{children:D.jsxs(yI,{children:[D.jsx(cd,{path:"/login",element:D.jsx(nN,{})}),D.jsx(cd,{path:"/signup",element:D.jsx(sN,{})}),D.jsx(cd,{path:"/dashboard",element:D.jsx(cF,{children:D.jsx(lF,{})})}),D.jsx(cd,{path:"/",element:D.jsx(px,{to:"/dashboard"})})]})})})}_w.createRoot(document.getElementById("root")).render(D.jsx(ZE.StrictMode,{children:D.jsx(uF,{})}));
